<div class="container">

<table style="width: 100%;"><tr>
<td>HandlrClient</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HandlrClient</h2>

<h3>Description</h3>

<p>handlr client, read and write to and from all citation formats
</p>


<h3>Details</h3>

<p>The various inputs to the <code>x</code> parameter are handled in different
ways:
</p>

<ul>
<li>
<p> file: contents read from file, we grab file extension, and we guess
format based on combination of contents and file extension because
file extensions may belie what's in the file
</p>
</li>
<li>
<p> string: string read in, and we guess format based on contents of
the string
</p>
</li>
<li>
<p> DOI: we request citeproc-json format from the Crossref API
</p>
</li>
<li>
<p> DOI url: we request citeproc-json format from the Crossref API
</p>
</li>
</ul>
<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>path</code></dt>
<dd>
<p>(character) non-empty if file path passed to initialize</p>
</dd>
<dt><code>string</code></dt>
<dd>
<p>(character) non-empty if string (non-file) passed to initialize</p>
</dd>
<dt><code>parsed</code></dt>
<dd>
<p>after <code>read()</code> is run, the parsed content</p>
</dd>
<dt><code>file</code></dt>
<dd>
<p>(logical) <code>TRUE</code> if a file passed to initialize, else <code>FALSE</code></p>
</dd>
<dt><code>ext</code></dt>
<dd>
<p>(character) the file extension</p>
</dd>
<dt><code>format_guessed</code></dt>
<dd>
<p>(character) the guessed file format</p>
</dd>
<dt><code>doi</code></dt>
<dd>
<p>(character) the DOI, if any found</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-print"><code>HandlrClient$print()</code></a>
</p>
</li>
<li> <p><a href="#method-new"><code>HandlrClient$new()</code></a>
</p>
</li>
<li> <p><a href="#method-read"><code>HandlrClient$read()</code></a>
</p>
</li>
<li> <p><a href="#method-write"><code>HandlrClient$write()</code></a>
</p>
</li>
<li> <p><a href="#method-as_df"><code>HandlrClient$as_df()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>HandlrClient$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print method for <code>HandlrClient</code> objects
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$print(x, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>self</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>ignored</p>
</dd>
</dl>
</div>


<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new <code>HandlrClient</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$new(x, format = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>(character) a file path (the file must exist), a string
containing contents of the citation, a DOI, or a DOI as a URL.
See Details.</p>
</dd>
<dt><code>format</code></dt>
<dd>
<p>(character) one of citeproc, ris, bibtex, codemeta, cff,
or <code>NULL</code>. If <code>NULL</code>, we attempt to guess the format, and error if we
can not guess</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options passed on to crul::verb-GET</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>HandlrClient</code> object
</p>


<hr>
<a id="method-read"></a>



<h4>Method <code>read()</code>
</h4>

<p>read input
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$read(format = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>format</code></dt>
<dd>
<p>(character) one of citeproc, ris, bibtex, codemeta, cff,
or <code>NULL</code>. If <code>NULL</code>, we attempt to guess the format, and error if we
can not guess</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>further args to the writer fxn, if any</p>
</dd>
</dl>
</div>


<hr>
<a id="method-write"></a>



<h4>Method <code>write()</code>
</h4>

<p>write to std out or file
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$write(format, file = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>format</code></dt>
<dd>
<p>(character) one of citeproc, ris, bibtex, schema_org,
rdfxml, codemeta, or cff</p>
</dd>
<dt><code>file</code></dt>
<dd>
<p>a file path, if NULL to stdout. for <code>format=ris</code>,
number of files must equal number of ris citations</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>further args to the writer fxn, if any</p>
</dd>
</dl>
</div>


<hr>
<a id="method-as_df"></a>



<h4>Method <code>as_df()</code>
</h4>

<p>convert data to a data.frame using <code>handl_to_df()</code>
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$as_df()</pre></div>



<h5>Returns</h5>

<p>a data.frame
</p>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>HandlrClient$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Note</h3>

<p>If <code style="white-space: pre;">⁠$parsed⁠</code> is <code>NULL</code> then it's likely <code style="white-space: pre;">⁠$read()⁠</code> has not
been run - in which case we attempt to run <code style="white-space: pre;">⁠$read()⁠</code> to
populate <code style="white-space: pre;">⁠$parsed⁠</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># read() can be run with format specified or not
# if format not given, we attempt to guess the format and then read
z &lt;- system.file('extdata/citeproc.json', package = "handlr")
(x &lt;- HandlrClient$new(x = z))
x$read()
x$read("citeproc")
x$parsed

# you can run read() then write()
# or just run write(), and read() will be run for you if possible
z &lt;- system.file('extdata/citeproc.json', package = "handlr")
(x &lt;- HandlrClient$new(x = z))
cat(x$write("ris"))

# read from a DOI as a url
if (interactive()) {
  (x &lt;- HandlrClient$new('https://doi.org/10.7554/elife.01567'))
  x$parsed
  x$read()
  x$parsed
  x$write('bibtex')
}

# read from a DOI
if (interactive()) {
  (x &lt;- HandlrClient$new('10.7554/elife.01567'))
  x$parsed
  x$read()
  x$write('bibtex')
}

# read in citeproc, write out bibtex
z &lt;- system.file('extdata/citeproc.json', package = "handlr")
(x &lt;- HandlrClient$new(x = z))
x$path
x$ext
x$read("citeproc")
x$parsed
x$write("bibtex")
f &lt;- tempfile(fileext = ".bib")
x$write("bibtex", file = f)
readLines(f)
unlink(f)

# read in ris, write out ris
z &lt;- system.file('extdata/peerj.ris', package = "handlr")
(x &lt;- HandlrClient$new(x = z))
x$path
x$format_guessed
x$read("ris")
x$parsed
x$write("ris")
cat(x$write("ris"))

# read in bibtex, write out ris
(z &lt;- system.file('extdata/bibtex.bib', package = "handlr"))
(x &lt;- HandlrClient$new(x = z))
x$path
x$format_guessed
if (requireNamespace("bibtex", quietly = TRUE)) {
x$read("bibtex")
x$parsed
x$write("ris")
cat(x$write("ris"))
}

# read in bibtex, write out RDF XML
if (requireNamespace("bibtex", quietly = TRUE) &amp;&amp; interactive()) {
  (z &lt;- system.file('extdata/bibtex.bib', package = "handlr"))
  (x &lt;- HandlrClient$new(x = z))
  x$path
  x$format_guessed
  x$read("bibtex")
  x$parsed
  x$write("rdfxml")
  cat(x$write("rdfxml"))
}

# codemeta
(z &lt;- system.file('extdata/codemeta.json', package = "handlr"))
(x &lt;- HandlrClient$new(x = z))
x$path
x$format_guessed
x$read("codemeta")
x$parsed
x$write("codemeta")

# cff: Citation File Format
(z &lt;- system.file('extdata/citation.cff', package = "handlr"))
(x &lt;- HandlrClient$new(x = z))
x$path
x$format_guessed
x$read("cff")
x$parsed
x$write("codemeta")

# &gt; 1 citation
z &lt;- system.file('extdata/citeproc-many.json', package = "handlr")
(x &lt;- HandlrClient$new(x = z))
x$parsed
x$read()
x$parsed
## schmea org
x$write("schema_org")
## bibtex
x$write("bibtex")
## bibtex to file
f &lt;- tempfile(fileext=".bib")
x$write("bibtex", f)
readLines(f)
unlink(f)
## to RIS
x$write("ris")
### only one per file, so not combined
files &lt;- replicate(2, tempfile(fileext=".ris"))
x$write("ris", files)
lapply(files, readLines)

# handle strings instead of files
z &lt;- system.file('extdata/citeproc-crossref.json', package = "handlr")
(x &lt;- HandlrClient$new(x = readLines(z)))
x$read("citeproc")
x$parsed
cat(x$write("bibtex"), sep = "\n")
</code></pre>


</div>