<div class="container">

<table style="width: 100%;"><tr>
<td>glm.pp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior of power prior (PP) with fixed <code class="reqn">a_0</code>
</h2>

<h3>Description</h3>

<p>Sample from the posterior distribution of a GLM using the power prior (PP) by Ibrahim and Chen (2000) <a href="doi:10.1214/ss/1009212673">doi:10.1214/ss/1009212673</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.pp(
  formula,
  family,
  data.list,
  a0.vals,
  offset.list = NULL,
  beta.mean = NULL,
  beta.sd = NULL,
  disp.mean = NULL,
  disp.sd = NULL,
  iter_warmup = 1000,
  iter_sampling = 1000,
  chains = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a two-sided formula giving the relationship between the response variable and covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an object of class <code>family</code>. See <code>?stats::family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.list</code></td>
<td>
<p>a list of <code>data.frame</code>s. The first element in the list is the current data, and the rest
are the historical data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0.vals</code></td>
<td>
<p>a scalar between 0 and 1 or a vector whose dimension is equal to the number of historical
data sets giving the (fixed) power prior parameter for each historical data set. Each element of
vector should be between 0 and 1. If a scalar is provided, same as for <code>beta.mean</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset.list</code></td>
<td>
<p>a list of vectors giving the offsets for each data. The length of <code>offset.list</code> is equal to
the length of <code>data.list</code>. The length of each element of <code>offset.list</code> is equal to the number
of rows in the corresponding element of <code>data.list</code>. Defaults to a list of vectors of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.mean</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of regression coefficients giving
the mean parameters for the initial prior on regression coefficients. If a scalar is provided,
<code>beta.mean</code> will be a vector of repeated elements of the given scalar. Defaults to a vector of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.sd</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of regression coefficients giving
the sd parameters for the initial prior on regression coefficients. If a scalar is provided,
same as for <code>beta.mean</code>. Defaults to a vector of 10s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.mean</code></td>
<td>
<p>location parameter for the half-normal prior on dispersion parameter. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.sd</code></td>
<td>
<p>scale parameter for the half-normal prior on dispersion parameter. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_warmup</code></td>
<td>
<p>number of warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_warmup</code> in
<code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_sampling</code></td>
<td>
<p>number of post-warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_sampling</code>
in <code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>number of Markov chains to run. Defaults to 4. See the argument <code>chains</code> in <code>sample()</code> method in
cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>sample()</code> method in cmdstanr package (e.g., <code>seed</code>, <code>refresh</code>, <code>init</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power prior parameters (<code class="reqn">a_0</code>'s) are treated as fixed. The initial priors on the regression coefficients
are independent normal priors. The current and historical data sets are assumed to have a common dispersion parameter
with a half-normal prior (if applicable).
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>draws_df</code> giving posterior samples, with an attribute called 'data' which includes
the list of variables specified in the data block of the Stan program.
</p>


<h3>References</h3>

<p>Chen, M.-H. and Ibrahim, J. G. (2000). Power prior distributions for Regression Models. Statistical Science, 15(1).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (instantiate::stan_cmdstan_exists()) {
  data(actg019)
  data(actg036)
  ## take subset for speed purposes
  actg019 = actg019[1:100, ]
  actg036 = actg036[1:50, ]
  data_list = list(currdata = actg019, histdata = actg036)
  glm.pp(
    formula = cd4 ~ treatment + age + race,
    family = poisson('log'),
    data.list = data_list,
    a0.vals = 0.5,
    chains = 1, iter_warmup = 500, iter_sampling = 1000
  )
}
</code></pre>


</div>