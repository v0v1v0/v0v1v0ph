<div class="container">

<table style="width: 100%;"><tr>
<td>hdbm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>High Dimensional Bayesian Mediation</h2>

<h3>Description</h3>

<p><code>hdbm</code> is a Bayesian inference method that uses continuous shrinkage priors
for high-dimensional mediation analysis, developed by Song et al (2018).
<code>hdbm</code> provides estimates for the regression coefficients as well as
the posterior inclusion probability for ranking mediators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdbm(Y, A, M, C1, C2, beta.m, alpha.a, burnin, ndraws)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>numeric outcome vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>numeric exposure vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>numeric matrix of mediators of Y and A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p>numeric matrix of extra covariates in the outcome model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C2</code></td>
<td>
<p>numeric matrix of extra covariates in the mediator model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.m</code></td>
<td>
<p>numeric vector of initial beta.m in the outcome model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.a</code></td>
<td>
<p>numeric vector of initial alpha.a in the mediator model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of iterations to run the MCMC before sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>number of draws to take from MCMC after the burnin period</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hdbm</code> uses two regression models for the two conditional relationships,
<code class="reqn">Y | A, M, C1</code> and <code class="reqn">M | A, C2</code>. For the outcome model, <code>hdbm</code>
uses
</p>
<p style="text-align: center;"><code class="reqn">Y = M \beta_M  + A * \beta_A + C1* \beta_CY + \epsilon_Y</code>
</p>

<p>For the mediator model, <code>hdbm</code> uses the model
</p>
<p style="text-align: center;"><code class="reqn">M = A * \alpha_A + C2 * \alpha_C2 + \epsilon_M</code>
</p>

<p>For high dimensional tractability, <code>hdbm</code> employs continuous Bayesian
shrinkage priors to select mediators and makes the two following assumptions:
First, it assumes that all the potential mediators contribute small effects
in mediating the exposure-outcome relationship. Second, it assumes
that only a small proportion of mediators exhibit large effects
("active" mediators). <code>hdbm</code> uses a Metropolis-Hastings within Gibbs
MCMC to generate posterior samples from the model.
</p>


<h3>Value</h3>

<p>hdbm returns a list with 11 elements (each of length <code>ndraws</code>),
sampled from the burned in MCMC:
</p>

<dl>
<dt>beta.m</dt>
<dd>
<p>Outcome model mediator coefficients</p>
</dd>
<dt>r1</dt>
<dd>
<p>Whether or not each beta.m belongs to the larger normal
component (1) or smaller normal component (0)</p>
</dd>
<dt>alpha.a</dt>
<dd>
<p>Mediator model exposure coefficients</p>
</dd>
<dt>r3</dt>
<dd>
<p>Whether or not each alpha.a belongs to the larger normal
component (1) or smaller normal component (0)</p>
</dd>
<dt>beta.a</dt>
<dd>
<p>beta.a coefficient</p>
</dd>
<dt>pi.m</dt>
<dd>
<p>Proportion of non zero beta.m coefficients</p>
</dd>
<dt>pi.a</dt>
<dd>
<p>Proportion of non zero alpha.a coefficients</p>
</dd>
<dt>sigma.m0</dt>
<dd>
<p>standard deviation of the smaller normal component for
mediator-outcome coefficients (beta.m)</p>
</dd>
<dt>sigma.m1</dt>
<dd>
<p>standard deviation of the larger normal component for
mediator-outcome coefficients (beta.m)</p>
</dd>
<dt>sigma.ma0</dt>
<dd>
<p>Standard deviation of the smaller normal component for
exposure-mediator coefficients (alpha.a)</p>
</dd>
<dt>sigma.ma1</dt>
<dd>
<p>Standard deviation of the larger normal component for
exposure-mediator coefficients (alpha.a)</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Alexander Rix
</p>


<h3>References</h3>

<p>Yanyi Song, Xiang Zhou et al. Bayesian Shrinkage Estimation of High
Dimensional Causal Mediation Effects in Omics Studies.
bioRxiv <a href="https://doi.org/10.1101/467399">10.1101/467399</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(hdbm)

Y &lt;- hdbm.data$y
A &lt;- hdbm.data$a

# grab the mediators from the example data.frame
M &lt;- as.matrix(hdbm.data[, paste0("m", 1:100)], nrow(hdbm.data))

# We just include the intercept term in this example.
C &lt;- matrix(1, 1000, 1)
beta.m  &lt;- rep(0, 100)
alpha.a &lt;- rep(0, 100)

set.seed(12345)
hdbm.out &lt;- hdbm(Y, A, M, C, C, beta.m, alpha.a,
                   burnin = 1000, ndraws = 100)

# Which mediators are active?
active &lt;- which(colSums(hdbm.out$r1 * hdbm.out$r3) &gt; 50)
colnames(M)[active]
</code></pre>


</div>