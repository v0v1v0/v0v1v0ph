<div class="container">

<table style="width: 100%;"><tr>
<td>initial_parameter_training</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Algorithm to Find Plausible Starting Values for Parameter Estimation
</h2>

<h3>Description</h3>

<p>The function computes plausible starting values for both the Baum-Welch algorithm and the algorithm for directly maximizing the log-Likelihood.  Plausible starting values can potentially diminish problems of (i) numerical instability and (ii) not finding the global optimum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">initial_parameter_training(x, m, distribution_class, n = 100, 
                           discr_logL = FALSE, discr_logL_eps = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector object containing the time-series of observations that are assumed to be realizations of the (hidden Markov state dependent) observation process of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a (finite) number of states in the hidden Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_class</code></td>
<td>

<p>a single character string object with the abbreviated name of the <code>m</code> observation distributions of the Markov dependent observation process.  The following distributions are supported by this algorithm: Poisson (<code>pois</code>); generalized Poisson (<code>genpois</code>); normal (<code>norm</code>); geometric (<code>geom</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>a single numerical value specifying the number of samples to find the best starting value for the training algorithm.  Default value is <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discr_logL</code></td>
<td>

<p>a logical object.  <code>TRUE</code>, if the discrete log-likelihood shall be calculated (for <code>distribution_class="norm"</code> instead of the general log-likelihood.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discr_logL_eps</code></td>
<td>

<p>discrete log-likelihood for a hidden Markov model based on nomal distributions (for <code>distribution_class="norm"</code>).  The default value is <code>0.5</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>From our experience, parameter estimation for long time-series of observations (<code>T&gt;1000</code>) or observation values <code>&gt;1500</code> tend to be numerical instable and does not necessarily find a global maximum.  Both problems can eventually be diminished with plausible starting values.  Basically, the idea behind <code>initial_parameter_training</code> is to sample randomly <code>n</code> sets of <code>m</code> observations from the time-series <code>x</code>, as means (<code>E</code>) of the state-dependent distributions. This <code>n</code> samplings of <code>E</code>, therefore induce <code>n</code> sets of parameters (<code>distribution_theta</code>) for the HMM without running a (slow) parameter estimation algorithm. Furthermore, <code>initial_parameter_training</code> calculates the log-Likelihood for all those <code>n</code> sets of parameters.  The set of parameters with the best Likelihood are outputted as plausible starting values.
(Additionally to the <code>n</code> sets of randomly chosen observations as means, the <code>m</code> quantiles of the observations are also checked as plausible means within this algorithm.)
</p>


<h3>Value</h3>

<p><code> initial_parameter_training </code> returns a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>input number of states in the hidden Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a single numerical value representing the number of parameters of the defined distribution class of the observation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>logarithmized likelihood of the model evaluated at the HMM with given starting values (<code>delta, gamma, distribution theta</code>) induced by <code>E</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>randomly choosen means of the observation time-series <code>x</code>, used for the observation distributions, for which the induced parameters 
</p>
<p>(<code>delta, gamma, distribution theta</code>) produce the largest Likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_theta</code></td>
<td>
<p>a list object containing the plausible starting values for the parameters of the <code>m</code> observation distributions that are dependent on the hidden Markov state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector object containing plausible starting values for the marginal probability distribution of the <code>m</code> states of the Markov chain at the time point <code>t=1</code>.  At the moment:<br><code>delta = rep(1/m, times=m)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>a matrix (<code>nrow=ncol=m</code>) containing the plausible starting values for the transition matrix of the hidden Markov chain.  At the moment:<br><code>gamma = 0.8 * diag(m) + rep(0.2/m, times=m)</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vitali Witowski (2013).
</p>


<h3>See Also</h3>

<p><code>Baum_Welch_algorithm</code>
<code>direct_numerical_maximization</code>
<code>HMM_training</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
################################################################
### Fictitious observations ####################################
################################################################

x &lt;- c(1,16,19,34,22,6,3,5,6,3,4,1,4,3,5,7,9,8,11,11,
  14,16,13,11,11,10,12,19,23,25,24,23,20,21,22,22,18,7,
  5,3,4,3,2,3,4,5,4,2,1,3,4,5,4,5,3,5,6,4,3,6,4,8,9,12,
  9,14,17,15,25,23,25,35,29,36,34,36,29,41,42,39,40,43,
  37,36,20,20,21,22,23,26,27,28,25,28,24,21,25,21,20,21,
  11,18,19,20,21,13,19,18,20,7,18,8,15,17,16,13,10,4,9,
  7,8,10,9,11,9,11,10,12,12,5,13,4,6,6,13,8,9,10,13,13,
  11,10,5,3,3,4,9,6,8,3,5,3,2,2,1,3,5,11,2,3,5,6,9,8,5,
  2,5,3,4,6,4,8,15,12,16,20,18,23,18,19,24,23,24,21,26,
  36,38,37,39,45,42,41,37,38,38,35,37,35,31,32,30,20,39,
  40,33,32,35,34,36,34,32,33,27,28,25,22,17,18,16,10,9,
  5,12,7,8,8,9,19,21,24,20,23,19,17,18,17,22,11,12,3,9,
  10,4,5,13,3,5,6,3,5,4,2,5,1,2,4,4,3,2,1) 


### Finding plausibel starting values for the parameter estimation 
### for a generealized-Pois-HMM with m=4 states
m &lt;- 4 


plausible_starting_values &lt;- 
   initial_parameter_training(x = x, 
     m = m, 
     distribution_class = "genpois", 
     n=100)

print(plausible_starting_values)

</code></pre>


</div>