<div class="container">

<table style="width: 100%;"><tr>
<td>sample_sbm_hypergraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample from a stochastic block model.
</h2>

<h3>Description</h3>

<p>A stochastic block model hypergraph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_sbm_hypergraph(n,P,block.sizes,d,impurity=0,variable.size=FALSE,
   absolute.purity=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of vertices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>

<p>A kxk probability matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.sizes</code></td>
<td>

<p>vector of community sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>size of a hyper-edge. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impurity</code></td>
<td>

<p>See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable.size,absolute.purity</code></td>
<td>

<p>logical. See Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A stochastic
block model is first generated using the function 
<code>sample_sbm(n,P,block.sizes)</code>. The edges are
augmented with vertices, resulting in a stochastic block model hypergraph,
as discussed below.
</p>
<p>The variable 
<code>d</code> corresponds to the number of vertices per edge. If it is a vector,
it is recycled as necessary. If <code>variable.size</code> is TRUE, then d is used
as the mean of a Poisson random variable to generate hyper-edge orders,
to which 2 is added. So a <code>d</code> of 2 will result in hyper-edge orders
with a mean of 4.
</p>
<p>For each edge (say, edge k) in the graph, 
new vertices are added so that the number of
vertices in the (now hyper-)edge is d[k].
</p>
<p>If <code>impurity</code> is 0, then for each edge
the vertices are added in proportion
to the block sizes, using <code>sample</code>, 
so if one community has many more vertices than the others,
it will tend to dominate in the hyper-edges as well. However, it is guaranteed
that hyper-edges between two distince communities have at least one vertex
from each of those two communities, and hyper-edges within communities are pure
in the case of <code>impurity=0</code>;
no hyper-edge will contain vertices from more than two communities.
</p>
<p>If <code>impurity&gt;0</code>, then <code>impurity</code> of the vertices not
in the original stochastic block model hypergraph 
are replaced by random vertices. If <code>absolute.purity</code> is TRUE, these
new vertices are
sampled from all other classes. Otherwise they are sample from vertices not
in the original hyper-edge. If <code>k</code> is 2, only the within community
hyper-edges will contain impurities.
</p>


<h3>Value</h3>

<p>a hypergraph.
</p>


<h3>Author(s)</h3>

<p>David J. Marchette <a href="mailto:dmarchette@gmail.com">dmarchette@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>sample_gnp_hypergraph</code>, <code>sample_sbm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	
	P &lt;- rbind(c(0.1,0.01),c(0.01,0.1))
	block.sizes &lt;- c(50,50)
	set.seed(55)
   h &lt;- sample_sbm_hypergraph(100,P=P,block.sizes=block.sizes,d=4)
	range(edge_orders(h))
	## should all be 4
	set.seed(1233)
	k &lt;- sample_sbm_hypergraph(100,P=P,d=2,block.sizes=block.sizes,
	             variable.size=TRUE)
	mean(edge_orders(k))
	## should be approximately 4
	set.seed(1235)
	Q &lt;- rbind(c(.2,.01,.01),
	           c(.01,.1,.05),
				  c(.01,.05,.2))
	kk &lt;- sample_sbm_hypergraph(300,P=Q,d=6,block.sizes=rep(100,3),
	             variable.size=TRUE,impurity=2)

	
</code></pre>


</div>