<div class="container">

<table style="width: 100%;"><tr>
<td>Hmsc-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hmsc: Hierarchical Model of Species Communities</h2>

<h3>Description</h3>

<p>Hierarchical Modelling of Species Communities (Hmsc) is a
flexible framework for Joint Species Distribution Modelling (JSDMs). The
framework can be used to relate species occurrences or abundances to
environmental covariates, species traits and phylogenetic relationships.
JSDMs are a special case of species distribution models (SDMs) that take
into account the multivariate nature of communities which allows us to
estimate community level responses as well capture biotic interactions and
the influence of missing covariates in residual species associations. The
Hmsc package contains functions to fit JSDMs, analyze the output and to
generate predictions with these JSDMs.
</p>


<h3>Workflow</h3>

<p>A typical workflow for a Hmsc analysis constists of 5 steps:
</p>
<p><b>Step 1: Setting the model structure and fitting the model</b>
</p>
<p>The obligatory data for a Hmsc analysis includes a matrix of species occurrences
or abundances (Y) and a data frame of environmental covariates (XData). The
species matrix Y consists of ns columns representing the species and np rows
representing the sampling units. Species data for different species does not
have to be on the same scale, i.e. species 1 may be recorded as
presence/absence while species 2 is recorded as abundance. XData consists of
nc columns representing the environmental variables and np rows representing
the sampling units. Y and XData need to have the same amount of rows
(sampling units).
</p>
<p>Optionally, the user can include information species traits, phylogenetic
relationships and information on the spatiotemporal or hierarchical context of the sampling
design to account for dependencies among the sampling units.
</p>
<p>The model structure is created using the <code>Hmsc</code> function. As
input, this function needs at least the matrix with species data (Y) and the
dataframe with environmental variables. This is also the place where the data model is specified, as a default Hmsc assumes normally distributed species data. Other options are 'probit' for binary data, 'Poisson' and 'overdispersedPoisson' for count data. Additionally, you can specify the study design, the random effects structure, the species traits to be used,
species phylogeny, how the covariate should be scales and how viable selection should be applied.
</p>
<p>The random levels supplied to <code>Hmsc</code> are generated using <code>HmscRandomLevel</code>. Here, the user can specify the spatial or temporal information for the units as well as the covariates for covariate-depedent associations. If there is no spatial, temporal or coviate information for this level, the user should provide here the names of the units for this level.
</p>
<p>After setting the model structure, the model is fitted by running <code>sampleMcmc</code> to sample from the posterior distributions of the model parameters.
</p>
<p><b>Step 2: Examining MCMC convergence</b>
</p>
<p>After fitting the model, the MCMC convergence needs to be evaluated. The
easiest way to do this is generate a coda object from the fitted model using
<code>convertToCodaObject</code>. Convergence of the chains should be
assessed qualitatively using trace plots of the model parameters and
quantitatively using gelman diagnostics <code>gelman.diag</code> and
by calculating the effective sample size with
<code>effectiveSize</code>.
</p>
<p><b>Step 3: Evaluating model fit</b>
</p>
<p>If MCMC convergence is satisfacotry, the model fit can be evaluated. Using
the <code>computePredictedValues</code> function. It is also recommended to
also compute predictive power using cross validation. Cross validation is
done by supplying the partitioning created using using
<code>createPartition</code> to <code>computePredictedValues</code>.
</p>
<p><b>Step 4: Exploring parameter estimates</b>
</p>
<p>When the fitted model has satisfactory convergence and fit, the next step is
generally to investigate the parameter estimates of the model. The posterior
distribution of the parameter of choice is extracted from the model object
using <code>getPostEstimate</code>. <code>plotBeta</code> and
<code>plotGamma</code> can be used to visuzalize the beta and gamma
parameter estimates. Additionally, the function <code>biPlot</code> can be
used to construct an ordination plot from the eta and lamda parameters
</p>
<p>Additionally, at this stage of the analysis, the user may want to look at
how the variance explained by the model is partitioned using the
<code>computeVariancePartitioning</code> and the
<code>plotVariancePartitioning</code> function.
</p>
<p><b>Step 5: Making predictions</b>
</p>
<p>Hmsc comes with a generic <code>predict</code> function that can be used to predict species occurences or counts in new units. These predictions can be unconditional or conditional on the occurence of other species. For conditional predictions, the user needs to supply species data for at least some species in the new units.
Additionally, the package specific tools to make predictions along environmental gradients. These predictions can be vizualized at both the species and the community level (<code>constructGradient</code>, <code>plotGradient</code>).
</p>


<h3>Citing the Package</h3>

<p>Tikhonov, G., Opedal, O.H., Abrego, N., Lehikoinen, A., de Jonge,
M.M.J, Oksanen, J. and Ovaskainen, O. (2020) Joint species
distribution modelling with the R-package Hmsc. <em>Methods in
Ecology and Evolution</em> <b>11,</b> 442â€“447. <a href="https://doi.org/10.1111/2041-210X.13345">doi:10.1111/2041-210X.13345</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.helsinki.fi/en/researchgroups/statistical-ecology/software/hmsc">https://www.helsinki.fi/en/researchgroups/statistical-ecology/software/hmsc</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/hmsc-r/HMSC/issues/">https://github.com/hmsc-r/HMSC/issues/</a>
</p>
</li>
</ul>
</div>