<div class="container">

<table style="width: 100%;"><tr>
<td>score.sim.control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create the list of control parameters for simulations in haplo.score
</h2>

<h3>Description</h3>

<p>In the call to haplo.score, the sim.control
parameter is a list of parameters that control the simulations. This
list is created by this function, score.sim.control, making it easy to
change the default values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">score.sim.control(p.threshold=0.25, min.sim=1000, max.sim=20000.,verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p.threshold </code></td>
<td>

<p>A paremeter used to determine p-value precision from Besag and
Clifford (1991).  For a p-value calculated after min.sim simulations,
continue doing simulations until the p-value's sample standard error is
less than p.threshold * p-value.  The dafault value for p.threshold = 1/4
corresponds approximately to having a two-sided 95% confidence
interval for the p-value with a width as wide as the p-value itself.
Therefore, simulations are more precise for smaller p-values.
Additionally, since simulations are stopped as soon as this criteria
is met, p-values may be biased high.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.sim </code></td>
<td>

<p>The minimum number of simulations to run.  To run exactly min.sim
simulations, set max.sim = min.sim.  Also, if run-time is an issue, a
lower minimum (e.g. 500) may be useful, especially when doing
simulations in haplo.score.slide.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sim </code></td>
<td>

<p>The upper limit of simulations allowed.  When the number of
simulations reaches max.sim, p-values are approximated based on
simulation results at that time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical, if (T)rue, print updates from every simulation to the
screen.  If (F)alse, do not print these details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In simulations for haplo.score, employ the simulation p-value
precision criteria of Besag and Clifford (1991).  The criteria
ensures both the global and the maximum score statistic simulated
p-values be precise for small p-values.  First, perform min.sim
simulations to guarantee sufficient precision for the score
statistics on individual haplotypes.  Then continue simulations as
needed until simulated p-values for both the global and max score
statistics meet precision requirements set by p.threshold.
</p>


<h3>Value</h3>

<p>A list of the control parameters:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.threshold</code></td>
<td>

<p>As described above
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.sim</code></td>
<td>

<p>As described above.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sim</code></td>
<td>

<p>As described above
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>As described above
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Besag, J and Clifford, P.  "Sequential Monte Carlo p-values."
Biometrika.  78, no. 2 (1991): 301-304.
</p>


<h3>See Also</h3>

<p><code>haplo.score</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># it would be used in haplo.score as appears below
#
# score.sim.500 &lt;- haplo.score(y, geno, trait.type="gaussian", simulate=T, 
#                sim.control=score.sim.control(min.sim=500, max.sim=2000)
</code></pre>


</div>