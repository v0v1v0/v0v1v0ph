<div class="container">

<table style="width: 100%;"><tr>
<td>sim.genot.t</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data from a non equilibrium continent-island model</h2>

<h3>Description</h3>

<p>This function allows to simulate genetic data from a non-equilibrium continent-island
model, where each island can have a different size and a different inbreeding 
coefficient. 
</p>
<p>This function simulates genetic data under the continent-islands model (IIM=TRUE) 
or the finite island model (IIM=FALSE).
In the IIM, a continent of 
infinite size sends migrants to islands of finite sizes <code class="reqn">N_i</code> at a rate 
<code class="reqn">m</code>. Alleles can also mutate to a new state at a rate <code class="reqn">\mu</code>. Under this model, 
the expected <code class="reqn">F_{STi}, \theta_i</code>, can be calculated and compared to empirical
estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.genot.t(size=50,nbal=4,nbloc=5,nbpop=3,N=1000,
mig=0.001,mut=0.0001,f=0,t=100,IIM=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>the number of sampled individuals per island</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbal</code></td>
<td>
<p>the number of alleles per locus (maximum of 99)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbloc</code></td>
<td>
<p>the number of loci to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbpop</code></td>
<td>
<p>the number of islands to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the effective population sizes of each island. If only one number, all
islands are assumed to be of the same size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mig</code></td>
<td>
<p>the migration rate from the continent to the islands</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mut</code></td>
<td>
<p>the mutation rate of the loci</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>the inbreeding coefficient for each island</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the number of generation since the islands were created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IIM</code></td>
<td>
<p>whether to simulate a continent island Model (default) or a migrant pool island Model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this model, <code class="reqn">\theta_t</code> can be written as a function of population size 
<code class="reqn">N_i</code>, migration rate <code class="reqn">m</code>, mutation rate <code class="reqn">\mu</code> and <code class="reqn">\theta_{(t-1)}</code>.  
</p>
<p>The rational is as follows:
</p>
<p>With probability <code class="reqn">\frac{1}{N}</code>, 2 alleles from 2 different individuals in 
the current generation are sampled from the same individual of the previous 
generation:     
</p>
<p>-Half the time, the same allele is drawn from the parent;
</p>
<p>-The other half, two different alleles are drawn, but they are identical in 
proportion <code class="reqn">\theta_{(t-1)}</code>.
</p>
<p>-With  probability <code class="reqn">1-\frac{1}{N}</code>, the 2 alleles are drawn from different 
individuals in the previous generation, in which case they are identical in 
proportion <code class="reqn">\theta_{(t-1)}</code>.
</p>
<p>This holds providing that neither alleles have mutated or migrated.  This is 
the case with probability <code class="reqn">(1-m)^2 \times (1-\mu)^2</code>.
If an allele is a mutant or a migrant, then its coancestry with another allele 
is 0 in the infinite continent-islands model (it is not the case in the finite island model).
</p>
<p>Note also that the mutation scheme assumed is the infinite allele (or site) 
model.  If the number of alleles is finite (as will be the case in what follows),
the corresponding mutation model is the K-allele model and the mutation rate 
has to be adjusted to <code class="reqn">\mu'=\frac{K-1}{K}\mu</code>.
</p>
<p>Lets substitute <code class="reqn">\alpha</code> for  <code class="reqn">(1-m)^2 (1-\mu)^2</code> and <code class="reqn">x</code> for
<code class="reqn">\frac{1}{2N}</code>.  
</p>
<p>The expectation of <code class="reqn">F_{ST}</code>, <code class="reqn">\theta</code> can be written as:
</p>
<p style="text-align: center;"><code class="reqn">\theta_t=(\alpha (1-x))^t \theta_0 + \frac{x}{1-x}\sum_{i=1}^t (\alpha (1-x))^i</code>
</p>
 
<p>which reduces to <code class="reqn">\theta_t=\frac{x}{1-x}\sum_{i=1}^t (\alpha (1-x))^i</code> if <code class="reqn">\theta_0=0</code>.
</p>
<p>Transition equations for <code class="reqn">theta</code> in the migrant-pool island model (IIM=FALSE) are given in Rouseet (1996). 
Currently, the migrant pool is made of equal contribution from each island, irrespective of their size.
</p>


<h3>Value</h3>

<p>A data frame with size*nbpop rows and nbloc+1 columns. Each row is an
individual, the first column contains the island to which the individual belongs, 
the following nbloc columns contain the genotype for each locus.
</p>


<h3>Author(s)</h3>

<p>Jerome Goudet <a href="mailto:jerome.goudet@unil.ch">jerome.goudet@unil.ch</a>
</p>


<h3>References</h3>

<p><a href="https://pubmed.ncbi.nlm.nih.gov/8846911/">Rousset, F. (1996)</a> Equilibrium values of measures of population subdivision for 
stepwise mutation processes. Genetics 142:1357
</p>


<h3>Examples</h3>

<pre><code class="language-R">
psize&lt;-c(100,1000,10000,100000,1000000)
dat&lt;-sim.genot.t(nbal=4,nbloc=20,nbpop=5,N=psize,mig=0.001,mut=0.0001,t=100)
summary(wc(dat)) #Weir and cockerham overall estimators of FST &amp; FIS
betas(dat) # Population specific estimator of FST

</code></pre>


</div>