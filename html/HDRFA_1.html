<div class="container">

<table style="width: 100%;"><tr>
<td>HPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Huber Principal Component Analysis for Large-Dimensional Factor Models
</h2>

<h3>Description</h3>

<p>This function is to fit the factor models via the Huber Principal Component Analysis (HPCA) method. One is based on minimizing the Huber loss of the idiosyncratic error's <code class="reqn">\ell_2</code> norm, which turns out to do Principal Component Analysis (PCA) on the weighted sample covariance matrix and thereby named as Huber PCA. The other one is based on minimizing the elementwise Huber loss, which can be solved by an iterative Huber regression algorithm.</p>


<h3>Usage</h3>

<pre><code class="language-R">HPCA(X, r, Method = "E", tau = NULL, scale_est="MAD", L_init = NULL, 
     F_init = NULL, maxiter_HPCA = 100, maxiter_HLM = 100, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Input matrix, of dimension <code class="reqn">T\times N</code>. Each row is an observation with <code class="reqn">N</code> features at time point <code class="reqn">t</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A positive integer indicating the factor numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Method</code></td>
<td>

<p><code>Method="P"</code> indicates minimizing the Huber loss of the idiosyncratic error's <code class="reqn">\ell_2</code> norm while <code>Method="E"</code> indicates minimizing the elementwise Huber loss. The default is the elementwise Huber loss.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>Optional user-supplied parameter for Huber loss; default is NULL, and <code class="reqn">\tau</code> is provided by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_est</code></td>
<td>

<p>A parameter for the elementwise Huber loss. <code>scale_est="MAD"</code> indicates robust variance estimation in each iteration, while <code>scale_est="const"</code> indicates fixing user-supplied <code class="reqn">\tau</code>. The default is <code>scale_est="MAD"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_init</code></td>
<td>

<p>User-supplied inital value of loadings; default is the PCA estimator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F_init</code></td>
<td>

<p>User-supplied inital value of factors; default is the PCA estimator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter_HPCA</code></td>
<td>

<p>The maximum number of iterations in the HPCA. The default is <code class="reqn">100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter_HLM</code></td>
<td>

<p>The maximum number of iterations in the iterative Huber regression algorithm. The default is <code class="reqn">100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>The stopping critetion parameter in the HPCA. The default is 1e-3.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See He et al. (2023) for details.
</p>


<h3>Value</h3>

<p>The return value is a list. In this list, it contains the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Fhat</code></td>
<td>
<p>The estimated factor matrix of dimension <code class="reqn">T\times r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lhat</code></td>
<td>
<p>The estimated loading matrix of dimension <code class="reqn">N\times r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of iterations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yong He, Lingxiao Li, Dong Liu, Wenxin Zhou.
</p>


<h3>References</h3>

<p>He Y, Li L, Liu D, Zhou W., 2023 Huber Principal Component Analysis for Large-dimensional Factor Models. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
T=50;N=50;r=3
L=matrix(rnorm(N*r,0,1),N,r);F=matrix(rnorm(T*r,0,1),T,r)
E=matrix(rnorm(T*N,0,1),T,N)
X=F%*%t(L)+E

fit=HPCA(X,r,Method = "E")
fit$Fhat;fit$Lhat

fit=HPCA(X,r,Method = "P")
fit$Fhat;fit$Lhat
</code></pre>


</div>