<div class="container">

<table style="width: 100%;"><tr>
<td>glm.logml.commensurate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log marginal likelihood of a GLM under commensurate prior (CP)</h2>

<h3>Description</h3>

<p>Uses Markov chain Monte Carlo (MCMC) and bridge sampling to estimate the logarithm of the marginal
likelihood of a GLM under the commensurate prior (CP).
</p>
<p>The arguments related to MCMC sampling are utilized to draw samples from the commensurate prior.
These samples are then used to compute the logarithm of the normalizing constant of the commensurate prior using
historical data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.logml.commensurate(
  post.samples,
  bridge.args = NULL,
  iter_warmup = 1000,
  iter_sampling = 1000,
  chains = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>post.samples</code></td>
<td>
<p>output from <code>glm.commensurate()</code> giving posterior samples of a GLM under the commensurate
prior (CP), with an attribute called 'data' which includes the list of variables specified
in the data block of the Stan program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bridge.args</code></td>
<td>
<p>a <code>list</code> giving arguments (other than <code>samples</code>, <code>log_posterior</code>, <code>data</code>, <code>lb</code>, and <code>ub</code>) to
pass onto <code>bridgesampling::bridge_sampler()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_warmup</code></td>
<td>
<p>number of warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_warmup</code>
in <code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_sampling</code></td>
<td>
<p>number of post-warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_sampling</code>
in <code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>number of Markov chains to run. Defaults to 4. See the argument <code>chains</code> in <code>sample()</code> method
in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>sample()</code> method in cmdstanr package (e.g., <code>seed</code>, <code>refresh</code>, <code>init</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a <code>list</code> with the following objects
</p>

<dl>
<dt>model</dt>
<dd>
<p>"Commensurate"</p>
</dd>
<dt>logml</dt>
<dd>
<p>the estimated logarithm of the marginal likelihood</p>
</dd>
<dt>bs</dt>
<dd>
<p>an object of class <code>bridge</code> or <code>bridge_list</code> containing the output from using <code>bridgesampling::bridge_sampler()</code>
to compute the logarithm of the normalizing constant of the commensurate prior (CP) using all data sets</p>
</dd>
<dt>bs.hist</dt>
<dd>
<p>an object of class <code>bridge</code> or <code>bridge_list</code> containing the output from using
<code>bridgesampling::bridge_sampler()</code> to compute the logarithm of the normalizing constant of the CP using historical
data sets</p>
</dd>
<dt>min_ess_bulk</dt>
<dd>
<p>the minimum estimated bulk effective sample size of the MCMC sampling</p>
</dd>
<dt>max_Rhat</dt>
<dd>
<p>the maximum Rhat</p>
</dd>
</dl>
<h3>References</h3>

<p>Hobbs, B. P., Carlin, B. P., Mandrekar, S. J., and Sargent, D. J. (2011). Hierarchical commensurate and power prior models for adaptive incorporation of historical information in clinical trials. Biometrics, 67(3), 1047â€“1056.
</p>
<p>Gronau, Q. F., Singmann, H., and Wagenmakers, E.-J. (2020). bridgesampling: An r package for estimating normalizing constants. Journal of Statistical Software, 92(10).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (instantiate::stan_cmdstan_exists()) {
  data(actg019)
  data(actg036)
  ## take subset for speed purposes
  actg019   = actg019[1:100, ]
  actg036   = actg036[1:50, ]
  formula   = cd4 ~ treatment + age + race
  family    = poisson()
  data_list = list(currdata = actg019, histdata = actg036)
  d.cp      = glm.commensurate(
    formula = formula,
    family = family,
    data.list = data_list,
    p.spike = 0.1,
    chains = 1, iter_warmup = 500, iter_sampling = 1000
  )
  glm.logml.commensurate(
    post.samples = d.cp,
    bridge.args = list(silent = TRUE),
    chains = 1, iter_warmup = 500, iter_sampling = 1000
  )
}
</code></pre>


</div>