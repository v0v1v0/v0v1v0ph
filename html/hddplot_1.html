<div class="container">

<table style="width: 100%;"><tr>
<td>accTrainTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two subsets of data each take in turn the role of test set</h2>

<h3>Description</h3>

<p>A division of data is specified, for use of linear discriminant analysis,
into a training and test set. Feature selection and model fitting is
formed, first with I/II as training/test, then with II/I as training/test
</p>


<h3>Usage</h3>

<pre><code class="language-R">accTrainTest(x = matrix(rnorm(1000), ncol=20), cl = factor(rep(1:3,c(7,9,4))),
 traintest = divideUp(cl, nset=2), nfeatures = NULL, print.acc = FALSE,
 print.progress=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix; rows are features, and columns are observations
('samples')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Factor that classifies columns into groups that will classify
the data for purposes of discriminant calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traintest</code></td>
<td>
<p>Values that specify a division of observations into
two groups. In the first pass (fold), one to be training and the other test,
with the roles then reversed in a second pass or fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfeatures</code></td>
<td>
<p>integer: numbers of features for which calculations are
required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.acc</code></td>
<td>
<p>logical: should accuracies be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.progress</code></td>
<td>
<p>logical: should progress by feature number be printed?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sub1.2</code></td>
<td>
<p>row numbers of features, by order of values of the group
separation measure, for the first subset (I) of the <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc1.2</code></td>
<td>
<p>accuracies, with I as training set and II as test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub2.1</code></td>
<td>
<p>row numbers of features, by order of values of the group
separation measure, for the second subset (II) of the <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc2.1</code></td>
<td>
<p>accuracies, with II as training set and I as test</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>John Maindonald</p>


<h3>Examples</h3>

<pre><code class="language-R">mat &lt;- matrix(rnorm(1000), ncol=20)
cl &lt;- factor(rep(1:3, c(7,9,4)))
gp.id &lt;- divideUp(cl, nset=2)
accTrainTest(x=mat, cl=cl, traintest=gp.id,
             nfeatures=1:16, print.acc=TRUE, print.progress=TRUE)

## The function is currently defined as
function(x=matrix(rnorm(1000), ncol=20), cl = factor(rep(1:3, c(7,9,4))),
         traintest=divideUp(cl, nset=2), nfeatures=NULL, print.acc=FALSE){
    traintest &lt;- factor(traintest)
    train &lt;- traintest==levels(traintest)[1]
    testset &lt;- traintest==levels(traintest)[2]
    cl1 &lt;- cl[train]
    cl2 &lt;- cl[testset]
    ng1 &lt;- length(cl1)
    ng2 &lt;- length(cl2)
    maxg &lt;- max(c(ng1-length(unique(cl1))-2,
                  ng2-length(unique(cl2))-2))
    if(is.null(nfeatures)){
      max.features &lt;- maxg
      nfeatures &lt;- 1:max.features
    } else
    {
      if(max(nfeatures)&gt;maxg)nfeatures &lt;- nfeatures[nfeatures&lt;=maxg]
      max.features &lt;- max(nfeatures)
    }
    ord1 &lt;- orderFeatures(x, cl, subset=train)[1:max.features]
    ord2 &lt;- orderFeatures(x, cl, subset=testset)[1:max.features]
    ord &lt;- unique(c(ord1, ord2))
    sub1 &lt;- match(ord1, ord)
    sub2 &lt;- match(ord2, ord)
    df1 &lt;- data.frame(t(x[ord, train]))
    df2 &lt;- data.frame(t(x[ord, testset]))
    acc1 &lt;- acc2 &lt;- numeric(max(nfeatures))
    for(i in nfeatures){
      if(print.progress)cat(paste(i, ":", sep=""))
      df1.lda &lt;- lda(df1[, sub1[1:i], drop=FALSE], cl1)
      hat2 &lt;- predict(df1.lda, newdata=df2[, sub1[1:i], drop=FALSE])$class
      tab &lt;- table(hat2, cl2)
      acc1[i] &lt;- sum(tab[row(tab)==col(tab)])/sum(tab)
      df2.lda &lt;- lda(df2[, sub2[1:i], drop=FALSE], cl2)
      hat1 &lt;- predict(df2.lda, newdata=df1[, sub2[1:i], drop=FALSE])$class
      tab &lt;- table(hat1, cl1)
      acc2[i] &lt;- sum(tab[row(tab)==col(tab)])/sum(tab)
    }
    cat("\n")
    if(print.acc){
      print(round(acc1,2))
      print(round(acc2,2))
    }
    maxacc1 &lt;- max(acc1)
    maxacc2 &lt;- max(acc2)
    sub1 &lt;- match(maxacc1, acc1)
    sub2 &lt;- match(maxacc2, acc2)
    nextacc1 &lt;- max(acc1[acc1&lt;1])
    nextacc2 &lt;- max(acc1[acc1&lt;2])
    lower1 &lt;- maxacc1-sqrt(nextacc1*(1-nextacc1)/ng1)
    lower2 &lt;- maxacc2-sqrt(nextacc2*(1-nextacc2)/ng2)
    lsub1 &lt;- min((1:ng1)[acc1&gt;lower1])
    lsub2 &lt;- min((1:ng2)[acc2&gt;lower2])
    lower &lt;- c("Best accuracy, less 1SD  ",
               paste(paste(round(c(lower1, lower2),2), c(lsub1, lsub2),
                           sep=" ("), " features)   ", sep=""))
    best &lt;- c("Best accuracy",
              paste(paste(round(c(maxacc1, maxacc2),2), c(sub1, sub2),
                          sep=" ("), " features)", sep=""))
    acc.df &lt;- cbind(lower, best)
    dimnames(acc.df) &lt;- list(c("Training/test split",
                               "I (training) / II (test)    ",
                               "II (training) / I (test)    "),c("",""))
    print(acc.df, quote=FALSE)
    invisible(list(sub1.2=ord1, acc1.2=acc1, sub2.1=ord2, acc2.1=acc2))
  }
</code></pre>


</div>