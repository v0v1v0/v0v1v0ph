<div class="container">

<table style="width: 100%;"><tr>
<td>Pilliat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pilliat multiple change-point detection algorithm</h2>

<h3>Description</h3>

<p>R wrapper function for C implementation of the multiple change-point detection algorithm by Pilliat et al. (2023), using seeded intervals generated by Algorithm 4 in Moen et al. (2023). For the sake of simplicity, detection thresholds are chosen independently of the width of the interval in which a change-point is tested for (so <code class="reqn">r=1</code> is set for all intervals).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Pilliat(
  X,
  threshold_d_const = 4,
  threshold_bj_const = 6,
  threshold_partial_const = 4,
  K = 2,
  alpha = 1.5,
  empirical = FALSE,
  threshold_dense = NULL,
  thresholds_partial = NULL,
  thresholds_bj = NULL,
  N = 100,
  tol = 0.01,
  rescale_variance = TRUE,
  test_all = FALSE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of observations, where each row contains a time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_d_const</code></td>
<td>
<p>Leading constant for the analytical detection threshold for the dense statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_bj_const</code></td>
<td>
<p>Leading constant for <code class="reqn">p_0</code> when computing the detection threshold for the Berk-Jones statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_partial_const</code></td>
<td>
<p>Leading constant for the analytical detection threshold for the partial sum statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Parameter for generating seeded intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Parameter for generating seeded intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>If <code>TRUE</code>, detection thresholds are based on Monte Carlo simulation using <code>Pilliat_calibrate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_dense</code></td>
<td>
<p>Manually specified value of detection threshold for the dense statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds_partial</code></td>
<td>
<p>Vector of manually specified detection thresholds for the partial sum statistic, for sparsities/partial sums <code class="reqn">t=1,2,4,\ldots,2^{\lfloor \log_2(p)\rfloor} </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds_bj</code></td>
<td>
<p>Vector of manually specified detection thresholds for the Berk-Jones statistic, order corresponding to <code class="reqn">x=1,2,\ldots,x_0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>If <code>empirical=TRUE</code>, <code>N</code> is the number of Monte Carlo samples used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>If <code>empirical=TRUE</code>, <code>tol</code> is the false error probability tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_variance</code></td>
<td>
<p>If <code>TRUE</code>, each row of the data is re-scaled by a MAD estimate (see <code>rescale_variance</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_all</code></td>
<td>
<p>If <code>TRUE</code>, the algorithm tests for a change-point in all candidate positions of each considered interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>If <code>TRUE</code>, diagnostic prints are provided during execution</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>changepoints</code></td>
<td>
<p>vector of estimated change-points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_of_changepoints</code></td>
<td>
<p>number of changepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>vector of estimated noise level for each series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoints</code></td>
<td>
<p>start point of the seeded interval detecting the corresponding change-point in <code>changepoints</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endpoints</code></td>
<td>
<p>end point of the seeded interval detecting the corresponding change-point in <code>changepoints</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Moen PAJ, Glad IK, Tveten M (2023).
“Efficient sparsity adaptive changepoint estimation.”
Arxiv preprint, 2306.04702, <a href="https://doi.org/10.48550/arXiv.2306.04702">https://doi.org/10.48550/arXiv.2306.04702</a>.<br><br> Pilliat E, Carpentier A, Verzelen N (2023).
“Optimal multiple change-point detection for high-dimensional data.”
<em>Electronic Journal of Statistics</em>, <b>17</b>(1), 1240 – 1315.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(HDCD)
n = 50
p = 50
set.seed(100)
# Generating data
X = matrix(rnorm(n*p), ncol = n, nrow=p)
# Adding a single sparse change-point:
X[1:5, 26:n] = X[1:5, 26:n] +2

# Vanilla Pilliat:
res = Pilliat(X)
res$changepoints

# Manually setting leading constants for detection thresholds
res = Pilliat(X, threshold_d_const = 4, threshold_bj_const = 6, threshold_partial_const=4)
res$changepoints #estimated change-point locations

# Empirical choice of thresholds:
res = Pilliat(X, empirical = TRUE, N = 100, tol = 1/100)
res$changepoints

# Manual empirical choice of thresholds (equivalent to the above)
thresholds_emp = Pilliat_calibrate(n,p, N=100, tol=1/100)
thresholds_emp$thresholds_partial # thresholds for partial sum statistic
thresholds_emp$thresholds_bj # thresholds for Berk-Jones statistic
thresholds_emp$threshold_dense # thresholds for Berk-Jones statistic
res = Pilliat(X, threshold_dense =thresholds_emp$threshold_dense, 
              thresholds_bj = thresholds_emp$thresholds_bj,
              thresholds_partial =thresholds_emp$thresholds_partial )
res$changepoints
</code></pre>


</div>