<div class="container">

<table style="width: 100%;"><tr>
<td>HMM_simulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generating Realizations of a Hidden Markov Model
</h2>

<h3>Description</h3>

<p>This function generates a sequence of hidden states of a Markov chain and a corresponding parallel sequence of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HMM_simulation(size, m, delta = rep(1 / m, times = m), 
               gamma = 0.8 * diag(m) + rep(0.2 / m, times = m), 
               distribution_class, distribution_theta, 
               obs_range = c(NA, NA), obs_round = FALSE, 
               obs_non_neg = FALSE, plotting = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>length of the time-series of hidden states and observations (also <code>T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a (finite) number of states in the hidden Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>a vector object containing starting values for the marginal probability distribution of the <code>m</code> states of the Markov chain at the time point <code>t=1</code>.  Default is <code>delta=rep(1/m,times=m)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>a matrix (<code>nrow=ncol=m</code>) containing starting values for the transition matrix of the hidden Markov chain.  
</p>
<p>Default is <code>gamma=0.8 * diag(m)</code> <code> + rep(0.2 / m, times = m)</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_class</code></td>
<td>

<p>a single character string object with the abbreviated name of the <code>m</code> observation distributions of the Markov dependent observation process.  The following distributions are supported by this algorithm: Poisson (<code>pois</code>); generalized Poisson (<code>genpois</code>); normal (<code>norm</code>, discrete log-Likelihood not applicable by this algorithm); geometric (<code>geom</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_theta</code></td>
<td>

<p>a list object containing starting values for the parameters of the <code>m</code> observation distributions that are dependent on the hidden Markov state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_range</code></td>
<td>

<p>a vector object specifying the range for the observations to be generated.  For instance, the vector <code>c(0,1500)</code> allows only observations between 0 and 1500 to be generated by the HMM.  Default value is <code>FALSE</code>.  See Notes for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_round</code></td>
<td>

<p>a logical object. <code>TRUE</code> if all generated observations are natural.  Default value is <code>FALSE</code>.  See Notes for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_non_neg</code></td>
<td>

<p>a logical object. <code>TRUE</code>, if non negative observations are generated.  Default value is <code>FALSE</code>.  See Notes for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotting</code></td>
<td>
<p>a numeric value between 0 and 5 (generates different outputs). NA suppresses graphical output. Default value is <code>0</code>.<br><code>0</code>: output 1-5 <br><code>1</code>: summary of all results <br><code>2</code>: generated time series of states of the hidden Markov chain  <br><code>3</code>: means (of  the observation distributions, which depend on the states of the Markov chain) along the time series of states of the hidden Markov chain <br><code>4</code>: observations along the time series of states of the hidden Markov chain <br><code>5</code>: simulated observations</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function <code> HMM_simulation </code> returns a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>length of the generated time-series of hidden states and observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>input number of states in the hidden Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector object containing the chosen values for the marginal probability distribution of the <code>m</code> states of the Markov chain at the time point <code>t=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>a matrix containing the chosen values for the transition matrix of the hidden Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_class</code></td>
<td>
<p>a single character string object with the abbreviated name of the chosen observation distributions of the Markov dependent observation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution_theta</code></td>
<td>
<p>a list object containing the chosen values for the parameters of the <code>m</code> observation distributions that are dependent on the hidden Markov state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markov_chain</code></td>
<td>
<p>a vector object containing the generated sequence of states of the hidden Markov chain of the HMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means_along_markov_chain</code></td>
<td>
<p>a vector object containing the sequence of means (of the state dependent distributions) corresponding to the generated sequence of states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observations</code></td>
<td>
<p>a vector object containing the generated sequence of (state dependent) observations of the HMM.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Some notes regarding the default values:
</p>
<p><code>gamma</code>: <br>
The default setting assigns higher probabilities for remaining in a state than changing into another.  
</p>
<p><code>obs_range</code>:<br>
Has to be used with caution. since it manipulates the results of the HMM. If a value for an observation at time <code>t</code> is generated outside the defined range, it will be regenerated as long as it falls into <code>obs_range</code>. It is possible just to define one boundary, e.g. <code>obs_range=c(NA,2000)</code> for observations lower than 2000, or <code>obs_range=c(100,NA)</code> for observations higher than 100. 
</p>
<p><code>obs_round </code>:<br>
Has to be used with caution!  Rounds each generated observation and hence manipulates the results of the HMM (important for the normal distribution based HMM). 
</p>
<p><code>obs_ non_neg</code>:<br>
Has to be used with caution, since it manipulates the results of the HMM. If a negative value for an observation at a time <code>t</code> is generated, it will be re-generated as long as it is non-negative (important for the normal distribution based HMM).
</p>


<h3>Author(s)</h3>

<p>Vitali Witowski (2013).
</p>


<h3>See Also</h3>

<p><code>AIC_HMM</code>, 
<code>BIC_HMM</code>, 
<code>HMM_training</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
################################################################
### i.) Generating a HMM with Poisson-distributed data #########
################################################################

Pois_HMM_data &lt;- 
   HMM_simulation(size = 300, 
      m = 5, 
      distribution_class = "pois", 
      distribution_theta = list( lambda=c(10,15,25,35,55)))

print(Pois_HMM_data)

################################################################
### ii.) Generating 6 physical activities with normally ########
###      distributed accelerometer counts using a HMM. #########
################################################################

## Define number of time points (1440 counts equal 6 hours of 
## activity counts assuming an epoch length of 15 seconds).
size &lt;- 1440

## Define 6 possible physical activity ranges
m &lt;- 6

## Start with the lowest possible state 
## (in this case with the lowest physical activity)
delta &lt;- c(1, rep(0, times = (m - 1)))

## Define transition matrix to generate according to a 
## specific activity 
gamma &lt;- 0.935 * diag(m) + rep(0.065 / m, times = m)

## Define parameters 
## (here: means and standard deviations for m=6 normal 
##  distributions that define the distribution in 
##  a phsycial acitivity level)
distribution_theta &lt;- list(mean = c(0,100,400,600,900,1200), 
   sd = rep(x = 200, times = 6))

### Assume for each count an upper boundary of 2000
obs_range &lt;-c(NA,2000)

### Accelerometer counts shall not be negative
obs_non_neg &lt;-TRUE

### Start simulation

accelerometer_data &lt;- 
   HMM_simulation(size = size, 
     m = m, 
     delta = delta, 
     gamma = gamma, 
     distribution_class = "norm", 
     distribution_theta = distribution_theta, 
     obs_range = obs_range, 
     obs_non_neg= obs_non_neg, plotting=0)

print(accelerometer_data)
</code></pre>


</div>