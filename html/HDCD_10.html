<div class="container">

<table style="width: 100%;"><tr>
<td>Inspect_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inspect single change-point test</h2>

<h3>Description</h3>

<p>R wrapper for C function testing for a single change-point using Inspect Wang and Samworth (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Inspect_test(
  X,
  lambda = NULL,
  xi = NULL,
  eps = 1e-10,
  empirical = FALSE,
  N = 100,
  tol = 1/100,
  maxiter = 10000,
  rescale_variance = TRUE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of observations, where each row contains a time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Manually specified value of <code class="reqn">\lambda</code> (can be <code>NULL</code>, in which case <code class="reqn">\lambda \gets \sqrt{\log(p\log n)/2}</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>Manually specified value of <code class="reqn">\xi</code> (can be NULL, in which case <code class="reqn">\xi \gets 4\sqrt{\log(np)}</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Threshold for declaring numerical convergence of the power method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>If <code>TRUE</code>, the detection threshold <code class="reqn">xi</code> is based on Monte Carlo simulation using <code>Inspect_test_calibrate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>If <code>empirical=TRUE</code>, <code>N</code> is the number of Monte Carlo samples used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>If <code>empirical=TRUE</code>, <code>tol</code> is the false error probability tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations for the power method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_variance</code></td>
<td>
<p>If <code>TRUE</code>, each row of the data is re-scaled by a MAD estimate using <code>rescale_variance</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>If <code>TRUE</code>, diagnostic prints are provided during execution</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>1 if a change-point is detected, 0 otherwise
</p>


<h3>References</h3>

<p>Wang T, Samworth RJ (2018).
“High dimensional change point estimation via sparse projection.”
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>80</b>(1), 57–83.
ISSN 1467-9868, <a href="https://doi.org/10.1111/rssb.12243">doi:10.1111/rssb.12243</a>, <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/rssb.12243">https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/rssb.12243</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(HDCD)
n = 50
p = 50

# Generating data
X = matrix(rnorm(n*p), ncol = n, nrow=p)
Y = matrix(rnorm(n*p), ncol = n, nrow=p)

# Adding a single sparse change-point to X (and not Y):
X[1:5, 26:n] = X[1:5, 26:n] +1

# Vanilla Inspect:
resX = Inspect_test(X)
resX
resY = Inspect_test(Y)
resY

# Manually setting \lambda and \xi:
resX = Inspect_test(X, 
                    lambda = sqrt(log(p*log(n))/2),
                    xi = 4*sqrt(log(n*p))
)
resX 
resY = Inspect_test(Y, 
                    lambda = sqrt(log(p*log(n))/2),
                    xi = 4*sqrt(log(n*p))
)
resY

# Empirical choice of thresholds:
resX = Inspect_test(X, empirical = TRUE, N = 100, tol = 1/100)
resX
resY = Inspect_test(Y, empirical = TRUE, N = 100, tol = 1/100)
resY

# Manual empirical choice of thresholds (equivalent to the above)
thresholds_test_emp = Inspect_test_calibrate(n,p, N=100, tol=1/100)
resX = Inspect_test(X, xi = thresholds_test_emp$max_value)
resX
resY = Inspect_test(Y, xi = thresholds_test_emp$max_value)
resY
</code></pre>


</div>