<div class="container">

<table style="width: 100%;"><tr>
<td>tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis testing</h2>

<h3>Description</h3>

<p>Tests different nulls against a free alternative
</p>


<h3>Usage</h3>

<pre><code class="language-R">equalp.test(H, startp=NULL, ...)
knownp.test(H, p, ...)
samep.test(H, i, give=FALSE, startp=NULL, ...)
specificp.test(H, i, specificp=1/size(H),
         alternative = c("two.sided","less","greater"),  ...)
specificp.ne.test(H, i, specificp=1/size(H), ...)
specificp.gt.test(H, i, specificp=1/size(H), delta=1e-5, ...)
specificp.lt.test(H, i, specificp=1/size(H), ...)
## S3 method for class 'hyper2test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>A likelihood function, an object of class <code>hyper2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>In <code>equalp.test()</code>, putative strength vector to be
tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed by <code>equalp.test()</code> to
<code>maxp()</code> and ignored by <code>print.hyper2test()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startp</code></td>
<td>
<p>Starting value for optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>A character vector of names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specificp</code></td>
<td>
<p>Strength, real number between 0 and 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis, must be one of <code>two.sided</code> (default),
<code>greater</code> or <code>less</code>.  You can specify just the initial
letter (taken from <code>t.test.Rd</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>give</code></td>
<td>
<p>Boolean, with <code>TRUE</code> meaning to return more
detailed debugging information, and default <code>FALSE</code> meaning to
return a more user-friendly object of class <code>equalp.test</code>,
which has its own print method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>equalp.test</code>, the result of
<code>equalp.test()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Small value for numerical stability</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a <code>hyper2</code> likelihood function, there are a number of
natural questions to ask about the strengths of the players; see
Hankin 2010 (JSS) for examples.  An extended discussion is presented
in vignette “<code>hyper2</code>” and the functions documented here
cover most of the tests used in the vignette.
</p>
<p>The tests return an object with class <code>hyper2test</code>, which has its
own print method.
</p>

<ul>
<li>
<p> Function <code>equalp.test(H,p)</code> tests the null that all
strengths are equal to vector <code>p</code>.  If <code>p</code> is missing, it
tests <code class="reqn">H_0\colon p_1=p_2=\cdots=p_n=\frac{1}{n}</code>, for example <code>equalp.test(icons)</code>
</p>
</li>
<li>
<p> Function <code>knownp.test()</code> tests the null that the strengths
are equal to the elements of named vector <code>p</code>; it is a
generalization of <code>equalp.test()</code>.  Example:
<code>knownp.test(icons,zipf(6))</code>. 
</p>
</li>
<li>
<p> Function <code>specificp.test(H,i,p)</code> tests
<code class="reqn">H_0\colon p_i=p</code>, for example
<code>specificp.test(icons,"NB",0.1)</code>
</p>
</li>
<li>
<p> Function <code>samep.test()</code> tests <code class="reqn">H_0\colon
  p_{i_1}=p_{i_2}=\cdots=p_{i_k}</code>, for example
<code>samep.test(icons,c("NB","L"))</code> tests that <code>NB</code> has the same
strength as <code>L</code>. 
</p>
</li>
<li>
<p> Functions <code>specificp.ne.test(H,i,p)</code>,
<code>specificp.gt.test(H,i,p)</code>, and <code>specificp.lt.test(H,i,p)</code>
are low-level helper functions that implement one- or two-sided versions
of <code>specificp.test()</code> via the <code>alternative</code> argument,
following <code>t.test()</code>
</p>
</li>
</ul>
<h3>Value</h3>

<p>The test functions return a list with class <code>"hyper2test"</code>
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the difference in support between the null and
alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the (asymptotic) p-value for the test, based on Wilks's
theorem</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the maximum likelihood estimate for <code class="reqn">p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Function <code>specificp.gt.test()</code> includes quite a bit of messing
about to ensure that frequently-used idiom like
<code>specificp.gt.test(icons,"NB",0)</code> works as expected, testing a null
of <code>p_NB=0</code> (observe that <code>specificp.ne.test(icons,"NB",0)</code>
and <code>specificp.gt.test(icons,"NB",0)</code> will (correctly) throw an
error).  In the case of testing a strength's being zero, the support
function is often quite badly-behaved near the constraint [think tossing
a coin with probability <code class="reqn">p</code> twice, observing one head and one tail,
and testing <code class="reqn">p=0</code>; at the constraint, the likelihood is zero, the
support negative infinity, and the gradient of the support is infinite].
Numerically, the code tests <code>p_NB=delta</code>.  Note that similar
machinations are not required in <code>specificp.lt.test()</code> because a
null of <code>p_NB=1</code> is unrealistic.
</p>
<p>Function <code>samep.test()</code> does not have access to gradient
information so it is slow, inaccurate, and may fail completely for
high-dimensional datasets.  If <code>any(i==n)</code>, this constrains the
fillup value; this makes no difference mathematically but the function
idiom is involved.
</p>
<p>In functions <code>specificp.??.test(H,i,...)</code>, if <code>i</code> is not
present in <code>H</code>, an error is returned although technically the
result should be “not enough evidence to reject”, as <code>H</code> is
uninformative about <code>i</code>.
</p>


<h3>See Also</h3>

<p><code>maxp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
equalp.test(chess)

# samep.test(icons,c("NB","L"))
# knownp.test(icons,zipf(icons))

</code></pre>


</div>