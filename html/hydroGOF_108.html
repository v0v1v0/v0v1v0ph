<div class="container">

<table style="width: 100%;"><tr>
<td>pfactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
P-factor
</h2>

<h3>Description</h3>

<p><var>P-factor</var> is the percent of observations that are within the given uncertainty bounds. <br></p>
<p>Ideally, i.e., with a combination of model structure and parameter values that perfectly represents the catchment under study, and in absence of measurement errors and other additional sources of uncertainty, all the simulated values should be in a perfect match with the observations, leading to a <var>P-factor</var> equal to 1, and an <var>R-factor</var> equal to zero. However, in real-world applications we aim at encompassing as much observations as possible within the given uncertainty bounds (<var>P-factor</var> close to 1) while keeping the width of the uncertainty bounds as small as possible (<var>R-factor</var> close to 0), in order to avoid obtaining a good bracketing of observations at expense of uncertainty bounds too wide to be informative for the decision-making process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pfactor(x, ...)

## Default S3 method:
pfactor(x, lband, uband, na.rm=TRUE, ...)

## S3 method for class 'data.frame'
pfactor(x, lband, uband, na.rm=TRUE, ...)

## S3 method for class 'matrix'
pfactor(x, lband, uband, na.rm=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>ts or zoo object with the observed values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lband</code></td>
<td>

<p>numeric, ts or zoo object with the values of the lower uncertainty bound
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uband</code></td>
<td>

<p>numeric, ts or zoo object with the values of the upper uncertainty bound
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>a logical value indicating whether 'NA' values should be stripped before the computation proceeds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Percent of the <code>x</code> observations that are within the given uncertainty bounds given by <code>lband</code> and <code>uband</code>. <br></p>
<p>If <code>sim</code> and <code>obs</code> are matrixes, the returned value is a vector, with the <var>P-factor</var> between each column of <code>sim</code> and <code>obs</code>.
</p>


<h3>Note</h3>

<p>So far, the argument <code>na.rm</code> is not being taken into account.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano Bigiarini &lt;mzb.devel@gmail.com&gt;
</p>


<h3>References</h3>

<p><cite>Abbaspour, K.C.; Faramarzi, M.; Ghasemi, S.S.; Yang, H. (2009), Assessing the impact of climate change on water resources in Iran, Water Resources Research, 45(10), W10,434, doi:10.1029/2008WR007615.</cite>
</p>
<p><cite>Abbaspour, K.C., Yang, J. ; Maximov, I.; Siber, R.; Bogner, K.; Mieleitner, J. ; Zobrist, J.; Srinivasan, R. (2007), Modelling hydrology and water quality in the pre-alpine/alpine Thur watershed using SWAT, Journal of Hydrology, 333(2-4), 413-430, doi:10.1016/j.jhydrol.2006.09.014.</cite>
</p>
<p><cite>Schuol, J.; Abbaspour, K.C.; Srinivasan, R.; Yang, H. (2008b), Estimation of freshwater availability in the West African sub-continent using the SWAT hydrologic model, Journal of Hydrology, 352(1-2), 30, doi:10.1016/j.jhydrol.2007.12.025</cite>
</p>
<p><cite>Abbaspour, K.C. (2007), User manual for SWAT-CUP, SWAT calibration and uncertainty analysis programs, 93pp, Eawag: Swiss Fed. Inst. of Aquat. Sci. and Technol. Dubendorf, Switzerland.</cite>
</p>


<h3>See Also</h3>

<p><code>rfactor</code>, <code>plotbands</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- 1:10
lband &lt;- x - 0.1
uband &lt;- x + 0.1
pfactor(x, lband, uband)

lband &lt;- x - rnorm(10)
uband &lt;- x + rnorm(10)
pfactor(x, lband, uband)

#############
# Loading daily streamflows of the Ega River (Spain), from 1961 to 1970
data(EgaEnEstellaQts)
obs &lt;- EgaEnEstellaQts

# Selecting only the daily values belonging to the year 1961
obs &lt;- window(obs, end=as.Date("1961-12-31"))

# Generating the lower and upper uncertainty bounds, centred at the observations
lband &lt;- obs - 5
uband &lt;- obs + 5

pfactor(obs, lband, uband)

# Randomly generating the lower and upper uncertainty bounds
uband &lt;- obs + rnorm(length(obs))
lband &lt;- obs - rnorm(length(obs))

pfactor(obs, lband, uband)
</code></pre>


</div>