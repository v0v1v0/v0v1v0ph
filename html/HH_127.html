<div class="container">

<table style="width: 100%;"><tr>
<td>cp.calc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Rearranges and improves the legibility of the output from
the stepwise function in S-Plus.  </h2>

<h3>Description</h3>

<p>Rearranges and improves the legibility of the output from
the

<code>stepwise</code>
</p>
<p>function in S-Plus.
The output can be used for the Cp plot.
<code>cp.calc</code> works only in S-Plus.
Use

<code>regsubsets</code>
</p>
<p>in R.  The example below works in
both languages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cp.calc(sw, data, y.name)

## S3 method for class 'cp.object'
print(x, ...)

## S3 method for class 'cp.object'
x[..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sw</code></td>
<td>
<p>Output from the S-Plus

<code>stepwise</code>
</p>
<p>function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataset name from which <code>"sw"</code> was calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.name</code></td>
<td>
<p>Name of response variable for which <code>"sw"</code> was calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>"cp.object"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to <code>"["</code> or <code>"print"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>Argument to the <code>print</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>"cp.object"</code>, which is a data.frame containing information
about each model that was attempted with additional
attributes:
<code>tss</code> total sum of squares,
<code>n</code> number of observations,
<code>y.name</code> response variable,
<code>full.i</code> row name of full model.  The columns are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of parameters in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp</code></td>
<td>
<p>Cp statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss</code></td>
<td>
<p>Residual sum of squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p><code class="reqn">R^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2.adj</code></td>
<td>
<p>Adjusted <code class="reqn">R^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvars</code></td>
<td>
<p>X variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sw.names</code></td>
<td>
<p>Model name produced by <code>stepwise</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>References</h3>

<p>Heiberger, Richard M. and Holland, Burt (2015).
<em>Statistical Analysis and Data Display: An Intermediate Course with Examples in R</em>.
Second Edition.
Springer-Verlag, New York.
<a href="https://link.springer.com/book/10.1007/978-1-4939-2122-5">https://link.springer.com/book/10.1007/978-1-4939-2122-5</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## This example is from Section 9.15 of Heiberger and Holland (2004).
data(usair)
if.R(s={usair &lt;- usair}, r={})

splom(~usair, main="U.S. Air Pollution Data with SO2 response", cex=.5)
## export.eps(hh("regb/figure/regb.f1.usair.eps"))

usair$lnSO2 &lt;- log(usair$SO2)
usair$lnmfg &lt;- log(usair$mfgfirms)
usair$lnpopn &lt;- log(usair$popn)

usair[1:3,]   ## lnSO2 is in position 8, SO2 is in position 1
              ## lnmfg is in position 9, lnpopn is in position 10

splom(~usair[, c(8,2,9,10,5:7)],
              main="U.S. Air Pollution Data with 3 log-transformed variables",
              cex=.5)
## export.eps(hh("regb/figure/regb.f2.usair.eps"))

if.R(s={
  usair.step &lt;- stepwise(y=usair$lnSO2,
                         x=usair[, c(2,9,10,5:7)],
                         method="exhaustive",
                         plot=FALSE, nbest=2)
  ## print for pedagogical purposes only.  The plot of cp ~ p is more useful.
  ## The line with rss=1e35 is a stepwise() bug, that we reported to S-Plus.
  print(usair.step, digits=4)
  usair.cp &lt;- cp.calc(usair.step, usair, "lnSO2")
  ## print for pedagogical purposes only.  The plot of cp ~ p is more useful.
  usair.cp
  tmp &lt;- (usair.cp$cp &lt;= 10)
  usair.cp[tmp,]

  old.par &lt;- par(mar=par()$mar+c(0,1,0,0))
  tmp &lt;- (usair.cp$cp &lt;= 10)
  plot(cp ~ p, data=usair.cp[tmp,], ylim=c(0,10), type="n", cex=1.3)
  abline(b=1)
  text(x=usair.cp$p[tmp], y=usair.cp$cp[tmp],
       row.names(usair.cp)[tmp], cex=1.3)
  title(main="Cp plot for usair.dat, Cp&lt;10")
  par(old.par)
## export.eps(hh("regb/figure/regb.f3.usair.eps"))
},r={
  usair.regsubset &lt;- leaps::regsubsets(lnSO2~lnmfg+lnpopn+precip+raindays+temp+wind,
                                       data=usair, nbest=2)
  usair.subsets.Summary &lt;- summaryHH(usair.regsubset)
  tmp &lt;- (usair.subsets.Summary$cp &lt;= 10)
  usair.subsets.Summary[tmp,]
  plot(usair.subsets.Summary[tmp,], statistic='cp', legend=FALSE)

  usair.lm7 &lt;- lm.regsubsets(usair.regsubset, 7)
  anova(usair.lm7)
  summary(usair.lm7)
})

vif(lnSO2 ~ temp + lnmfg + lnpopn + wind + precip + raindays, data=usair)

vif(lnSO2 ~ temp + lnmfg + wind + precip, data=usair)

usair.lm &lt;- lm(lnSO2 ~ temp + lnmfg + wind + precip, data=usair)
anova(usair.lm)
summary(usair.lm, corr=FALSE)
</code></pre>


</div>