<div class="container">

<table style="width: 100%;"><tr>
<td>ModelSelection.Phase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct sets of well-fitting models as proposed by Cox, D. R. &amp; Battey, H. S. (2017)</h2>

<h3>Description</h3>

<p>This function tests low dimensional subsests of the set of retained variables from the reduction phase and any squared or interaction terms suggested at the exploratory phase. Lists of well-fitting models of each dimension are returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ModelSelection.Phase(X,Y, list.reduction, family=gaussian,
                      signif=0.01, sq.terms=NULL, in.terms=NULL,
                      modelSize=NULL, Cox.Hazard = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list.reduction</code></td>
<td>
<p>Indices of variables that where chosen at the reduction phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model. For glm this can be a character string naming a family function, a family function or the result of a call to a family function. See <code>family</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>Significance level of the likelihood ratio test against the comprehensive model. The default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sq.terms</code></td>
<td>
<p>Indices of squared terms suggested at the exploratory phase (See <code>Exploratory.Phase</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.terms</code></td>
<td>
<p>Indices of pairs of variables suggested at the exploratory phase (See <code>Exploratory.Phase</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelSize</code></td>
<td>
<p>Maximum size of the models to be tested. Curently the maximum is 7. If not provided a default is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cox.Hazard</code></td>
<td>
<p>If TRUE fits proportional hazards regression model. The family argument will be ignored if Cox.Hazard=TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>goodModels</code></td>
<td>
<p>List of models that are in the confidence set of size 1 to modelSize. An interaction term between, say, variables x_1 and x_2 is displayed as “x_1 * x_2”; a squared term in, say, variable x_1 is displayed as “x_1 ^2”. If an interaction term is present without the corresponding main effects, the main effects should be added.</p>
</td>
</tr></table>
<h3>Acknowledgement</h3>

<p>The work was supported by the UK Engineering and Physical Sciences Research Council under grant number EP/P002757/1.</p>


<h3>Author(s)</h3>

<p>Hoeltgebaum, H. H.
</p>


<h3>References</h3>

<p>Cox, D. R. and Battey, H. S. (2017). Large numbers of explanatory variables, a semi-descriptive analysis. <em>Proceedings of the National Academy of Sciences</em>, 114(32), 8592-8595.
</p>
<p>Battey, H. S. and Cox, D. R. (2018). Large numbers of explanatory variables: a probabilistic assessment. <em>Proceedings of the Royal Society of London, A.</em>, 474(2215), 20170631.
</p>
<p>Hoeltgebaum, H., &amp; Battey, H. S. (2019). HCmodelSets: An R Package for Specifying Sets of Well-fitting Models in High Dimensions. <em>The R Journal</em>, 11(2), 370-379.
</p>


<h3>See Also</h3>

<p><code>Reduction.Phase</code>, <code>Exploratory.Phase</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Generates a random DGP
dgp = DGP(s=5, a=3, sigStrength=1, rho=0.9, n=100, intercept=5, noise=1,
          var=1, d=1000, DGP.seed = 2018)

#Reduction Phase using only the first 70 observations
outcome.Reduction.Phase =  Reduction.Phase(X=dgp$X[1:70,],Y=dgp$Y[1:70],
                                           family=gaussian, seed.HC = 1012)

# Exploratory Phase using only the first 70 observations, choosing the variables which
# were selected at least two times in the third dimension reduction

idxs = outcome.Reduction.Phase$List.Selection$`Hypercube with dim 2`$numSelected1
outcome.Exploratory.Phase =  Exploratory.Phase(X=dgp$X[1:70,],Y=dgp$Y[1:70],
                                               list.reduction = idxs,
                                               family=gaussian, signif=0.01)

# Model Selection Phase using only the remainer observations
sq.terms = outcome.Exploratory.Phase$mat.select.SQ
in.terms = outcome.Exploratory.Phase$mat.select.INTER

MS = ModelSelection.Phase(X=dgp$X[71:100,],Y=dgp$Y[71:100], list.reduction = idxs,
                          sq.terms = sq.terms,in.terms = in.terms, signif=0.01)



</code></pre>


</div>