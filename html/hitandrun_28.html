<div class="container">

<table style="width: 100%;"><tr>
<td>simplex.sample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample uniformly from a simplex
</h2>

<h3>Description</h3>

<p>Generates uniform random variates over the (n-1)-simplex in n-dimensional space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simplex.sample(n, N, sort=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Dimension of the space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of samples to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Whether to sort the components in descending order</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The samples will be uniform over the (n-1)-simplex.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A matrix containing the generated samples as rows.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Gert van Valkenhoef
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 3
N &lt;- 10000
samples &lt;- simplex.sample(n, N)$samples

# Check dimension
stopifnot(dim(samples) == c(N, n))

# Check that w_i &gt;= 0
stopifnot(samples &gt;= 0)

# Check that sum_i w_i = 1
E &lt;- 1E-12
stopifnot(apply(samples, 1, sum) &gt; 1 - E)
stopifnot(apply(samples, 1, sum) &lt; 1 + E)


## Now with descending order
samples &lt;- simplex.sample(n, N, sort=TRUE)$samples

# Check dimension
stopifnot(dim(samples) == c(N, n))

# Check that w_i &gt;= 0
stopifnot(samples &gt;= 0)

# Check that sum_i w_i = 1
E &lt;- 1E-12
stopifnot(apply(samples, 1, sum) &gt; 1 - E)
stopifnot(apply(samples, 1, sum) &lt; 1 + E)

# Check w_i &gt;= w_{i+1}
stopifnot(samples[,1] &gt;= samples[,2])
stopifnot(samples[,2] &gt;= samples[,3])
</code></pre>


</div>