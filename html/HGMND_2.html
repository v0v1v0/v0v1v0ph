<div class="container">

<table style="width: 100%;"><tr>
<td>HGMND</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heterogeneous Graphical Model for Non-Negative Data</h2>

<h3>Description</h3>

<p>The <code>HGMND</code> is the main function to estimate the conditional dependence matrices of variables from different datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HGMND(x,
     setting,
     h,
     centered,
     mat.adj,
     lambda1,
     lambda2,
     gamma   = 1,
     maxit   = 200,
     tol     = 1e-5,
     silent  = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of data matrices sharing the same variables in their columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setting</code></td>
<td>
<p>a string that indicates the data distribution, must be chosen from <code>"gaussian"</code>, <code>"gamma"</code>, <code>"exp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the function <code>h(x)</code> used in the <code class="reqn">h</code>-generalized score matching loss, which returns a list containing <code>hx = h(x)</code> and its derivative <code>hpx = hp(x)</code>, where <code>x</code> is the data matrix. See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>
<p>logical, if <code>centered = TRUE</code>, the data distribution is assumed centered with <code class="reqn">\eta = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat.adj</code></td>
<td>
<p>the adjacency matrix of the network among the multiple datasets, containing only 0s and 1s. Only the upper-triangle of <code>mat.adj</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>the non-negative tuning parameter which controls the sparsity level of the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>the non-negative tuning parameter which controls the homogeneity level of the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>the step size parameter in ADMM. Default to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations. Default to <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance in the convergence criterion. Default to <code>1e-5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical, if <code>silent = FALSE</code>, the prime and dual feasibility and the time used in each ADMM iteration will show on the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>h</code> can be generated by function <code>get_h_hp</code> in package <code>genscore</code>. See more details in Yu S., Lin, L. &amp; Gilks, W. (2020). genscore: Generalized Score Matching Estimators. R package version 1.0.2. https://CRAN.R-project.org/package=genscore and Yu, S., Drton, M., &amp; Shojaie, A. (2019). Generalized Score Matching for Non-Negative Data. J. Mach. Learn. Res., 20, 76-1.
</p>
<p>Suppose we have <code class="reqn">M</code> datasets, and we demand the network among them to be connected and have <code class="reqn">M - 1</code> edges, hence acyclic. This is sufficient for computational feasibility, which however does not prevent our method from being applicable to diverse network structures.
</p>


<h3>Value</h3>

<p>The <code>HGMND</code> method returns the estimated conditional dependence matrix of each dataset.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>the 3-dimensional array containing the estimation of the multiple conditional dependence matrices. The 3rd dimension represents different datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>an integer, the number of datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>an integer, dimension of the random vector of interest.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yu, S., Drton, M., &amp; Shojaie, A. (2019). Generalized Score Matching for Non-Negative Data. J. Mach. Learn. Res., 20, 76-1.
</p>
<p>Yu S., Lin, L. &amp; Gilks, W. (2020). genscore: Generalized Score Matching Estimators. R package version 1.0.2. https://CRAN.R-project.org/package=genscore.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># This is an example of HGMND with simulated data
data(HGMND_SimuData)
h              &lt;- genscore::get_h_hp("mcp", 1, 5)
HGMND_SimuData &lt;- lapply(HGMND_SimuData, function(x) scale(x, center = FALSE))
mat.chain      &lt;- diag(length(HGMND_SimuData))
diag(mat.chain[-nrow(mat.chain), -1]) &lt;- 1

result &lt;- HGMND(x        = HGMND_SimuData,
                setting  = "gaussian",
                h        = h,
                centered = FALSE,
                mat.adj  = mat.chain,
                lambda1  = 0.086,
                lambda2  = 3.6,
                gamma    = 1,
                tol      = 1e-3,
                silent  = TRUE)
Theta       &lt;- result[["Theta"]]
</code></pre>


</div>