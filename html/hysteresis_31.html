<div class="container">

<table style="width: 100%;"><tr>
<td>mel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate (Make) an Ellipse
</h2>

<h3>Description</h3>

<p>Produces an ellipse based on 1 of 4 possible formulations: 1-Eigenvalues, 2-Hysteresis Coefs, 3-Amplitudes and 4-Algebraic Coefs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mel(method=1,seed=NULL,...)
mel1(cx=32,cy=39,rote.deg=2,semi.major=7,semi.minor=0.23,
phase.angle=0,n.points=24,period=24,sd.x=0,sd.y=0)
mel2(cx=32,cy=39,b.x=6.99,b.y=0.244,retention=0.23,
phase.angle=0,n.points=24,period=24,sd.x=0,sd.y=0)
mel3(cx=32,cy=39,ampx=6.99,ampy=0.335,lag=2.888,phase.angle=0,
n.points=24,period=24,sd.x=0,sd.y=0)
mel4(x2=0.002293,xy=-.06960,y2=0.9976,x=2.567,y=-75.58,int=1432.7,
phase.angle=0,n.points=24,period=24,sd.x=0,sd.y=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>selects which of the functions <code>mel1</code>, <code>mel2</code>, <code>mel3</code>, <code>mel4</code> to use to describe the ellipse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>integer, the starting seed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments to the functions <code>mel1</code>, <code>mel2</code>, <code>mel3</code>, <code>mel4</code> described below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cx</code></td>
<td>

<p>Center of input x.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cy</code></td>
<td>

<p>Center of output y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase.angle</code></td>
<td>

<p>defines the starting point of the ellipse. Does not change ellipse shape.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rote.deg</code></td>
<td>

<p>Theta, angle of rotation. In degrees. Only used if <code>method=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>semi.major</code></td>
<td>

<p>Half length of major axis. Only used if <code>method=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>semi.minor</code></td>
<td>

<p>Half length of minor axis. Only used if <code>method=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.x</code></td>
<td>

<p>Saturation point x coordinate. Only used if <code>method=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.y</code></td>
<td>

<p>Saturation point y coordinate. Only used if <code>method=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retention</code></td>
<td>

<p>another ellipse parameter used if <code>method=2</code>. split point, representing vertical distance from center to upper loop trajectory. It is the intersection of the loop and the output axis characterizing the distortion in the response at the average input challenge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ampx</code></td>
<td>

<p>The range of the ellipse input values divided by 2. Only used if <code>method=3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ampy</code></td>
<td>

<p>The range of the ellipse output values divided by 2. Only used if <code>method=3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>

<p>The number of points between the location where the input reaches its maximum value and where the output reaches its maximum value.
Lag is therefore dependent on the value chosen for period. Only used if <code>method=3</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>

<p>Coefficient on x^2 in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>

<p>Coefficient on xy in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2</code></td>
<td>

<p>Coefficient on y^2 in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Coefficient on x in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Coefficient on y in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>

<p>Coefficient on the intercept in the equation found in details. Only used if <code>method=4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>

<p>Number of points on ellipse. Equally spaced around circumference of ellipse/period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>

<p>Number of points required to make a full loop around the ellipse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.x</code></td>
<td>

<p>optional number specifying a normally distributed standard deviation for x.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.y</code></td>
<td>

<p>optional number specifying a normally distributed standard deviation for y.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All of the four methods can be used to specify a series of points that make up an ellipse. The function <code>mel</code>
uses parameters to form an ellipse and find derived variables such as area, lag, retention, and coercion. 
Optionally, normally distributed random variation can be introduced in both the x and y directions. The first method is useful alongside the nls, lm and direct fitting methods,
while the second is comparable to the harmonic2 ellipse fitting method. The third method for mel is included because it is the easiest to interpret. Finally the fourth method uses the equation 0=a0+a1*x^2+a2*xy+a3*y^2+a4*x+a5*y to form an ellipse. The "a" parameters here are marked as int, x2, xy, y2, x and y in the function itself.</p>


<h3>Value</h3>

<p>mel returns an object of class <code>ellipsemake</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>the nine fundamental parameters (cx,cy,rote.deg,semi.major,semi.minor,b.x,b.y,a,phase.angle) of which only four or five are used 
along with the four derived parameters (area, lag, retention, coercion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the input x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the output y.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Spencer Maynes, Fan Yang, and Anne Parkhurst.
</p>


<h3>References</h3>

<p>Yang, F. and A. Parkhurst, Efficient Estimation of Elliptical Hysteresis. (submitted)
</p>


<h3>See Also</h3>

<p><code>fel</code> for fitting observations that form an ellipse and creating an <code>ellipsefit</code> object, <code>plot.ellipsefit</code>for plotting an <code>ellipsefit</code> object.
<code>summary.ellipsefit</code> for summarizing an <code>ellipsefit</code> object, and <code>plot.ellipsesummary</code> for plotting an <code>ellipsesummary</code> object.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">ellipseA &lt;- mel(method=3,cx=35, cy=39, ampx=7, ampy=2, lag=3, sd.x=0.2,sd.y=0.04)
 ellipseA.fit &lt;- fel(ellipseA$x,ellipseA$y)
  plot(ellipseA.fit,xlab="Input",ylab="Output",main="Simulated Ellipse",
  putNumber=TRUE)
 boot.ellipseA.fit &lt;- fel(ellipseA$x,ellipseA$y, boot=TRUE, seed=231)
  plot(boot.ellipseA.fit,xlab="Input",ylab="Output",
  main="Bootstrapped Ellipse",values="ellipse.all")

ellipse.eig &lt;- mel(semi.major=7,semi.minor=4,rote.deg=30)
ellip.eigen.fit &lt;- fel(ellipse.eig$x,ellipse.eig$y)
ellip.eigen.fit$Estimates
plot(ellip.eigen.fit,main="Ellipse from Eigenvalue Parameters",
show=c("semi.major","semi.minor","rote.deg"),values="ellipse")
</code></pre>


</div>