<div class="container">

<table style="width: 100%;"><tr>
<td>det_hrz_restr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determination of the high-risk zone.</h2>

<h3>Description</h3>

<p><code>det_hrz_restr</code> determines the high-risk zone through the method of fixed radius
(type = "dist" and criterion = "direct"), the quantile-based method (type = "dist" and
criterion = "area"/"indirect") and the intensity-based method (type =  "intens").
Restriction areas can be taken into account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">det_hrz_restr(
  ppdata,
  type,
  criterion,
  cutoff,
  hole = NULL,
  integratehole = TRUE,
  obsprobs = NULL,
  obsprobimage = NULL,
  distancemap = NULL,
  intens = NULL,
  nxprob = 0.1,
  covmatrix = NULL,
  returnintens = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code>(method of fixed radius or quantile-based method), or
<code>"intens"</code>(intensity based method)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold).
Depending on criterion and type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hole</code></td>
<td>
<p>(optional) an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integratehole</code></td>
<td>
<p>Should the <code>hole</code> be part of the resulting high-risk zone? Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsprobs</code></td>
<td>
<p>(optional)  Vector of observation probabilities associated with the observations contained in <code>ppdata</code>.
Must be given in the same order as the coordinates of the observations. Only meaningful
for the intensity-based method if some observations are located in areas where not all
events can actually be observed. For example, if only one third of the events in a specific region
could be observed, the observation probability of the corresponding observations
is 1/3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsprobimage</code></td>
<td>
<p>(optional) an object of class <code>im</code> giving the observation probabilities inside the
observation window. Ranges of the coordinates must equal those of <code>ppdata</code>.
Only used if <code>obsprobs</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation
of the point pattern; only needed for <code>type="dist"</code>. If not given,
it will be computed by <code>distmap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class "im",
see <code>density.ppp</code>), only needed for type="intens". If not given,
it will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnintens</code></td>
<td>
<p>Should the image of the estimated intensity be returned? Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Used in functions eval_method, sim_clintens, sim_intens.
<br>
This function contains the same functionalities as <code>det_hrz</code>.
In addition, it offers the possibility to take into account so-called restriction areas. This is relevant in
situations where the observed point pattern <code>ppdata</code> is incomplete. If it is known that no observations
can be made in a certain area (for example because of water expanses),
this can be accounted for by integrating a hole in the observation window.
The shape and location of the hole is given by <code>hole</code>, whereas <code>integratehole</code> is used to state
whether the hole is to become part of the resulting high-risk zone.
This may also be a reasonable approach if only few observations could be made in a certain area.
Another approach consists in weighting the observed events with their reciprocal observation probability when
estimating the intensity. To do so, the observation probability can be specified by using <code>obsprobs</code> (value of the
observation probability for each event) or <code>obsprobsimage</code> (image of the observation probability). Note that the
observation probability may vary in space.
<br>
If there are no restriction areas in the observation window, <code>det_hrz</code>
can be used instead.
<br>
Note that for <code>criterion = "area"</code>, <code>cutoff</code> specifies the area of the high-risk zone outside the hole. If
<code>integratehole = TRUE</code>, the area of the resulting high-risk zone will exceed <code>cutoff</code>.
</p>
<p>For further information, Mahling et al. (2013) and Mahling (2013), Chapters 4 and 8 and Appendix A (References).
</p>


<h3>Value</h3>

<p>An object of class "<code>highriskzone</code>", which is a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code> typehrz, criterion, cutoff, nxprob</code></td>
<td>
<p> see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> zone </code></td>
<td>
<p> Determined high-risk zone: Object of class "owin" based on a binary mask.
See <code>owin</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> threshold </code></td>
<td>
<p> determined threshold. If type = "dist" and criterion = "direct" it is the specified radius.
If criterion = "indirect" or "area" the determined radius used to construct a risk zone fulfilling the specified criterion 
and cutoff. If type = "dist" it is the specified or calculated threshold c, the maximum intensitiy of unexploded bombs 
outside the risk zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> calccutoff </code></td>
<td>
<p> determined cutoff-value. For type="dist" and criterion="area", this is the
quantile of the nearest-neighbour distance. For type="intens" and criterion="area" or "direct", it is the failure
probability alpha. For all other criterions it is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> covmatrix </code></td>
<td>
<p> If not given (and <code>type="intens"</code>), it is estimated. See <code>Hscv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> estint </code></td>
<td>
<p> Estimated intensity. See <code>density.ppp</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>distmap</code>, <code>eval.im</code>, <code>owin</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1211515)
data(craterA)
#change npixel = 100 to 1000 to get a nicer picture
spatstat.geom::spatstat.options(npixel=100)
# reduce number of observations for faster computation
craterA &lt;- craterA[sample(1:craterA$n, 150)]
# define restriction area
restrwin &lt;- spatstat.geom::owin(xrange=craterA$window$xrange, yrange=craterA$window$yrange,
                           poly=list(x=c(1500, 1500, 2000, 2000), y=c(2000, 1500, 1500, 2000)))

# create image of observation probability (30% inside restriction area)
wim &lt;- spatstat.geom::as.im(craterA$window, value=1)
rim &lt;- spatstat.geom::as.im(restrwin, xy=list(x=wim$xcol, y=wim$yrow))
rim$v[is.na(rim$v)] &lt;- 0
oim1 &lt;- spatstat.geom::eval.im(wim - 0.7 * rim)
# determine high-risk zone by weighting the observations
hrzi1 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
                       cutoff = 0.4, hole=NULL, obsprobs=NULL, obsprobimage=oim1, nxprob = 0.1)

# determine high-risk zone by accounting for a hole
hrzi2 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
                       cutoff = 0.4, hole=restrwin, obsprobs=NULL, obsprobimage=NULL, nxprob = 0.1)
</code></pre>


</div>