<div class="container">

<table style="width: 100%;"><tr>
<td>hmap.annotate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add a row and column annotations to a plot-region based heatmap built with 'hmap'
</h2>

<h3>Description</h3>

<p>Annotation of rows or columns in a 'hmap'-plot. By default, rectangles aligned with either rows or columns are plotted to the right-side or lower-side of the heatmap respectively. User-specified customizations may be given to change these annotations in positioning or type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmap.annotate(h, rw, rw.n = length(unique(rw)), rw.col = rainbow(rw.n,
                 start = 0.05, end = 0.5), rw.wid, rw.hei, rw.pch,
                 rw.x = rep(min(h$rightlim), times =
                 length(h$rowtext$xseq)), rw.y = h$rowtext$yseq, rw.shift
                 = c(0.02, 0), cl, cl.n
                 = length(unique(cl)), cl.col = rainbow(cl.n, start =
                 0.55, end = 1), cl.wid, cl.hei, cl.pch, cl.x =
                 h$coltext$xseq, cl.y = rep(max(h$bottomlim), times =
                 length(h$coltext$yseq)), cl.shift = c(0, -0.02), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>The list of heatmap parameters returned invisibly by the original 'hmap'-call.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw</code></td>
<td>

<p>Annotation vector for rows 'r', each unique instance is given a different color (or pch) and plotted right-side of the corresponding heatmap rows
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.n</code></td>
<td>

<p>Number of unique colors (or pch) to give each annotated row
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.col</code></td>
<td>

<p>A vector for color values for unique instances in 'r' for annotating rows
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.wid</code></td>
<td>

<p>The widths for annotation boxes for each row 'r'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.hei</code></td>
<td>

<p>The heights for annotation boxes for each row 'r'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.pch</code></td>
<td>

<p>Alternatively, instead of widths and heights user may specify a symbol 'pch' to use for annotating each row
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.x</code></td>
<td>

<p>The x-coordinate locations for the row annotations, by default right side of heatmap itself
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.y</code></td>
<td>

<p>The y-coordinate locations for the row annotations, by default same vertical locations as for the heatmap rows
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.shift</code></td>
<td>

<p>Row annotation shift: a vector of 2 values, where first indicates the amount of x-axis shift desired and the second indicates the amount of y-axis shift
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>Annotation vector for columns 'r', each unique instance is given a different color (or pch) and plotted lower-side of the corresponding heatmap columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.n</code></td>
<td>

<p>Number of unique colors (or pch) to give each annotated column
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.col</code></td>
<td>

<p>A vector for color values for unique instances in 'c' for annotating columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.wid</code></td>
<td>

<p>The widths for annotation boxes for each column 'c'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.hei</code></td>
<td>

<p>The heights for annotation boxes for each column 'c'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.pch</code></td>
<td>

<p>Alternatively, instead of widths and heights user may specify a symbol 'pch' to use for annotating each column
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.x</code></td>
<td>

<p>The x-coordinate locations for the column annotations, by default same horizontal locations as for the heatmap columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.y</code></td>
<td>

<p>The y-coordinate locations for the column annotations, by default lower side of heatmap itself
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.shift</code></td>
<td>

<p>Column annotation shift: a vector of 2 values, where first indicates the amount of x-axis shift desired and the second indicates the amount of y-axis shift
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional parameters supplied either to 'rect' or 'points' function if user desired rectangles or 'pch'-based points respectively
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Teemu Daniel Laajala &lt;teelaa@utu.fi&gt;
</p>


<h3>See Also</h3>

<p><code>heatmap</code>
<code>hmap.key</code>
<code>hmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some data
set.seed(1)
r1 &lt;- replicate(30, rnorm(20))
lab &lt;- sample(letters[1:2], 20, replace=TRUE)
r1[lab==lab[1],] &lt;- r1[lab==lab[1],] + 2
r2a &lt;- replicate(10, rnorm(10))
r2b &lt;- replicate(10, rnorm(10))

# Set up a new plot region, notice we have a 2-fold wider x-axis
plot.new()
plot.window(xlim=c(0,2), ylim=c(0,1))

# Plot an example plot along with the color key and annotations for our 'lab' vector
h1 &lt;- hmap(r1, add = TRUE)
hmap.key(h1, x1=0.18)
hmap.annotate(h1, rw = lab, rw.wid=c(0.82,0.90))

# Plot the rest to show how the coordinates are adjusted to place the heatmap(s) differently
h2a &lt;- hmap(r2a, add = TRUE, xlim=c(1.2, 1.8), leftlim=c(1.0, 1.2), 
	rightlim=c(1.8,2.0), ylim=c(0.6, 1.0), bottomlim=c(0.5,0.6), Colv=NA)
h2b &lt;- hmap(r2b, add = TRUE, xlim=c(1.2, 1.8), leftlim=c(1.0, 1.2), 
	rightlim=c(1.8,2.0), ylim=c(0.1, 0.5), bottomlim=c(0.0,0.1), Colv=NA)

# Show the normal plot region axes 
axis(1, at=c(0.5,1.5), c("A", "B"))


</code></pre>


</div>