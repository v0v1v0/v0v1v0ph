<div class="container">

<table style="width: 100%;"><tr>
<td>h2_pairwise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise Interaction Strength</h2>

<h3>Description</h3>

<p>Friedman and Popescu's statistic of pairwise interaction strength, see Details.
Use <code>plot()</code> to get a barplot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">h2_pairwise(object, ...)

## Default S3 method:
h2_pairwise(object, ...)

## S3 method for class 'hstats'
h2_pairwise(
  object,
  normalize = TRUE,
  squared = TRUE,
  sort = TRUE,
  zero = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class "hstats".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Should statistics be normalized? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Should <em>squared</em> statistics be returned? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Should results be sorted? Default is <code>TRUE</code>.
(Multi-output is sorted by row means.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero</code></td>
<td>
<p>Should rows with all 0 be shown? Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Following Friedman and Popescu (2008), if there are no interaction effects between
features <code class="reqn">x_j</code> and <code class="reqn">x_k</code>, their two-dimensional (centered) partial dependence
function <code class="reqn">F_{jk}</code> can be written as the sum of the (centered) univariate partial
dependencies <code class="reqn">F_j</code> and <code class="reqn">F_k</code>, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
  F_{jk}(x_j, x_k) = F_j(x_j)+ F_k(x_k).
</code>
</p>

<p>Correspondingly, Friedman and Popescu's statistic of pairwise
interaction strength between <code class="reqn">x_j</code> and <code class="reqn">x_k</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  H_{jk}^2 = \frac{A_{jk}}{\frac{1}{n} \sum_{i = 1}^n\big[\hat F_{jk}(x_{ij}, x_{ik})\big]^2},
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
  A_{jk} = \frac{1}{n} \sum_{i = 1}^n\big[\hat F_{jk}(x_{ij}, x_{ik}) - 
   \hat F_j(x_{ij}) - \hat F_k(x_{ik})\big]^2
</code>
</p>

<p>(check <code>partial_dep()</code> for all definitions).
</p>
<p><strong>Remarks:</strong>
</p>

<ol>
<li>
<p> Remarks 1 to 5 of <code>h2_overall()</code> also apply here.
</p>
</li>
<li> <p><code class="reqn">H^2_{jk} = 0</code> means there are no interaction effects between <code class="reqn">x_j</code>
and <code class="reqn">x_k</code>. The larger the value, the more of the joint effect of the two
features comes from the interaction.
</p>
</li>
<li>
<p> Since the denominator differs between variable pairs, unlike <code class="reqn">H_j</code>,
this test statistic is difficult to compare between variable pairs.
If both main effects are very weak, a negligible interaction can get a
high <code class="reqn">H^2_{jk}</code>. Therefore, Friedman and Popescu (2008) suggests to calculate
<code class="reqn">H^2_{jk}</code> only for <em>important</em> variables (see "Modification" below).
</p>
</li>
</ol>
<p><strong>Modification</strong>
</p>
<p>To be better able to compare pairwise interaction strength across variable pairs,
and to overcome the problem mentioned in the last remark, we suggest as alternative
the unnormalized test statistic on the scale of the predictions,
i.e., <code class="reqn">\sqrt{A_{jk}}</code>. Set <code>normalize = FALSE</code> and <code>squared = FALSE</code> to obtain
this statistic.
Furthermore, instead of focusing on pairwise calculations for the most <em>important</em>
features, we can select features with <em>strongest overall interactions</em>.
</p>


<h3>Value</h3>

<p>An object of class "hstats_matrix" containing these elements:
</p>

<ul>
<li> <p><code>M</code>: Matrix of statistics (one column per prediction dimension), or <code>NULL</code>.
</p>
</li>
<li> <p><code>SE</code>: Matrix with standard errors of <code>M</code>, or <code>NULL</code>.
Multiply with <code>sqrt(m_rep)</code> to get <em>standard deviations</em> instead.
Currently, supported only for <code>perm_importance()</code>.
</p>
</li>
<li> <p><code>m_rep</code>: The number of repetitions behind standard errors <code>SE</code>, or <code>NULL</code>.
Currently, supported only for <code>perm_importance()</code>.
</p>
</li>
<li> <p><code>statistic</code>: Name of the function that generated the statistic.
</p>
</li>
<li> <p><code>description</code>: Description of the statistic.
</p>
</li>
</ul>
<h3>Methods (by class)</h3>


<ul>
<li> <p><code>h2_pairwise(default)</code>: Default pairwise interaction strength.
</p>
</li>
<li> <p><code>h2_pairwise(hstats)</code>: Pairwise interaction strength from "hstats" object.
</p>
</li>
</ul>
<h3>References</h3>

<p>Friedman, Jerome H., and Bogdan E. Popescu. <em>"Predictive Learning via Rule Ensembles."</em>
The Annals of Applied Statistics 2, no. 3 (2008): 916-54.
</p>


<h3>See Also</h3>

<p><code>hstats()</code>, <code>h2()</code>, <code>h2_overall()</code>, <code>h2_threeway()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># MODEL 1: Linear regression
fit &lt;- lm(Sepal.Length ~ . + Petal.Width:Species, data = iris)
s &lt;- hstats(fit, X = iris[, -1])

# Proportion of joint effect coming from pairwise interaction
# (for features with strongest overall interactions)
h2_pairwise(s)
h2_pairwise(s, zero = FALSE)  # Drop 0

# Absolute measure as alternative
abs_h &lt;- h2_pairwise(s, normalize = FALSE, squared = FALSE, zero = FALSE)
abs_h
abs_h$M

# MODEL 2: Multi-response linear regression
fit &lt;- lm(as.matrix(iris[, 1:2]) ~ Petal.Length + Petal.Width * Species, data = iris)
s &lt;- hstats(fit, X = iris[, 3:5], verbose = FALSE)
x &lt;- h2_pairwise(s)
plot(x)
</code></pre>


</div>