<div class="container">

<table style="width: 100%;"><tr>
<td>rThresholdCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Threshold Covariance</h2>

<h3>Description</h3>

<p>Calculate the threshold covariance matrix proposed in Gobbi and Mancini (2009).
Unlike the <code>rOWCov</code>, the rThresholdCov uses univariate jump detection rules to truncate the effect of jumps on the covariance
estimate. As such, it remains feasible in high dimensions, but it is less robust to small cojumps.
</p>
<p>Let <code class="reqn">r_{t,i}</code> be an intraday <code class="reqn">N x 1</code> return vector of <code class="reqn">N</code> assets where <code class="reqn">i=1,...,M</code> and
<code class="reqn">M</code> being the number of intraday returns.
</p>
<p>Then, the <code class="reqn">k,q</code>-th element of the threshold covariance matrix is defined as
</p>
<p style="text-align: center;"><code class="reqn">
\mbox{thresholdcov}[k,q]_{t} = \sum_{i=1}^{M} r_{(k)t,i} 1_{\{r_{(k)t,i}^2 \leq TR_{M}\}}  \ \ r_{(q)t,i} 1_{\{r_{(q)t,i}^2 \leq TR_{M}\}},
</code>
</p>

<p>with the threshold value <code class="reqn">TR_{M}</code> set to <code class="reqn">9 \Delta^{-1}</code> times the daily realized bi-power variation of asset <code class="reqn">k</code>,
as suggested in Jacod and Todorov (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rThresholdCov(
  rData,
  cor = FALSE,
  alignBy = NULL,
  alignPeriod = NULL,
  makeReturns = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rData</code></td>
<td>
<p>an <code>xts</code> or <code>data.table</code> object containing returns or prices, possibly for multiple assets over multiple days.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>boolean, in case it is <code>TRUE</code>, and the input data is multivariate, the correlation is returned instead of the covariance matrix. <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignBy</code></td>
<td>
<p>character, indicating the time scale in which <code>alignPeriod</code> is expressed. 
Possible values are: <code>"ticks"</code>, <code>"secs"</code>, <code>"seconds"</code>, <code>"mins"</code>, <code>"minutes"</code>, <code>"hours"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignPeriod</code></td>
<td>
<p>positive numeric, indicating the number of periods to aggregate over. For example, to aggregate
based on a 5-minute frequency, set <code>alignPeriod = 5</code> and <code>alignBy = "minutes"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makeReturns</code></td>
<td>
<p>boolean, should be <code>TRUE</code> when <code>rData</code> contains prices instead of returns. 
<code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>used internally, do not change.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>in case the input is and contains data from one day, an <code class="reqn">N \times N</code> matrix is returned. If the data is a univariate <code>xts</code> object with multiple days, an <code>xts</code> is returned.
If the data is multivariate and contains multiple days (<code>xts</code> or <code>data.table</code>), the function returns a list containing <code class="reqn">N \times N</code> matrices. Each item in the list has a name which corresponds to the date for the matrix.
</p>


<h3>Author(s)</h3>

<p>Jonathan Cornelissen, Kris Boudt, and Emil Sjoerup.
</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Shephard, N. (2004). Measuring the impact of jumps in multivariate price processes using bipower covariation. Discussion paper, Nuffield College, Oxford University.
</p>
<p>Jacod, J. and Todorov, V. (2009). Testing for common arrival of jumps in discretely-observed multidimensional processes. <em>Annals of Statistics</em>, 37, 1792-1838.
</p>
<p>Mancini, C. and Gobbi, F. (2012). Identifying the Brownian covariation from the co-jumps given discrete observations. <em>Econometric Theory</em>, 28, 249-273.
</p>


<h3>See Also</h3>

<p><code>ICov</code> for a list of implemented estimators of the integrated covariance.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Realized threshold  Variance/Covariance:
# Multivariate:
## Not run: 
library("xts")
set.seed(123)
start &lt;- strptime("1970-01-01", format = "%Y-%m-%d", tz = "UTC")
timestamps &lt;- start + seq(34200, 57600, length.out = 23401)

dat &lt;- cbind(rnorm(23401) * sqrt(1/23401), rnorm(23401) * sqrt(1/23401))

dat &lt;- exp(cumsum(xts(dat, timestamps)))
rcThreshold &lt;- rThresholdCov(dat, alignBy = "minutes", alignPeriod = 1, makeReturns = TRUE)
rcThreshold

## End(Not run)
</code></pre>


</div>