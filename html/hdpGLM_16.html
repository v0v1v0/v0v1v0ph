<div class="container">

<table style="width: 100%;"><tr>
<td>plot_hdpglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot posterior distributions</h2>

<h3>Description</h3>

<p>this function creates a plot with two grids. One is the grid with posterior
expectation of betas as function of context-level covariates. The other is
the posterior distribution of tau
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_hdpglm(
  samples,
  X = NULL,
  W = NULL,
  ncol.taus = 1,
  ncol.betas = NULL,
  ncol.w = NULL,
  nrow.w = NULL,
  smooth.line = FALSE,
  pred.pexp.beta = FALSE,
  title.tau = NULL,
  true.tau = NULL,
  title.beta = NULL,
  tau.x.axis.size = 1.1,
  tau.y.axis.size = 1.1,
  tau.title.size = 1.2,
  tau.panel.title.size = 1.4,
  tau.legend.size = 1,
  beta.x.axis.size = 1.1,
  beta.y.axis.size = 1.1,
  beta.title.size = 1.2,
  beta.panel.title.size = 1.4,
  beta.legend.size = 1,
  tau.xlab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>an output of the function <code>hdpGLM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a string vector with the name of the context-level covariate(s) whose linear effect will be displayed. If <code>NULL</code>, the linear effect tau of all context-level covariates are displayed. Note: the context-level covariate must have been included in the estimation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.taus</code></td>
<td>
<p>integer with the number of columns of the grid containing the posterior distribution of tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.betas</code></td>
<td>
<p>integer with the number of columns of the posterior expectation of betas as function of context-level features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.w</code></td>
<td>
<p>integer with the number of columns to use to display the different context-level covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow.w</code></td>
<td>
<p>integer with the number of rows to use to display the different context-level covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.line</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plot will display a regression line representing the regression of the posterior expectation of the linear coefficients betas on the context-level covariates. Default <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.pexp.beta</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plots will display a line with the predicted posterior expectation of betas obtained using the posterior expectation of taus, the linear coefficients of the expectation of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.tau</code></td>
<td>
<p>string, the title for the posterior distribution of the context effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.tau</code></td>
<td>
<p>a <code>data.frame</code> with four columns. The first must be named <code>w</code> and it indicates the index of each context-level covariate, starting with 0 for the intercept term. The second column named <code>beta</code> must contain the indexes of the betas of individual-level covariates, starting with 0 for the intercept term. The third column named <code>Parameter</code> must be named <code>tau&lt;w&gt;&lt;beta&gt;</code>, where <code>w</code> and <code>beta</code> must be the actual values displayed in the columns <code>w</code> and <code>beta</code>. Finally, it must have a column named <code>True</code> with the true value of the parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.beta</code></td>
<td>
<p>string, the title for the posterior expectation of beta as function of context-level covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.x.axis.size</code></td>
<td>
<p>numeric, relative size of the x-axis of the plot with tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.y.axis.size</code></td>
<td>
<p>numeric, relative size of the y-axis of the plot with tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.title.size</code></td>
<td>
<p>numeric, relative size of the title of the plot with tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.panel.title.size</code></td>
<td>
<p>numeric, relative size of the title of the panels of the plot with tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.legend.size</code></td>
<td>
<p>numeric, relative size of the legend of the plot with tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.x.axis.size</code></td>
<td>
<p>numeric, relative size of the x-axis of the plot with beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.y.axis.size</code></td>
<td>
<p>numeric, relative size of the y-axis of the plot with beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.title.size</code></td>
<td>
<p>numeric, relative size of the title of the plot with beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.panel.title.size</code></td>
<td>
<p>numeric, relative size of the title of the panels of the plot with beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.legend.size</code></td>
<td>
<p>numeric, relative size of the legend of the plot with beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.xlab</code></td>
<td>
<p>string, the label of the x-axis for the plot with tau</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
library(magrittr)
# Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data.context1 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   w = 20
                                   ) 
data.context2 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:2, n, replace=TRUE),
                                   y  =I(z==1) * (1 + 3*x1 - 2*x2 + rnorm(n)) +
                                       I(z==2) * (1 - 2*x1 +   x2 + rnorm(n)),
                                   w = 10
                                   ) 
data = data.context1 %&gt;%
    dplyr::bind_rows(data.context2)

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2, y ~ w, data=data, mcmc=mcmc, n.display=1)

plot_hdpglm(samples)
plot_hdpglm(samples, ncol.taus=2, ncol.betas=2, X='x1')
plot_hdpglm(samples, ncol.taus=2, ncol.betas=2, X='x1', ncol.w=2, nrow.w=1,
            pred.pexp.beta=TRUE,smooth.line=TRUE )


</code></pre>


</div>