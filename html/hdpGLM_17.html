<div class="container">

<table style="width: 100%;"><tr>
<td>plot_pexp_beta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot beta posterior expectation</h2>

<h3>Description</h3>

<p>This function plots the posterior expectation of beta, the linear effect of the individual level covariates, as function of the context-level covariates
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_pexp_beta(
  samples,
  X = NULL,
  W = NULL,
  pred.pexp.beta = FALSE,
  ncol.beta = NULL,
  ylab = NULL,
  nrow.w = NULL,
  ncol.w = NULL,
  smooth.line = FALSE,
  title = NULL,
  legend.position = "top",
  col.pred.line = "red",
  x.axis.size = 1.1,
  y.axis.size = 1.1,
  title.size = 12,
  panel.title.size = 1.4,
  legend.size = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>an output of the function <code>hdpGLM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a string vector with the name of the first-level covariates whose associated tau should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a string vector with the name of the context-level covariate(s) whose linear effect will be displayed. If <code>NULL</code>, the linear effect tau of all context-level covariates are displayed. Note: the context-level covariate must have been included in the estimation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.pexp.beta</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plots will display a line with the predicted posterior expectation of betas obtained using the posterior expectation of taus, the linear coefficients of the expectation of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.beta</code></td>
<td>
<p>integer with number of columns of the grid used for each group of context-level covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>string, the label of the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow.w</code></td>
<td>
<p>integer with the number of rows of the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.w</code></td>
<td>
<p>integer with the number of columns of the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.line</code></td>
<td>
<p>boolean, if <code>TRUE</code> the plot will display a regression line representing the regression of the posterior expectation of the linear coefficients betas on the context-level covariates. Default <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>string, title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>one of four options: "bottom" (default), "top", "left", or "right". It indicates the position of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pred.line</code></td>
<td>
<p>string with color of fitted line. Only works if <code>pred.pexp.beta=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.axis.size</code></td>
<td>
<p>numeric, the relative size of the label in the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.size</code></td>
<td>
<p>numeric, absolute size of the title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.title.size</code></td>
<td>
<p>numeric, the relative size of the titles in the panel of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.size</code></td>
<td>
<p>numeric, the relative size of the legend</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
library(magrittr)
set.seed(66)

# Note: this example is just for illustration. MCMC iterations are very reduced
set.seed(10)
n = 20
data.context1 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:3, n, replace=TRUE),
                                   y  =I(z==1) * (3 + 4*x1 - x2 + rnorm(n)) +
                                       I(z==2) * (3 + 2*x1 + x2 + rnorm(n)) +
                                       I(z==3) * (3 - 4*x1 - x2 + rnorm(n)) ,
                                   w = 20
                                   ) 
data.context2 = tibble::tibble(x1 = rnorm(n, -3),
                                   x2 = rnorm(n,  3),
                                   z  = sample(1:2, n, replace=TRUE),
                                   y  =I(z==1) * (1 + 3*x1 - 2*x2 + rnorm(n)) +
                                       I(z==2) * (1 - 2*x1 +   x2 + rnorm(n)),
                                   w = 10
                                   ) 
data = data.context1 %&gt;%
    dplyr::bind_rows(data.context2)

## estimation
mcmc    = list(burn.in=1, n.iter=50)
samples = hdpGLM(y ~ x1 + x2, y ~ w, data=data, mcmc=mcmc, n.display=1)

plot_pexp_beta(samples)
plot_pexp_beta(samples, X='x1', ncol.w=2, nrow.w=1)
plot_pexp_beta(samples, X='x1', ncol.beta=2)
plot_pexp_beta(samples, pred.pexp.beta=TRUE, W="w", X=c("x1", "x2"))
plot_pexp_beta(samples, W='w', smooth.line=TRUE, pred.pexp.beta=TRUE, ncol.beta=2)

</code></pre>


</div>