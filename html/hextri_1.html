<div class="container">

<table style="width: 100%;"><tr>
<td>hexclass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hexagonal binning with classes
</h2>

<h3>Description</h3>

<p>Displays a hexagonally-binned scatterplot with coloured subtriangles to
indicate number of observations in each class. With a single class, gives a base-graphics version of the ordinary hexbin plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hextri(x,...)
## Default S3 method:
hextri(x, y, class, colours, nbins = 10, border =
TRUE, diffuse=FALSE, style=c("alpha","size"), weights=NULL,
sorted=!diffuse,minfrac=0, ...)
## S3 method for class 'formula'
hextri(x, data=parent.frame(), class,colours,nbins=10,
border=TRUE, diffuse=FALSE, style=c("alpha","size"),weights=NULL, sorted=!diffuse,
 xlab=NULL, ylab=NULL,minfrac=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Coordinates of points, or for the formula method, a model formula
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>coordinates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The <code>class</code> and <code>weights</code> arguments are looked up
here, in addition to the formula itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>

<p>Factor giving class membership for points
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colours</code></td>
<td>

<p>Vector of colors (number, name, or hashtag format) giving the colours for each class
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>

<p>Number of bins in the x-axis direction
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>

<p>Include a narrow transparent border around each triangle and hexagon
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffuse</code></td>
<td>

<p>Pass on rounding error to nearest not-yet-drawn hexes so that rare classes get represented
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>Represent data by hexagon size or by alpha-blending</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If not <code>NULL</code>, sampling weights or frequency
weights. The hexbin plot will be based on the sum of weights in the
hex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>
<p>Should the triangles be sorted into a consistent order
within each hex? More attractive but can cause 3-d artifacts and may
be less accurate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>Specify to override the formula-based defaults</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minfrac</code></td>
<td>
<p>Cells with radius smaller than this fraction of a whole
cell will be drawn as points. Most useful with <code>style="size"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to the <code>plot</code> call that sets up the plot region</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses the Sainte-Lague method to apportion counts to triangles, ensuring the counts
round to exactly six triangles per hexagon.
</p>
<p>The binning/aspect ratio are adjusted to give regular hexagons on the figure region set by <code>plot(x,y)</code>. If you reshape the window you will need to redraw the plot. 
</p>


<h3>Value</h3>

<p>A list with components <code>x</code>, <code>y</code>, and <code>col</code> suitable as input to <code>polygon()</code>
</p>


<h3>Author(s)</h3>

<p>Thomas Lumley
</p>


<h3>See Also</h3>

<p><code>sainte_lague</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">xx&lt;-rnorm(1000)
yy&lt;-rnorm(1000)
cc&lt;-cut(xx*yy,c(-Inf,-.4,0,.4,Inf))

plot(xx,yy,col=(1:4)[cc])
hextri(xx,yy,cc,1:4,nbins=20,border=TRUE,style="size")

##formula method
data(NHANES, package="hexbin")
hextri(Weight~Age, class=Smoke, col=c("red","orange","green","grey40"),
   data=NHANES, style="size",nbins=20, main="Smoking")
legend("topright",fill=c("red","orange","green","grey40"),
   legend=c("Current","Past","Never","unknown"),bty="n")

## minimum sizes

data(NHANES, package="hexbin")
hextri(Weight~Age, class=Smoke, col=c("red","orange","green","grey40"),
   data=NHANES, style="size",nbins=20, main="Smoking",minfrac=.2)
legend("topright",fill=c("red","orange","green","grey40"),
   legend=c("Current","Past","Never","unknown"),bty="n")


## using the return value of hextri
rval&lt;-hextri(xx,yy,cc,1:4,nbins=20,border=TRUE,style="alpha")
plot(y~x,data=rval,type="n")
with(rval, polygon(x,y,col=col,border=NA))

## diffusion
xx&lt;-runif(10000)
yy&lt;-runif(10000)
cc&lt;-rep(1:3,c(4750,4750,500))
hextri(xx,yy,cc,2:4,border=TRUE,diffuse=FALSE,style="size")
hextri(xx,yy,cc,2:4,border=TRUE,diffuse=TRUE,sorted=TRUE, style="size")

hextri(xx,yy,cc,2:4,border=TRUE,diffuse=TRUE,style="size",weights=cc)

</code></pre>


</div>