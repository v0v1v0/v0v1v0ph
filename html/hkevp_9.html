<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc.fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Point estimates of HKEVP fit</h2>

<h3>Description</h3>

<p>Application of a function to the main Markov chains resulting from the procedure <code>hkevp.fit</code>. May be used to obtain point estimates of the posterior distribution (e.g., the mean or the median). See details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc.fun(fit, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A named list.
Output from the <code>hkevp.fit</code> procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>The function applied to the Markov chains in <code>fit</code>. The median by default. The output from FUN must be a single value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments of the function to be applied on the Markov chains (e.g. <code>na.rm = FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A function is applied to the main Markov chains resulting from the MCMC procedures <code>hkevp.fit</code> or <code>latent.fit</code>. These chains correspond to the three GEV parameters, the dependence parameter <code class="reqn">\alpha</code> and the bandwidth <code class="reqn">\tau</code>.
</p>
<p>The value returned by <code>FUN</code> must be a single value.
</p>


<h3>Value</h3>

<p>If fitted model is the HKEVP, a named list with three elements:
</p>

<ul>
<li> <p><code>GEV</code>: A numerical matrix. Result of the function <code>FUN</code> for each GEV parameter (columns) and each site position (rows).
</p>
</li>
<li> <p><code>alpha</code>: A numerical value. Result of the function <code>FUN</code> on the Markov chain associated to the dependence parameter <code class="reqn">\alpha</code>.
</p>
</li>
<li> <p><code>tau</code>: A numerical value. Result of the function <code>FUN</code> on the Markov chain associated to the bandwidth parameter <code class="reqn">\tau</code>.
</p>
</li>
</ul>
<p>If fitted model is the latent variable model, the functions returns the <code>GEV</code> matrix only.
</p>


<h3>Author(s)</h3>

<p>Quentin Sebille
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulation of HKEVP:

sites &lt;- as.matrix(expand.grid(1:3,1:3))
knots &lt;- sites
loc &lt;- sites[,1]*10
scale &lt;- 3
shape &lt;- .2
alpha &lt;- .4
tau &lt;- 1
ysim &lt;- hkevp.rand(10, sites, knots, loc, scale, shape, alpha, tau)

# HKEVP fit:
fit &lt;- hkevp.fit(ysim, sites, niter = 1000)

# Posterior median and standard deviation:
# mcmc.fun(fit, median)
# mcmc.fun(fit, sd)



</code></pre>


</div>