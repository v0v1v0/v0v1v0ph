<div class="container">

<table style="width: 100%;"><tr>
<td>mh.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitter function for Metropolis-Hastings (MH)</h2>

<h3>Description</h3>

<p>This is the basic computing function for MH and should not be called directly except by experienced users.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mh.fit(
  N,
  theta.init,
  qPROP,
  qFUN,
  logPOSTERIOR,
  nu = 0.001,
  varnames = NULL,
  param = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of MCMC samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.init</code></td>
<td>
<p>Vector of initial values for the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qPROP</code></td>
<td>
<p>Function to generate proposal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qFUN</code></td>
<td>
<p>Probability for proposal function.  First argument is where to evaluate, and second argument is the conditional parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logPOSTERIOR</code></td>
<td>
<p>Function to calculate and return the log posterior given a vector of values of <code>theta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Single value or vector parameter passed to <code>qPROP</code> or <code>qFUN</code> for the proposal density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>Optional vector of theta parameter names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>List of additional parameters for <code>logPOSTERIOR</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for <code>logPOSTERIOR</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List for <code>mh</code>
</p>


<h3>Elements in <code>mh</code> list</h3>


<dl>
<dt><code>N</code></dt>
<dd>
<p>Number of MCMC samples
</p>
</dd>
<dt><code>theta</code></dt>
<dd>
<p>Nested list of length <code>N</code> of the sampled values of <code>theta</code> for each chain
</p>
</dd>
<dt><code>thetaCombined</code></dt>
<dd>
<p>List of dataframes containing sampled values, one for each chain
</p>
</dd>
<dt><code>r</code></dt>
<dd>
<p>NULL for Metropolis-Hastings
</p>
</dd>
<dt><code>theta.all</code></dt>
<dd>
<p>Nested list of all parameter values of <code>theta</code> sampled prior to accept/reject step for each
</p>
</dd>
<dt><code>r.all</code></dt>
<dd>
<p>NULL for Metropolis-Hastings
</p>
</dd>
<dt><code>accept</code></dt>
<dd>
<p>Number of accepted proposals.  The ratio <code>accept</code> / <code>N</code> is the acceptance rate
</p>
</dd>
<dt><code>accept_v</code></dt>
<dd>
<p>Vector of length <code>N</code> indicating which samples were accepted
</p>
</dd>
<dt><code>M</code></dt>
<dd>
<p>NULL for Metropolis-Hastings
</p>
</dd>
<dt><code>algorithm</code></dt>
<dd>
<p><code>MH</code> for Metropolis-Hastings
</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R"># Logistic regression example
X &lt;- cbind(1, seq(-100, 100, by=0.25))
betavals &lt;- c(-0.9, 0.2)
lodds &lt;- X %*% betavals
prob1 &lt;- as.numeric(1 / (1 + exp(-lodds)))

set.seed(9874)
y &lt;- sapply(prob1, function(xx) {
  sample(c(0, 1), 1, prob=c(1-xx, xx))
})

f1 &lt;- mh.fit(N = 2000,
         theta.init = rep(0, 2),
         nu = c(0.03, 0.001),
         qPROP = qprop,
         qFUN = qfun,
         logPOSTERIOR = logistic_posterior,
         varnames = paste0("beta", 0:1),
         y=y, X=X)

f1$accept / f1$N
</code></pre>


</div>