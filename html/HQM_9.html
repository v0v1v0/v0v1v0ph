<div class="container">

<table style="width: 100%;"><tr>
<td>get_h_xll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local linear future conditional hazard rate estimator</h2>

<h3>Description</h3>

<p>Calculates the local linear future hazard rate function, conditional on a marker value <code>x</code>, across a set of time values <code>t</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> get_h_xll(data, marker_name, event_time_name, time_name, event_name, x, b)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame of time dependent data points.  Missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_name</code></td>
<td>
<p>The column name of the marker values in the data frame <code>data</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_time_name</code></td>
<td>
<p>The column name of the event times in the data frame <code>data</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_name</code></td>
<td>
<p>The column name of the times the marker values were observed in the data frame <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_name</code></td>
<td>
<p>The column name of the events in the data frame <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric value of the last observed marker value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Bandwidth parameter.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>get_h_xll</code> implements the local linear future conditional hazard estimator
</p>
<p style="text-align: center;"><code class="reqn">\hat{h}_x(t) = \frac{\sum_{i=1}^n \int_0^T\hat{\alpha}_i(X_i(t+s))Z_i(t+s)Z_i(s)K_{b}(x-X_i(s))\mathrm {d}s}{\sum_{i=1}^n\int_0^TZ_i(t+s)Z_i(s)K_{b}(x-X_i(s))\mathrm {d}s},</code>
</p>

<p>across a grid of possible time values <code class="reqn">t</code>, where <code class="reqn">X</code> is the marker, <code class="reqn">Z</code> is the exposure and <code class="reqn">\alpha(z)</code> is the marker-only hazard, see <code>get_alpha</code> for more details.
</p>


<h3>Value</h3>

<p>A vector of <code class="reqn">\hat h_x(t)</code> for a grid of possible time values <code class="reqn">t</code>.
</p>


<h3>See Also</h3>

 <p><code>get_alpha, h_xt </code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
b = 10
x = 3
Landmark &lt;- 2
pbcT1 &lt;- pbc2[which(pbc2$year&lt; Landmark  &amp; pbc2$years&gt; Landmark),]
b=0.9

arg1ll&lt;-get_h_xll(pbcT1, 'albumin', event_time_name = 'years', time_name = 'year',
                  event_name = 'status2', 2, 0.9) 
arg1lc&lt;-get_h_x(pbcT1, 'albumin', event_time_name = 'years', time_name = 'year',
                event_name = 'status2', 2, 0.9) 

#Caclulate the local contant and local linear survival functions
br_s  = seq(Landmark, 14,  length=99)
sfalb2ll&lt;- make_sf(    (br_s[2]-br_s[1])/4 , arg1ll)
sfalb2lc&lt;- make_sf(    (br_s[2]-br_s[1])/4 , arg1lc)

#For comparison, also calculate the Kaplan-Meier
kma2&lt;- survfit(Surv(years , status2) ~ 1, data = pbcT1)

#Plot the survival functions:
plot(br_s, sfalb2ll,  type="l", col=1, lwd=2, ylab="Survival probability", xlab="Marker level")
lines(br_s, sfalb2lc,  lty=2, lwd=2, col=2)
lines(kma2$time, kma2$surv, type="s",  lty=2, lwd=2, col=3)

legend("topright", c(  "Local linear HQM", "Local constant HQM", "Kaplan-Meier"), 
        lty=c(1, 2, 2), col=1:3, lwd=2, cex=1.7)
</code></pre>


</div>