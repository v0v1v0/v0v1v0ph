<div class="container">

<table style="width: 100%;"><tr>
<td>speed_boot_LR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
speed boot LR
</h2>

<h3>Description</h3>

<p>Example of a parametric bootstrap for model selection
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("speed_boot_LR")</code></pre>


<h3>Format</h3>

<p>A <code>boot</code> object
</p>


<h3>Details</h3>

<p>The bootstrap sample was generated by the following code:
</p>
<pre>require(depmixS4)
      require(hmmr)
      require(boot)
      
      data(speed1)
      set.seed(5)
      spmix2 &lt;- mix(RT~1, data=speed1, nstates=2)
      fspmix2 &lt;- fit(spmix2,verbose=FALSE)
      
      set.seed(5)
      fspmix3 &lt;- fit(mix(RT~1,data=speed1,nstates=3))
      
      speed.fun.LR &lt;- function(model) {
        ok &lt;- FALSE
        while(!ok) {
          bootdat &lt;- data.frame(RT = simulate(model)@response[[1]][[1]]@y)
          fboot2 &lt;- try({
            mod &lt;- mix(RT~1,data=bootdat,nstates=2)
            mod &lt;- setpars(mod,getpars(fspmix2))
            fit(mod,emcontrol=em.control(random.start=FALSE),verbose=FALSE)
          },TRUE)
          fboot3 &lt;- try({
            mod &lt;- mix(RT~1,data=bootdat,nstates=3)
            mod &lt;- setpars(mod,getpars(fspmix3))
            fit(mod,emcontrol=em.control(random.start=FALSE),verbose=FALSE)
          },TRUE)
          if(!inherits(fboot2,"try-error") &amp; !inherits(fboot3,"try-error")) ok &lt;- TRUE
        }
        if(ok &amp; logLik(fboot3) &lt; logLik(fboot2)) ok &lt;- FALSE
        while(!ok) {
          cat("trying different starting-values")
          fboot3 &lt;- try({
            mod &lt;- mix(RT~1,data=bootdat,nstates=3)
            mod &lt;- setpars(mod,getpars(fspmix3))
            fit(mod,verbose=FALSE)
          },TRUE)
          if(!inherits(fboot3,"try-error") &amp; logLik(fboot3) &gt; logLik(fboot2)) ok &lt;- TRUE
        }
        llratio(fboot3,fboot2)@value
      }
      set.seed(5)
      speed_boot_LR &lt;- boot(fspmix2,speed.fun.LR,R=1000,sim="parametric")
    </pre>


<h3>Examples</h3>

<pre><code class="language-R">  data(speed_boot_LR)
</code></pre>


</div>