<div class="container">

<table style="width: 100%;"><tr>
<td>glm.npp.lognc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the logarithm of the normalizing constant for normalized power prior (NPP) for one data set</h2>

<h3>Description</h3>

<p>Uses Markov chain Monte Carlo (MCMC) and bridge sampling to estimate the logarithm of the normalizing
constant for the NPP for a fixed value of the power prior parameter <code class="reqn">a_0 \in (0, 1)</code> for one data
set. The initial priors are independent normal priors on the regression coefficients and a half-normal
prior on the dispersion parameter (if applicable).
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.npp.lognc(
  formula,
  family,
  histdata,
  a0,
  offset0 = NULL,
  beta.mean = NULL,
  beta.sd = NULL,
  disp.mean = NULL,
  disp.sd = NULL,
  bridge.args = NULL,
  iter_warmup = 1000,
  iter_sampling = 1000,
  chains = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a two-sided formula giving the relationship between the response variable and covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an object of class <code>family</code>. See <code>?stats::family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histdata</code></td>
<td>
<p>a <code>data.frame</code> giving the historical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>the power prior parameter (a scalar between 0 and 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset0</code></td>
<td>
<p>vector whose dimension is equal to the rows of the historical data set giving an offset for the
historical data. Defaults to a vector of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.mean</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of regression coefficients giving
the mean parameters for the normal initial prior on regression coefficients given the dispersion
parameter. If a scalar is provided, beta.mean will be a vector of repeated elements of the given
scalar. Defaults to a vector of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.sd</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of regression coefficients giving
the sd parameters for the initial prior on regression coefficients. The sd used is
<code>sqrt(dispersion) * beta.sd</code>. If a scalar is provided, same as for beta.mean. Defaults to
a vector of 10s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.mean</code></td>
<td>
<p>location parameter for the half-normal prior on dispersion parameter. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.sd</code></td>
<td>
<p>scale parameter for the half-normal prior on dispersion parameter. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bridge.args</code></td>
<td>
<p>a <code>list</code> giving arguments (other than samples, log_posterior, data, lb, ub) to pass
onto <code>bridgesampling::bridge_sampler()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_warmup</code></td>
<td>
<p>number of warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_warmup</code> in
<code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_sampling</code></td>
<td>
<p>number of post-warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_sampling</code>
in <code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>number of Markov chains to run. Defaults to 4. See the argument <code>chains</code> in <code>sample()</code> method in
cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>sample()</code> method in cmdstanr package (e.g. seed, refresh, init).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a vector giving the value of a0, the estimated logarithm of the normalizing constant, the minimum
estimated bulk effective sample size of the MCMC sampling, and the maximum Rhat.
</p>


<h3>References</h3>

<p>Gronau, Q. F., Singmann, H., and Wagenmakers, E.-J. (2020). bridgesampling: An r package for estimating normalizing constants. Journal of Statistical Software, 92(10).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (instantiate::stan_cmdstan_exists()) {
  data(actg036)
  ## take subset for speed purposes
  actg036 = actg036[1:50, ]
  glm.npp.lognc(
    cd4 ~ treatment + age + race,
    family = poisson(), histdata = actg036, a0 = 0.5,
    chains = 1, iter_warmup = 500, iter_sampling = 5000
  )
}
</code></pre>


</div>