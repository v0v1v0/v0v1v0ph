<div class="container">

<table style="width: 100%;"><tr>
<td>spdiffpen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial difference penalty</h2>

<h3>Description</h3>

<p><code>spdiffpen</code> computes the <code>m</code>th order spatial
difference penalty for a set of coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spdiffpen(coords, m = 1, sparse = TRUE, longlat = FALSE, digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A two-dimensional matrix-like object with
non-NULL dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A positive integer indicating order of the difference penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>A logical value indicating if the result
should be a sparse version of the
<code>Matrix-class</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>A logical value indicating whether Great
Circle distances should be used (<code>TRUE</code>) or
Euclidean distances (<code>FALSE</code>).  The default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to use when applying
<code>round</code> to the distances.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>adjacent</code> is used to determine the
first-order neighbors of each point in <code>coords</code>. The
difference penalties are then successively determined
from that.
</p>
<p>If <code>sparse = TRUE</code>, a
<code>sparseMatrix-class</code> Matrix is
returned when the penalty matrix is relatively sparse
(typically, at least half the entries are zero).
Otherwise, something of the more general
<code>Matrix-class</code> is returned.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> or <code>sparseMatrix-class</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">coords = expand.grid(1:4, 1:4)
# first order difference penalty
d1 = spdiffpen(coords, digits = 1)
# second order difference penalty
d2 = spdiffpen(coords, m = 2, digits = 1)
# third order difference penalty
d3 = spdiffpen(coords, m = 3, digits = 1)
</code></pre>


</div>