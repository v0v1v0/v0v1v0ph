<div class="container">

<table style="width: 100%;"><tr>
<td>dccs_boot_LR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
dccs boot LR
</h2>

<h3>Description</h3>

<p>Example of a parametric bootstrap for model selection with the dccs data
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("dccs_boot_LR")</code></pre>


<h3>Format</h3>

<p>A <code>boot</code> object
</p>


<h3>Details</h3>

<p>The bootstrap sample was generated by the following code:
</p>
<pre>require(depmixS4)
      require(hmmr)
      require(boot)
      
      data(dccs)
      m2 &lt;- mix(response=cbind(nCorPost,6-nCorPost)~1,nstates=2,
                data=dccs,family=binomial())
      set.seed(1234)
      fm2 &lt;- fit(m2)
      set.seed(1234)
      fm3 &lt;- fit(mix(response=cbind(nCorPost,6-nCorPost)~1, 
                     nstates=3, data=dccs,family=binomial()))
      
      boot.fun &lt;- function(model) {
        ok &lt;- FALSE
        while(!ok) {
          bootdat &lt;- data.frame(
            simulate(model)@response[[1]][[1]]@y)
          fboot2 &lt;- try({
            mod &lt;- mix(cbind(X1,X2)~1, nstates=2, 
                       family=binomial(), data=bootdat)
            mod &lt;- setpars(mod,getpars(fm2))
            fit(mod,emcontrol=em.control(random.start=FALSE),
                verbose=FALSE)
          })
          fboot3 &lt;- try({
            mod &lt;- mix(cbind(X1,X2)~1, nstates=3, 
                       family=binomial(), data=bootdat)
            mod &lt;- setpars(mod,getpars(fm3))
            fit(mod,emcontrol=em.control(random.start=FALSE),
                verbose=FALSE)
          })
          if(!inherits(fboot2,"try-error") &amp;&amp; 
             !inherits(fboot3,"try-error") &amp;&amp;
             logLik(fboot3) &gt;= logLik(fboot2)) ok &lt;- TRUE
          # if(ok) if(logLik(fboot3) &lt; logLik(fboot2)) ok &lt;- FALSE
        }  
        llratio(fboot3,fboot2)@value
      }
      set.seed(1234)
      dccs_boot_LR &lt;- boot(fm2, boot.fun, R=10000, sim="parametric")
    </pre>


<h3>Examples</h3>

<pre><code class="language-R">  data(dccs_boot_LR)
</code></pre>


</div>