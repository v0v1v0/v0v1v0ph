<div class="container">

<table style="width: 100%;"><tr>
<td>MTRItest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
k-Sample MTRI Test of Equal Distributions
</h2>

<h3>Description</h3>

<p>Performs the distribution free exact k-sample test for equality of multivariate distributions in the HDLSS regime. This test is a multiscale approach based on RI test, where the results for different number of partitions are aggregated judiciously.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MTRItest(M, labels, sizes, k_max, multTest = "Holm", s_psi = 1, s_h = 1, 
lb = 1, n_sts = 1000, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p><code class="reqn">n\times d</code> observations matrix of pooled sample, the observations should be grouped by their respective classes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>length <code class="reqn">n</code> vector of membership index of observations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes</code></td>
<td>

<p>vector of sample sizes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_max</code></td>
<td>

<p>maximum value of total number of clusters which is required for the test
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multTest</code></td>
<td>

<p><code>"HOlm"</code>(default) or <code>"BenHoch"</code>; different multiple tests
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_psi</code></td>
<td>

<p>function required for clustering, 1 for <code class="reqn">t^2</code>, 2 for <code class="reqn">1-\exp(-t)</code>, 3 for <code class="reqn">1-\exp(-t^2)</code>, 4 for <code class="reqn">\log(1+t)</code>, 5 for <code class="reqn">t</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_h</code></td>
<td>

<p>function required for clustering, 1 for <code class="reqn">\sqrt t</code>, 2 for <code class="reqn">t</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>each observation is partitioned into some numbers of smaller vectors of same length <code class="reqn">lb</code>, default: <code class="reqn">1</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sts</code></td>
<td>

<p>number of simulation of the test statistic, default: <code class="reqn">1000</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric, confidence level <code class="reqn">\alpha</code>, default: <code class="reqn">0.05</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>


<p>MTRItest returns a list containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>RIvec</code></td>
<td>
<p>a vector of the Rand indices based on different number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalues</code></td>
<td>
<p>a vector of RI test p-values based on different number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decisionMTRI </code></td>
<td>
<p>if returns <code class="reqn">1</code>, reject the null hypothesis and if returns <code class="reqn">0</code>, fails to reject the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contTabs</code></td>
<td>
<p>a list of the observed contingency table based on different number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mulTestdec</code></td>
<td>
<p>a vector of <code class="reqn">0</code>s and <code class="reqn">1</code>s. <code class="reqn">0</code>: fails to reject the corresponding hypothesis and <code class="reqn">1</code>: reject the corresponding hypothesis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Biplab Paul, Shyamal K. De and Anil K. Ghosh
</p>
<p>Maintainer: Biplab Paul&lt;paul.biplab497@gmail.com&gt;
</p>


<h3>References</h3>


<p>Biplab Paul, Shyamal K De and Anil K Ghosh (2021).  Some clustering based exact distribution-free k-sample tests
applicable to high dimension, low sample size data, <em>Journal of Multivariate Analysis</em>, doi:10.1016/j.jmva.2021.104897.
</p>
<p>Sture Holm (1979). A simple sequentially rejective multiple test procedure, <em>Scandinavian journal of statistics</em>, 65-70, doi:10.2307/4615733.
</p>
<p>Yoav Benjamini and Yosef Hochberg (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing, <em>Journal of the Royal statistical society: series B (Methodological)</em> 57.1: 289-300, doi: 10.2307/2346101.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # muiltivariate normal distribution:
  # generate data with dimension d = 500
  set.seed(151)
  n1=n2=n3=n4=10
  d = 500
  I1 &lt;- matrix(rnorm(n1*d,mean=0,sd=1),n1,d)
  I2 &lt;- matrix(rnorm(n2*d,mean=0.5,sd=1),n2,d) 
  I3 &lt;- matrix(rnorm(n3*d,mean=1,sd=1),n3,d) 
  I4 &lt;- matrix(rnorm(n4*d,mean=1.5,sd=1),n4,d)
  levels &lt;- c(rep(0,n1), rep(1,n2), rep(2,n3), rep(3,n4)) 
  X &lt;- as.matrix(rbind(I1,I2,I3,I4)) 
  #MTRI test:
  results &lt;- MTRItest(X, levels, c(n1,n2,n3,n4), 8)
  
  ## outputs:
  results$RIvec
  #[1] 0.25641026 0.14871795 0.00000000 0.03076923 0.05128205 0.08333333 0.10384615

  results$Pvalues
  #[1] 0 0 0 0 0 0 0

  results$decisionMTRI
  #[1] 1

  results$contTabs
  #$contTabs[[1]]
  #     [,1] [,2]
  #[1,]   10    0
  #[2,]   10    0
  #[3,]    0   10
  #[4,]    0   10

  #$contTabs[[2]]
  #     [,1] [,2] [,3]
  #[1,]   10    0    0
  #[2,]    0   10    0
  #[3,]    0   10    0
  #[4,]    0    0   10

  #$contTabs[[3]]
  #     [,1] [,2] [,3] [,4]
  #[1,]   10    0    0    0
  #[2,]    0   10    0    0
  #[3,]    0    0   10    0
  #[4,]    0    0    0   10

  #$contTabs[[4]]
  #     [,1] [,2] [,3] [,4] [,5]
  #[1,]   10    0    0    0    0
  #[2,]    0   10    0    0    0
  #[3,]    0    0    4    6    0
  #[4,]    0    0    0    0   10

  #$contTabs[[5]]
  #     [,1] [,2] [,3] [,4] [,5] [,6]
  #[1,]   10    0    0    0    0    0
  #[2,]    0   10    0    0    0    0
  #[3,]    0    0    4    6    0    0
  #[4,]    0    0    0    0    8    2

  #$contTabs[[6]]
  #     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
  #[1,]   10    0    0    0    0    0    0
  #[2,]    0    5    5    0    0    0    0
  #[3,]    0    0    0    4    6    0    0
  #[4,]    0    0    0    0    0    8    2

  #$contTabs[[7]]
  #     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
  #[1,]    8    2    0    0    0    0    0    0
  #[2,]    0    0    5    5    0    0    0    0
  #[3,]    0    0    0    0    4    6    0    0
  #[4,]    0    0    0    0    0    0    8    2


  results$mulTestdec
  #[1] 1 1 1 1 1 1 1
</code></pre>


</div>