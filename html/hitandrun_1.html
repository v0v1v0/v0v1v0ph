<div class="container">

<table style="width: 100%;"><tr>
<td>hitandrun-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
"Hit and Run" sampling
</h2>

<h3>Description</h3>

<p>This package provides a "Hit and Run" sampler that generates a Markov chain whose stable state converges on the uniform distribution over a convex polytope.
The polytope is given by a set of inequality constraints in standard linear programming form (<code class="reqn">Ax \leq b</code>) and optionally a set of equality constraints.
In addition, there is a "Shake and Bake" sampler to generate points from the boundary of such a shape.
</p>
<p>Utilities are provided for sampling from subsets of the unit simplex (i.e. random variates that can be interpreted as weights satisfying certain constraints) and for specifying common constraints.
</p>


<h3>Details</h3>

<p><code>hitandrun</code> and <code>shakeandbake</code> now provide the most general interface for sampling from spaces defined by arbitrary linear equality and inequality constraints. The functions described in the following provide lower level functionality on which it is built.
</p>
<p><code>har</code> is the core "Hit and Run" sampler, <code>sab</code> is the core "Shake and Bake" sampler, <code>bbReject</code> is the bounding box rejection sampler, and <code>simplex.sample</code> samples uniformly from the unit simplex.
</p>
<p>See <code>simplex.createTransform</code> and <code>simplex.createConstraints</code> for sampling from subsets of the unit simplex.
Utilities to specify common constraints are described in <code>harConstraints</code>.
</p>
<p>When the sampling space is restricted by different linear equality constraints, use <code>solution.basis</code>, <code>createTransform</code>, and <code>transformConstraints</code>.
This is a generalization of the methods for sampling from the simplex.
</p>


<h3>Note</h3>

<p>"Hit and Run" is a Markov Chain Monte Carlo (MCMC) method, so generated samples form a correlated time series. To get a uniform sample, you need <code class="reqn">O^*(n^3)</code> samples, where n is the dimension of the sampling space.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Gert van Valkenhoef &lt;gert@gertvv.nl&gt;
</p>


<h3>References</h3>

<p>Tervonen, T., van Valkenhoef, G., Basturk, N., and Postmus, D. (2012) "Hit-And-Run enables efficient weight generation for simulation-based multiple criteria decision analysis". <em>European Journal of Operational Research</em> 224(3) 552-559. doi: <a href="https://doi.org/10.1016/j.ejor.2012.08.026">10.1016/j.ejor.2012.08.026</a>
van Valkenhoef, G., Tervonen, T., and Postmus, D. (2014) "Notes on 'Hit-And-Run enables efficient weight generation for simulation-based multiple criteria decision analysis'". <em>European Journal of Operational Research</em> (in press). doi: <a href="https://doi.org/10.1016/j.ejor.2014.06.036">10.1016/j.ejor.2014.06.036</a>
</p>


<h3>See Also</h3>

<p><code>hitandrun</code>
<code>har</code>
</p>
<p><code>bbReject</code>
<code>simplex.sample</code>
<code>hypersphere.sample</code>
</p>
<p><code>solution.basis</code>
<code>createTransform</code>
<code>transformConstraints</code>
</p>
<p><code>simplex.createTransform</code>
<code>simplex.createConstraints</code>
</p>
<p><code>harConstraints</code>
</p>
<p><code>createSeedPoint</code>
<code>createBoundBox</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example: sample weight vectors where w_1 &gt;= w_2 and w_1 &gt;= w_3
n &lt;- 3 # length of weight vector
constr &lt;- mergeConstraints(
  ordinalConstraint(n, 1, 2),
  ordinalConstraint(n, 1, 3))
transform &lt;- simplex.createTransform(n)
constr &lt;- simplex.createConstraints(transform, constr)
seedPoint &lt;- createSeedPoint(constr, homogeneous=TRUE)
N &lt;- 1000
w &lt;- har(seedPoint, constr, N=N * (n-1)^3, thin=(n-1)^3,
  homogeneous=TRUE, transform=transform)$samples
stopifnot(all(w[,1] &gt;= w[,2]) &amp;&amp; all(w[,1] &gt;= w[,3]))
</code></pre>


</div>