<div class="container">

<table style="width: 100%;"><tr>
<td>orthog.complete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct an orthogonal matrix which is an arbitrary completion
of the column space of the input set of columns.</h2>

<h3>Description</h3>

<p>Construct an orthogonal matrix which is an arbitrary completion
of the column space of the input set of columns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">orthog.complete(x, normalize=TRUE, abs2.rows=1:nrow(x),
                Int=TRUE, drop.Int=Int)

orthog.construct(y, x, x.rows, normalize=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For <code>orthog.complete</code>, an n-row matrix of one or more
columns.<br>
For <code>orthog.construct</code>, a set of contrasts for a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix of coefficients specifying the linear combinations
estimated.  This will usually be the <code>lmat</code> from an S-Plus
<code>"multicomp"</code> object or the <code>linfct</code> component from an
R <code>"glht"</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize, abs2.rows, x.rows</code></td>
<td>
<p>The default normalizes the
sum of squares of the rows
in <code>abs2.rows</code> or <code>x.rows</code> to 1.  The optional value
<code>normalize="abs2"</code> scales the rows
in <code>abs2.rows</code> or <code>x.rows</code> to make the sum of all
positive value equal 1 and the sum of all negative values equal <code class="reqn">-1</code>.
Together, the sum of the absolute values of the specified rows in
each column is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Int</code></td>
<td>
<p>logical.  Default <code>TRUE</code> means make all columns
orthogonal to the constant column (Intercept in regression
terminology).  The alternative is to use only the columns in the
input matrix <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.Int</code></td>
<td>
<p>logical.  The default is to drop the constant column
and to keep all columns when the constant is not automatically generated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is based on <code>qr.Q</code>.  The input matrix <code>x</code> has
<code>n</code> rows and an arbitrary non-zero number of columns.  The result
is an <code>n</code> by <code>n</code> orthogonal matrix.  By default the first
column of the result is constant and is not returned.  The second
column of the result is orthogonal to the first result column.
Together the first two result columns span the space of the constant
column and the first input column.  The third result column is
orthogonal to the first two result columns and the the three result
columns together span the space of the constant column and the first
two inout columns.  Similarly for the remaining result columns.
Result columns beyond the number of input columns are constructed as
an arbitrary orthogonal completion.
</p>
<p>If the input columns are orthogonal to each other and to the constant
column, then the result columns are rescaled versions of the input
columns.
</p>
<p>Optionally (<code>drop.Int=FALSE</code>), the constant column can be returned.
</p>
<p>By default the columns are scaled to have sum of squares equal 1.  If
<code>normalize="abs2"</code>, they are scaled to make the sum of all
positive value equal 1 and the sum of all negative values equal <code class="reqn">-1</code>.
Together, the sum of the absolute values of each column is 2.
</p>
<p>If the input is a set of columns from a contrast matrix for a design
that has multiple terms, the <code>abs2.rows</code> argument is used to
specify which rows are to be included in the normalization.  These
will normally be rows associated with one of the main effects.
</p>


<h3>Value</h3>

<p>Matrix of orthogonal columns.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>References</h3>

<p>Heiberger, Richard M. and Holland, Burt (2015).
<em>Statistical Analysis and Data Display: An Intermediate Course with Examples in R</em>.
Second Edition.
Springer-Verlag, New York.
<a href="https://link.springer.com/book/10.1007/978-1-4939-2122-5">https://link.springer.com/book/10.1007/978-1-4939-2122-5</a>
</p>


<h3>See Also</h3>

<p><code>MMC</code></p>


<h3>Examples</h3>

<pre><code class="language-R">zapsmall(
orthog.complete(cbind("4-12"=c(-1,-1, 0, 2),
                      "1-2" =c( 1,-1, 0, 0)))
)

zapsmall(
orthog.complete(cbind("4-12"=c(-1,-1, 0, 2),
                      "1-2" =c( 1,-1, 0, 0)),
                drop.Int=FALSE)
)

zapsmall(
orthog.complete(cbind("4-12"=c(-1,-1, 0, 2),
                      "1-2" =c( 1,-1, 0, 0)),
                normalize="abs2")
)


## used in MMC plots
tmp &lt;- data.frame(y=rnorm(12),
                  a=factor(c("u","u","u","u",
                             "v","v","v","v",
                             "w","w","w","w")))
tmp.aov &lt;- aov(y ~ a, data=tmp)
lmat &lt;- if.R(
  s=multicomp(tmp.aov, focus="a")$lmat,
  r={lmat.reduced &lt;- t(glht(tmp.aov, linfct=mcp(a="Tukey"))$linfct)
     rbind(lmat.reduced, AU=-apply(lmat.reduced[-1,], 2, sum))
    })
zapsmall(lmat)

lmat.complete &lt;- orthog.complete(lmat, abs2.rows=-1,
                                 normalize="abs2",
                                 drop.Int=FALSE)[,1:3]
zapsmall(lmat.complete)
if.R(r=zapsmall(lmat.complete[-4,]),
     s={})


</code></pre>


</div>