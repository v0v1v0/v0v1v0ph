<div class="container">

<table style="width: 100%;"><tr>
<td>pr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probability of state sequences.
</h2>

<h3>Description</h3>

<p>Calculates the conditional probability of one or more state sequences,
given the corresponding observations sequences (and the model
parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pr(s, y, model=NULL, tpm, Rho, ispd=NULL, warn=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>A sequence of states of the underlying Markov chain, or
a list of such sequences or a list of lists (!!!) of such
sequences.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A data set to which a hidden Markov model might be fitted,
or a collection of such data sets in the form of an object
of class <code>"multipleHmmDataSets"</code> as returned by <code>rhmm()</code>
if the argument <code>nsim</code> is greater than 1.  In this latter
case <code>s</code> must be a list of the same length as <code>y</code>,
and <code>pr()</code> is applied recursively to each pair of entries
of <code>s</code> and <code>y</code>.
</p>
<p>If <code>y</code> consists of a single observation sequence, it is used
with each of the state sequences in <code>s</code> in turn.  Otherwise
the length of the list <code>y</code> must be the same as the length of
the list <code>s</code>. (If not, then an error is given).  If <code>y</code>
is missing, it is extracted from <code>model</code> (whence it will
<em>not</em> be of class <code>"multipleHmmDataSets"</code>!) provided
that <code>model</code> and its <code>y</code> component are not <code>NULL</code>.
Otherwise an error is given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>An object of class <code>hmm.discnp</code> as returned by
<code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpm</code></td>
<td>

<p>The transition probability matrix of the chain.  Ignored (and
extracted from <code>model</code> instead) if <code>model</code> is not
<code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho</code></td>
<td>

<p>An object specifying the “emission” probabilities of
observations, given the underlying state.  See <code>hmm()</code>.
Ignored (and extracted from <code>model</code> instead) if <code>model</code>
is not <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ispd</code></td>
<td>

<p>The vector specifying the initial state probability distribution
of the Markov chain.  Ignored (and extracted from <code>model</code>
instead) if <code>model</code> is not <code>NULL</code>.  If both <code>ispd</code>
and <code>model</code> are NULL then <code>ispd</code> is taken to be the
stationary distribution of the chain, calculated from <code>tpm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>Logical scalar; should a warning be issued if <code>Rho</code>
hasn't got relevant dimension names?  (Note that if this is so,
then the corresponding dimension names are formed from the sorted
unique values of <code>y</code> or of the appropriate column(s) of <code>y</code>.
And if <em>this</em> is so, then the user should be sure that the
ordering of the entries of <code>Rho</code> corresponds properly to the
the sorted unique values of <code>y</code>.)  This argument is passed
to the utility function <code>check.yval()</code> which actually issues
the warning if <code>warn=TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The probability of <code>s</code> given <code>y</code>, or a vector of such
probabilities if <code>s</code> and <code>y</code> are lists, or a list of
such vectors if <code>y</code> is of class <code>"multipleHmmDataSets"</code>.
</p>


<h3>Warning</h3>

<p>The conditional probabilities will be tiny if the sequences
involved are of any substantial length.  Underflow may be a
problem.  The implementation of the calculations is not
sophisticated.
</p>


<h3>Author(s)</h3>

<p>Rolf Turner
<a href="mailto:r.turner@auckland.ac.nz">r.turner@auckland.ac.nz</a><br></p>


<h3>See Also</h3>

<p><code>hmm()</code>, <code>mps()</code>,
<code>viterbi()</code>, <code>sp()</code>,
<code>fitted.hmm.discnp()</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
P &lt;- matrix(c(0.7,0.3,0.1,0.9),2,2,byrow=TRUE)
R &lt;- matrix(c(0.5,0,0.1,0.1,0.3,
              0.1,0.1,0,0.3,0.5),5,2)
set.seed(42)
lll   &lt;- sample(250:350,20,TRUE)
set.seed(909)
y.num &lt;- rhmm(ylengths=lll,nsim=1,tpm=P,Rho=R,drop=TRUE)
fit.num &lt;- hmm(y.num,K=2,keep.y=TRUE,verb=TRUE)
# Using fitted parmeters.
s.vit.1   &lt;- viterbi(y.num,fit.num)
pr.vit.1  &lt;- pr(s.vit.1,model=fit.num)
# Using true parameters from which y.num was generated.
s.vit.2   &lt;- viterbi(y.num,tpm=P,Rho=R)
pr.vit.2  &lt;- pr(s.vit.2,y.num,tpm=P,Rho=R)
set.seed(202)
y.mult &lt;- rhmm(fit.num,nsim=4)
s.vit.3 &lt;- viterbi(y.mult,tpm=fit.num$tpm,Rho=fit.num$Rho)
pr.vit.3  &lt;- pr(s.vit.3,y.mult,tpm=fit.num$tpm,Rho=fit.num$Rho)

## End(Not run)
</code></pre>


</div>