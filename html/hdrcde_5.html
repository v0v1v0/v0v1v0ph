<div class="container">

<table style="width: 100%;"><tr>
<td>hdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Highest Density Regions</h2>

<h3>Description</h3>

<p>Calculates highest density regions in one dimension
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdr(
  x = NULL,
  prob = c(50, 95, 99),
  den = NULL,
  h = hdrbw(BoxCox(x, lambda), mean(prob)),
  lambda = 1,
  nn = 5000,
  all.modes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector containing data. If <code>x</code> is missing then
<code>den</code> must be provided, and the HDR is computed from the given density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Probability coverage required for HDRs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>den</code></td>
<td>
<p>Density of data as list with components <code>x</code> and <code>y</code>.
If omitted, the density is estimated from <code>x</code> using
<code>density</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Optional bandwidth for calculation of density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Box-Cox transformation parameter where <code>0 &lt;= lambda &lt;=
1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>Number of random numbers used in computing f-alpha quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.modes</code></td>
<td>
<p>Return all local modes or just the global mode?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Either <code>x</code> or <code>den</code> must be provided. When <code>x</code> is provided,
the density is estimated using kernel density estimation. A Box-Cox
transformation is used if <code>lambda!=1</code>, as described in Wand, Marron and
Ruppert (1991). This allows the density estimate to be non-zero only on the
positive real line. The default kernel bandwidth <code>h</code> is selected using
the algorithm of Samworth and Wand (2010).
</p>
<p>Hyndman's (1996) density quantile algorithm is used for calculation.
</p>


<h3>Value</h3>

<p>A list of three components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>hdr</code></td>
<td>
<p>The endpoints of each interval
in each HDR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>The estimated mode of the density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>falpha</code></td>
<td>
<p>The value of the density at the boundaries of each HDR.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Hyndman, R.J. (1996) Computing and graphing highest density
regions. <em>American Statistician</em>, <b>50</b>, 120-126.
</p>
<p>Samworth, R.J. and Wand, M.P. (2010). Asymptotics and optimal bandwidth
selection for highest density region estimation.  <em>The Annals of
Statistics</em>, <b>38</b>, 1767-1792.
</p>
<p>Wand, M.P., Marron, J S., Ruppert, D. (1991) Transformations in density
estimation. <em>Journal of the American Statistical Association</em>,
<b>86</b>, 343-353.
</p>


<h3>See Also</h3>

<p><code>hdr.den</code>, <code>hdr.boxplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Old faithful eruption duration times
hdr(faithful$eruptions)
</code></pre>


</div>