<div class="container">

<table style="width: 100%;"><tr>
<td>hkevp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A hierarchical model for spatial extreme values</h2>

<h3>Description</h3>

<p>The HKEVP of <cite>Reich and Shaby (2012)</cite> is a hierarchical model which can be fitted on point-referenced block maxima across a region of space. Its acronym stands for Hierarchical Kernel Extreme Value Model.
</p>
<p>This model fits both marginal GEV parameters and a conditional spatial dependence structure in a Bayesian framework. Estimation of all parameters is performed with a Metropolis-within-Gibbs algorithm that returns samples of posterior distributions, given prior distributions and data. See details.
</p>
<p>Simulation and fitting procedure for this model are provided along with several other tools such as spatial extrapolation and conditional simulation, which is used for instance in <cite>Shaby and Reich (2012)</cite>.
</p>
<p>A particular simpler case of the HKEVP, defined in Davison et al. (2012), is also available. This model, referred as the latent variable model, assumes conditional independence of the block maxima data (i.e. no dependence structure).
</p>
<p>Spatial modelling of extreme values with general max-stable proceses is taken care of in other R libraries such as <code>RandomFields</code> and <code>SpatialExtremes</code>.
</p>


<h3>Details</h3>

<p>The functions included in <code>hkevp</code> package are listed below:
</p>

<ol>
<li> <p><code>hkevp.fit</code> (resp. <code>latent.fit</code>): fits the HKEVP (resp. the latent variable model) to spatial block maxima data.
</p>
</li>
<li> <p><code>hkevp.rand</code>: simulates data from the HKEVP.
</p>
</li>
<li> <p><code>hkevp.expmeasure</code>: computes the exponent measure of the HKEVP. See details below.
</p>
</li>
<li> <p><code>mcmc.fun</code>: applies a function to the main Markov chains obtained by <code>hkevp.fit</code>. Useful to compute the posterior means or quantiles for instance.
</p>
</li>
<li> <p><code>mcmc.plot</code>: plots the resulting Markov chains, in order to visually assess convergence.
</p>
</li>
<li> <p><code>extrapol.gev</code> (resp. <code>extrapol.return.level</code>) : computes the predictive distribution of the GEV parameters (resp. a return level) at ungauged positions.
</p>
</li>
<li> <p><code>hkevp.predict</code>: predictive distribution of the spatial process at ungauged stes with the HKEVP given observations.</p>
</li>
</ol>
<p>The HKEVP of <cite>Reich and Shaby (2012)</cite> is a hierarchical spatial max-stable model for extreme values. Max-stable models arise as the limiting distribution of renormalized maxima of stochastic processes and they generalize the Extreme Value Theory (EVT) to the infinite-dimensional case. For more information about EVT and max-stable processes, see for instance <cite>Beirlant et al. (2004)</cite>, <cite>de Haan and Ferreira (2006)</cite> and <cite>Coles (2001)</cite>. For an emphasis on statistical inference on spatial extremes, see for instance <cite>Cooley et al. (2012)</cite> and <cite>Davison et al. (2012)</cite>.
</p>
<p>Let <code class="reqn">Y(\cdot)</code> be the process of block maxima recorded over a spatial region. Assume this process is max-stable, then all marginal distributions are necessarily GEV, i.e:
</p>
<p style="text-align: center;"><code class="reqn">Y(s) \sim GEV\{\mu(s),\sigma(s),\xi(s)\}</code>
</p>

<p>with location, scale and shape parameters <code class="reqn">\mu(s)</code>, <code class="reqn">\sigma(s)</code> and <code class="reqn">\xi(s)</code> respectively, indexed by position <code class="reqn">s</code> in space. Without loss of generality, one may look at the <em>simple max-stable process</em> <code class="reqn">Z(\cdot)</code> with <code class="reqn">GEV(1,1,1)</code> margins, where spatial dependence is contained unconditionally of the marginals.
</p>
<p>The HKEVP is thus defined by assuming that there exists <code class="reqn">\alpha\in(0,1]</code> and a set of knots <code class="reqn">\{v_1,...,v_L\}</code> with associated kernels <code class="reqn">\{\omega_1(\cdot),...,\omega_L(\cdot)\}</code> such that:
</p>
<p style="text-align: center;"><code class="reqn">Z(s) = U(s)\theta(s)</code>
</p>

<p>where <code class="reqn">U(s)</code> is a spatially-independent process with <code class="reqn">GEV(1,\alpha,\alpha)</code> margins and
</p>
<p style="text-align: center;"><code class="reqn">\theta(s) = \left[ \sum_{\ell=1}^L A_{\ell} \omega_{\ell}(s)^{1/\alpha}\right]^{\alpha}</code>
</p>

<p>is the <em>residual dependence process</em>, defined with a random variable <code class="reqn">A_{\ell} \sim PS(\alpha)</code>, the positive stable distribution with characteristic exponent <code class="reqn">\alpha</code>. Note that the kernels must satisfy the condition <code class="reqn">\sum_{\ell=1}^L \omega_{\ell}(s) = 1</code>, for all <code class="reqn">s</code>.
</p>
<p>Under those assumptions, <cite>Reich and Shaby (2012)</cite> showed that this model lead to an explicit formula for the distribution of a joint vector of maxima, which is not the case for max-stable processes since no general parametric representation exists (cf. <cite>de Haan and Ferreira (2006)</cite>). The joint distribution of the vector <code class="reqn">\{Z(s_1), \ldots, Z(s_n)\}</code> under the HKEVP assumptions can indeed be written:
</p>
<p style="text-align: center;"><code class="reqn">P\{ Z_1(s_1)&lt;z_1, \ldots, Z_n(s_n)&lt;z_n \} = \sum_{\ell=1}^L \left[ \sum_{i=1}^n \left(\frac{\omega_\ell(s_i)}{z_i}\right)^{1/\alpha}\right]^{\alpha} ~.</code>
</p>

<p>The HKEVP can be seen as an approximation of the <cite>Smith (1990)</cite> model, but with an additional dependence parameter <code class="reqn">\alpha</code> which controls the strength of spatial dependence. Low value for <code class="reqn">\alpha</code> leads to a strong dependence structure while <code class="reqn">\alpha=1</code> means independence.
</p>
<p>In the article of <cite>Reich and Shaby (2012)</cite>, the kernels are chosen to be standardized Gaussian kernels, i.e:
</p>
<p style="text-align: center;"><code class="reqn">\omega_\ell(s) = \frac{K(s_\ell|v_\ell,\tau)}{\sum_{j=1}^L K(s_j|v_j,\tau)} ~,</code>
</p>

<p>where <code class="reqn">K(\cdot|v,\tau)</code> is the Gaussian kernel centered at <code class="reqn">v_\ell</code> and <code class="reqn">\tau</code> is a bandwidth parameter.
</p>
<p>Conditionally on the marginal and the dependence parameters, we obtain independent responses which allow the computation of the likelihood. Since the model is structured via multiple layers, Bayesian inference is preferred. Details of the MCMC algorithm can be found in <cite>Reich and Shaby (2012)</cite>.
</p>
<p>Marginal parameters <code class="reqn">\mu(s)</code>, <code class="reqn">\sigma(s)</code> and <code class="reqn">\xi(s)</code> are modelled through latent Gaussian processes.
</p>
<p>A simpler version of the HKEVP, namely the latent variable model of Davison et al. (2012), is also available in this package. This model assumes conditional independence and can therefore be seen as a special case of the HKEVP, with the condition <code class="reqn">\alpha = 1</code>.
</p>


<h3>Note</h3>

<p>I would like to thank Brian Reich and Benjamin Shaby for their help regarding the implementation of the inference procedure of the HKEVP, and Mathieu Ribatet for introducing me to the Bayesian world. I also acknowledge Electricite de France (EDF) for the financial support and the helpful discussions around the HKEVP with Anne Dutfoy, Marie Gallois, Thi Thu Huong Hoang and Sylvie Parey. Finally, I thank my two PhD supervisors Anne-Laure Fougeres and Cecile Mercadier for their reviews of this package.
</p>


<h3>Author(s)</h3>

<p>Quentin Sebille
</p>


<h3>References</h3>

<p>Beirlant, J., Goegebeur, Y., Segers, J. J. J., &amp; Teugels, J. (2004). Statistics of Extremes: Theory and Applications. &lt;DOI:10.1002/0470012382&gt;
</p>
<p>Coles, S. (2001). An Introduction to Statistical Modeling of Extreme Values. Springer Science &amp; Business Media. &lt;10.1007/978-1-4471-3675-0&gt;
</p>
<p>Cooley, D., Cisewski, J., Erhardt, R. J., Jeon, S., Mannshardt, E., Omolo, B. O., &amp; Sun, Y. (2012). A survey of spatial extremes: Measuring spatial dependence and modeling spatial effects. Revstat, 10(1), 135-165.
</p>
<p>Davison, A. C., Padoan, S. A., &amp; Ribatet, M. (2012). Statistical modeling of spatial extremes. Statistical Science, 27(2), 161-186. &lt;DOI:10.1214/11-STS376&gt;
</p>
<p>de Haan, L., &amp; Ferreira, A. (2006). Extreme Value Theory: An Introduction. Springer Science &amp; Business Media. &lt;DOI:10.1007/0-387-34471-3&gt;
</p>
<p>Reich, B. J., &amp; Shaby, B. A. (2012). A hierarchical max-stable spatial model for extreme precipitation. The annals of applied statistics, 6(4), 1430. &lt;DOI:10.1214/12-AOAS591&gt;
</p>
<p>Shaby, B. A., &amp; Reich, B. J. (2012). Bayesian spatial extreme value analysis to assess the changing risk of concurrent high temperatures across large portions of European cropland. Environmetrics, 23(8), 638-648. &lt;DOI:10.1002/env.2178&gt;
</p>
<p>Smith, R. L. (1990). Max-stable processes and spatial extremes. Unpublished manuscript.
</p>


</div>