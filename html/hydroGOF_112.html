<div class="container">

<table style="width: 100%;"><tr>
<td>plot2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting 2 Time Series
</h2>

<h3>Description</h3>

<p>Plotting of 2 time series, in two different vertical windows or overlapped in the same window. <br>
It requires the <span class="pkg">hydroTSM</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot2(x, y, plot.type = "multiple", 
      tick.tstep = "auto", lab.tstep = "auto", lab.fmt=NULL,
      main, xlab = "Time", ylab,
      cal.ini=NA, val.ini=NA, date.fmt="%Y-%m-%d",
      gof.leg = FALSE, gof.digits=2, 
      gofs=c("ME", "MAE", "RMSE", "NRMSE", "PBIAS", "RSR", "rSD", "NSE", "mNSE", 
             "rNSE", "d", "md", "rd", "r", "R2", "bR2", "KGE", "VE"),
      legend, leg.cex = 1,
      col = c("black", "blue"),
      cex = c(0.5, 0.5), cex.axis=1.2, cex.lab=1.2, 
      lwd= c(1,1), lty=c(1,3), pch = c(1, 9), 
      pt.style = "ts", add = FALSE, 
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>time series that will be plotted. class(x) must be ts or zoo. If <code>leg.gof=TRUE</code>, then <code>x</code> is considered as <b>simulated</b> (for some goodness-of-fit functions this is important)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>time series that will be plotted. class(x) must be ts or zoo. If <code>leg.gof=TRUE</code>, then <code>y</code> is considered as <b>observed</b> values (for some goodness-of-fit functions this is important)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>character, indicating if the 2 ts have to be plotted in the same window or in two different vertical ones. Valid values are: <br>
-) <kbd>single</kbd>  : (default) superimposes the 2 ts on a single plot <br>
-) <kbd>multiple</kbd>: plots the 2 series on 2 multiple vertical plots 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick.tstep</code></td>
<td>

<p>character, indicating the time step that have to be used for putting the ticks on the time axis. Valid values are: <kbd>auto</kbd>, <kbd>years</kbd>, <kbd>months</kbd>,<kbd>weeks</kbd>, <kbd>days</kbd>, <kbd>hours</kbd>, <kbd>minutes</kbd>, <kbd>seconds</kbd>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.tstep</code></td>
<td>

<p>character, indicating the time step that have to be used for putting the labels on the time axis. Valid values are: <kbd>auto</kbd>, <kbd>years</kbd>, <kbd>months</kbd>,<kbd>weeks</kbd>, <kbd>days</kbd>, <kbd>hours</kbd>, <kbd>minutes</kbd>, <kbd>seconds</kbd>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.fmt</code></td>
<td>

<p>Character indicating the format to be used for the label of the axis. See <code>lab.fmt</code> in <code>drawTimeAxis</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>an overall title for the plot: see <code>title</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>label for the 'x' axis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>label for the 'y' axis 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cal.ini</code></td>
<td>

<p>OPTIONAL. Character, indicating the date in which the calibration period started. <br>
When <code>cal.ini</code> is provided, all the values in <code>obs</code> and <code>sim</code> with dates previous to <code>cal.ini</code> are SKIPPED from the computation of the goodness-of-fit measures (when <code>gof.leg=TRUE</code>), but their values are still plotted, in order to examine if the warming up period was too short, acceptable or too long for the chosen calibration period.
In addition, a vertical red line in drawn at this date. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val.ini</code></td>
<td>

<p>OPTIONAL. Character with the date in which the validation period started. <br>
ONLY used for drawing a vertical red line at this date. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.fmt</code></td>
<td>

<p>OPTIONAL. Character indicating the format in which the dates entered are stored in <code>cal.ini</code> and <code>val.ini</code>. Default value is <kbd>%Y-%m-%d</kbd>. ONLY required when <code>cal.ini</code> or <code>val.ini</code> is provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.leg</code></td>
<td>

<p>logical, indicating if several numerical goodness-of-fit values have to be computed between <code>sim</code> and <code>obs</code>, and plotted as a legend on the graph. If <code>gof.leg=TRUE</code> (default value), then <code>x</code> is considered as observed and <code>y</code> as simulated values (for some gof functions this is important). This legend is ONLY plotted when <code>plot.type="single"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.digits</code></td>
<td>

<p>OPTIONAL, only used when <code>gof.leg=TRUE</code>. Decimal places used for rounding the goodness-of-fit indexes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gofs</code></td>
<td>

<p>character, with one or more strings indicating the goodness-of-fit measures to be shown in the legend of the plot when  <code>gof.leg=TRUE</code>. <br>
Possible values are in <code>c("ME", "MAE", "MSE", "RMSE", "NRMSE", "PBIAS", "RSR", "rSD", "NSE", "mNSE", "rNSE", "d", "md", "rd", "cp", "r", "R2", "bR2", "KGE", "VE")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>vector of length 2 to appear in the legend.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.cex</code></td>
<td>

<p>numeric, indicating the character expansion factor *relative* to current 'par("cex")'. Used for text, and provides the default for 'pt.cex' and 'title.cex'. Default value = 1 <br>
So far, it controls the expansion factor of the 'GoF' legend and the legend referring to <code>x</code> and <code>y</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>character, with the colors of <code>x</code> and <code>y</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>numeric, with the values controlling the size of text and symbols of <code>x</code> and <code>y</code> with respect to the default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>

<p>numeric, with the magnification of axis annotation relative to 'cex'. See <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>

<p>numeric, with the magnification to be used for x and y labels relative to the current setting of 'cex'. See <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>vector with the line width of <code>x</code> and <code>y</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>vector with the line type of <code>x</code> and <code>y</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>vector with the type of symbol for <code>x</code> and <code>y</code>. (e.g.: 1: white circle; 9: white rhombus with a cross inside)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.style</code></td>
<td>

<p>Character, indicating if the 2 ts have to be plotted as lines or bars. Valid values are: <br>
-) <kbd>ts</kbd> : (default) each ts is plotted as a lines along the <code>x</code> axis <br>
-) <kbd>bar</kbd>: the 2 series are plotted as a barplot. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical indicating if other plots will be added in further calls to this function. <br>
-) <kbd>FALSE</kbd> =&gt; the plot and the legend are plotted on the same graph <br>
-) <kbd>TRUE</kbd>  =&gt; the legend is plotted in a new graph, usually when called from another function (e.g.: <code>ggof</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to <code>plot.zoo</code> function for plotting <code>x</code>, or from other methods
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It requires the package <span class="pkg">hydroTSM</span>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano Bigiarini &lt;mzb.devel@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>ggof</code>, <code>plot_pq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim &lt;- 2:11
obs &lt;- 1:10
## Not run: 
plot2(sim, obs)

## End(Not run)

##################
# Loading daily streamflows of the Ega River (Spain), from 1961 to 1970
data(EgaEnEstellaQts)
obs &lt;- EgaEnEstellaQts

# Generating a simulated daily time series, initially equal to the observed series
sim &lt;- obs 

# Randomly changing the first 2000 elements of 'sim', by using a normal distribution 
# with mean 10 and standard deviation equal to 1 (default of 'rnorm').
sim[1:2000] &lt;- obs[1:2000] + rnorm(2000, mean=10)

# Plotting 'sim' and 'obs' in 2 separate panels
plot2(x=obs, y=sim)

# Plotting 'sim' and 'obs' in the same window
plot2(x=obs, y=sim, plot.type="single")
</code></pre>


</div>