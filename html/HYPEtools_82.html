<div class="container">

<table style="width: 100%;"><tr>
<td>PlotBasinSummary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a summary of model results for a single sub-basin</h2>

<h3>Description</h3>

<p>Plot a standard suite of plots summarizing properties of a sub-basin including upstream area and model performance
for discharge and concentrations of nutrients, sediment, and tracers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotBasinSummary(
  x,
  filename,
  driver = c("default", "pdf", "png", "screen"),
  panels = 1,
  gd = NULL,
  bd = NULL,
  gcl = NULL,
  psd = NULL,
  subid = NULL,
  desc = NULL,
  timestep = attr(x, "timestep"),
  hype.vars = "all",
  from = 1,
  to = nrow(x),
  log = FALSE,
  xscale = "gauss",
  start.mon = 10,
  name = "",
  ylab.t1 = "Conc."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data frame, with column-wise daily time series of HYPE variables. Date-times in
<code>POSIXct</code> format in first column. Typically an imported basin output file from HYPE using <code>ReadBasinOutput</code>.
See details for HYPE output variables required for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>String, file name for plotting to file device, see argument <code>driver</code>. <em>No file extension!</em> Ignored with plotting
to screen device. <em>Device dimensions are currently hard-coded, see Details.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>driver</code></td>
<td>
<p>String, device driver name, one of <code>default</code>, <code>pdf</code>, <code>png</code>, or <code>screen</code>.
Defaults to <code>default</code>, which plots using default plotting device <code>getOption("device")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panels</code></td>
<td>
<p>Integer, either <code>1</code>, <code>2</code>, or <code>3</code>, indicating which panels to plot. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gd</code></td>
<td>
<p>A data frame, containing 'SUBID', 'MAINDOWN', and 'AREA' columns, e.g. an imported 'GeoData.txt' file.
Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bd</code></td>
<td>
<p>A data frame, containing 'BRANCHID' and 'SOURCEID' columns, e.g. an imported 'BranchData.txt' file.
Optional argument. Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcl</code></td>
<td>
<p>Data frame containing columns with SLCs and corresponding land use and soil class IDs, typically a 'GeoClass.txt'
file imported with <code>ReadGeoClass</code>. Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd</code></td>
<td>
<p>A data frame with HYPE point source specifications, typically a 'PointSourceData.txt' file imported with
<code>ReadPointSourceData</code>. Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subid</code></td>
<td>
<p>Integer, SUBID of sub-basin for which results are plotted. If <code>NULL</code> (default), a <code>subid</code> attribute is
required in <code>x</code>. Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>desc</code></td>
<td>
<p>List for use with <code>type</code>. Class description labels imported from a 'description.txt' file, for bar labeling.
See <code>ReadDescription</code> for formatting details. Only needed with bar chart panels, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timestep</code></td>
<td>
<p>Character string, timestep of <code>x</code>, one of <code>"month"</code>, <code>"week"</code>, <code>"day"</code>, or
<code>"nhour"</code> (n = number of hours). If not provided, an attribute <code>timestep</code> is required in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hype.vars</code></td>
<td>
<p>Either a keyword string or a character vector of HYPE output variables. User-specified selection of HYPE variables
to plot. Default (<code>"all"</code>) is to plot all variables which the function knows and which are available in <code>x</code>. See details
for a list of known variables. Other possible keywords are <code>"hydro"</code> and <code>"wq"</code> (water quality), for which a pre-selected range of
(available) result variables is plotted. Alternatively, a character vector holding HYPE output variable IDs to be plotted. Variables unknown
to the function will be ignored with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from, to</code></td>
<td>
<p>Integer or date string of format \
interpreted as row indices of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical, log scaling discharge and concentrations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xscale</code></td>
<td>
<p>Character string, keyword for x-axis scaling. Either <code>"lin"</code> for linear scaling or <code>"gauss"</code> for gaussian scaling.
See description in <code>PlotDurationCurve</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.mon</code></td>
<td>
<p>Integer between 1 and 12, starting month of the hydrological year. For regime plots, see also
<code>AnnualRegime</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Character or expression string. Site name to plot besides bar chart panels. Only relevant with <code>panels</code> <code>1</code> or <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.t1</code></td>
<td>
<p>String or <code>plotmath</code> expression, y axis label for T1 tracer time series panel (tracer concentration units
are not prescribed in HYPE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>PlotBasinSummary</code> plots a multi-panel plot with a number of plots to evaluate model properties and performances for a
chosen sub-basin. Performance plots include discharge, HYPE-modeled nutrient species for nitrogen (total, inorganic, organic)
and phosphorus (total, particulate, soluble), and HYPE modeled suspended and total sediment concentrations.
</p>
<p>Plotted panels show:
</p>

<ul>
<li>
<p><em>Summarized catchment characteristics as bar charts</em>: Upstream-averaged land use, soil, and crop group fractions; modeled nutrient
loads in sub-basin outlet, and summed upstream gross loads from point sources and rural households (if necessary variables available, omitted
otherwise).
</p>
</li>
<li>
<p><em>Goodness-of-fit measures for discharge and concentrations</em>: KGE (Kling-Gupta Efficiency), NSE (Nash-Sutcliffe Efficiency), PBIAS
(Percentage Bias, aka relative error), MAE (Mean Absolute Error), r (Pearson product-moment correlation coefficient), VE (Volumetric Efficiency).
</p>
</li>
<li>
<p><em>Simulation-observation relationships for discharge and concentrations</em>: Simulated and observed concentration-discharge relationships,
relationship between observed and simulated nutrient, sediment, and tracer concentrations.
</p>
</li>
<li>
<p><em>Duration curves for flow and concentrations</em>: Pairwise simulated and observed curves.
</p>
</li>
<li>
<p><em>Annual regimes for flow and concentrations</em>: Pairwise simulated and observed regime plots at monthly aggregation, with
number of observations for concentration regimes.
</p>
</li>
<li>
<p><em>Corresponding plots for IN/TN and SP/TP ratios</em>.
</p>
</li>
</ul>
<p>Per default, the function plots from available model variables in an imported HYPE basin output file, and missing variables will be
automatically omitted. Variable selection can be additionally fine-tuned using argument <code>hype.vars</code>.
</p>
<p>Argument <code>panels</code> allows to choose if bar chart panels should be plotted. This can be time-consuming for sites with many upstream
sub-basins and might not necessary e.g. during calibration. If <code>1</code> (default), all panels are plotted. If set to <code>2</code>, bar
charts will be excluded. If <code>3</code>, only bar charts will be plotted. Arguments <code>gd</code>, <code>bd</code>, <code>gcl</code>, <code>psd</code>, <code>subid</code>,
and <code>desc</code> are only needed for bar chart plotting.
</p>
<p>Below a complete list of HYPE variables known to the function in HYPE info.txt format, ready to copy-paste into an info.txt file.
For a detailed description of the variables, see the
<a href="http://hype.smhi.net//wiki/doku.php?id=start:hype_file_reference:info.txt:variables">HYPE online documentation</a>.
</p>
<p><code>basinoutput variable cout rout ccin rein ccon reon cctn retn ccsp resp ccpp repp cctp retp ctnl ctpl ccss ress ccts rets cct1 ret1</code>
</p>
<p>#' <em>Device dimensions</em> are hard-coded to a width of 13 inches and height depending on the number of plotted time series. When plotting
to a screen device, a maximum height of 10 inches is enforced in order to prevent automatic resizing with slow redrawing.
<code>PlotBasinOutput</code> throws a warning if the plot height exceeds 10 inches, which can lead to overlapping plot elements. On screens with
less than 10 inch screen height, redrawing is inhibited, which can lead to an empty plot. The recommended solution for both effects
is to plot to pdf or png file devices instead.
</p>


<h3>Value</h3>

<p>Returns a multi-panel plot in a new graphics device.
</p>


<h3>See Also</h3>

<p><code>PlotBasinOutput</code>, <code>BarplotUpstreamClasses</code>, <code>PlotSimObsRegime</code>, <code>PlotAnnualRegime</code>,
<code>PlotDurationCurve</code>, <code>ReadBasinOutput</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Source data, HYPE basin output with a number of result variables
te1 &lt;- ReadBasinOutput(filename = system.file("demo_model", "results", "0003587.txt", 
                       package = "HYPEtools"))
te2 &lt;- ReadGeoData(filename = system.file("demo_model", "GeoData.txt", package = "HYPEtools"))

## Not run: 
# Plot basin summary for discharge on screen device
PlotBasinSummary(x = te1, gd = te2, driver = "screen", panels = 2)

## End(Not run)

</code></pre>


</div>