<div class="container">

<table style="width: 100%;"><tr>
<td>FGGM.refit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Refitting of FGGM</h2>

<h3>Description</h3>

<p>Refitting when K0 is identified using FGGM().
</p>


<h3>Usage</h3>

<pre><code class="language-R">FGGM.refit(data, K, lambda1 = 0.5, lambda2 = 0.2, lambda3 = 2, a = 3, rho = 1,
                  eps = 5e-2, niter = 20, maxiter=10, maxiter.AMA=5,
                  initialization=T, initialize, average=F,
                  asymmetric=T, local_appro=T, penalty = "MCP", theta.fusion=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>n * p matrix, the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Int, a selected upper bound of K_0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>A float value, the tuning parameter controlling the sparse of the mean parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>A float value, the tuning parameter controlling the sparse of the precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda3</code></td>
<td>
<p>A float value, the tuning parameter controlling the number of subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A float value, regularization parameter in MCP, the default setting is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A float value, the penalty parameter in ADMM algorithm of updating precision matrix Theta, the default setting is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>A float value, algorithm termination threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Int, maximum number of cycles of the algorithm, the default setting is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Int, maximum number of cycles of the ADMM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter.AMA</code></td>
<td>
<p>Int, maximum number of cycles of the AMA algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialization</code></td>
<td>
<p>The logical variable, whether to calculate the initial value, the default setting is T, if initialization = F, the initial value uses initialize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialize</code></td>
<td>
<p>A given initial value used if initialization = F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>The logical variable, whether to use averaging when integrating parameters that are identified as identical subgroups, the default setting is F, which means the estimated parameters for the subgroup with the largest sample size among the subgroups identified as identical subgroups is used as the final parameter for this subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymmetric</code></td>
<td>
<p>The logical variable, symmetry of the precision matrices or not, the default setting is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_appro</code></td>
<td>
<p>The logical variable, whether to use local approximations when updating mean parameters, the default setting is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>The type of the penalty, which can be selected from c("MCP", "SCAD", "lasso").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.fusion</code></td>
<td>
<p>Whether or not the fusion penalty term contains elements of the precision matrices. The default setting is T.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list including all estimated parameters and the BIC value after refitting.
</p>


<h3>Author(s)</h3>

<p>Mingyang Ren, Sanguo Zhang, Qingzhao Zhang, Shuangge Ma. Maintainer: Mingyang Ren &lt;renmingyang17@mails.ucas.ac.cn&gt;.
</p>


<h3>References</h3>

<p>Ren, M., Zhang S., Zhang Q. and Ma S. (2020). Gaussian Graphical Model-based Heterogeneity Analysis via Penalized Fusion. Biometrics, Published Online.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 200              # The sample size of each subgroup
p &lt;- 20               # The dimension of the precision matrix
K0 &lt;- 3               # The true number of subgroups
N &lt;- rep(n,K0)        # The sample sizes of K0 subgroups
K &lt;- 6                # The given upper bound of K0.

################ The true parameters ################
mue &lt;- 1.5
nonnum &lt;- 4
mu01 &lt;- c(rep(mue,nonnum),rep(-mue,nonnum),rep(0,p-2*nonnum))
mu02 &lt;- c(rep(mue,2*nonnum),rep(0,p-2*nonnum))
mu03 &lt;- c(rep(-mue,2*nonnum),rep(0,p-2*nonnum))
# Power law network
set.seed(2)
A.list &lt;- Power.law.network(p,s=5,I2=c(1),I3=c(2))
Theta01 &lt;- A.list$A1
Theta02 &lt;- A.list$A2
Theta03 &lt;- A.list$A3
sigma01 &lt;- solve(Theta01)
sigma02 &lt;- solve(Theta02)
sigma03 &lt;- solve(Theta03)
Mu0.list &lt;- list(mu01,mu02,mu03)
Sigma0.list &lt;- list(sigma01,sigma02,sigma03)
Theta0.list &lt;- list(Theta01,Theta02,Theta03)

################ Generating simulated data ################
whole.data &lt;- generate.data(N,Mu0.list,Theta0.list,Sigma0.list)

PP = FGGM.refit(whole.data$data, K, lambda1 = 0.22, lambda2 = 0.12, lambda3 = 1.83)
mu_hat=PP$mu; Theta_hat=PP$Xi; L.mat = PP$L.mat0
group = PP$group; prob = PP$prob0; bic = PP$bic; member = PP$member
K0_hat = as.numeric(dim(Theta_hat)[3])
K0_hat


</code></pre>


</div>