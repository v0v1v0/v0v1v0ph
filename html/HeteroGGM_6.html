<div class="container">

<table style="width: 100%;"><tr>
<td>GGMPF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GGM-based heterogeneity analysis.</h2>

<h3>Description</h3>

<p>The main function of Gaussian graphical model-based heterogeneity analysis via penalized fusion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GGMPF(lambda, data, K, initial.selection="K-means", initialize, average=F,
             asymmetric=T, eps = 5e-2, maxiter=10,
             maxiter.AMA=5, local_appro=T, trace = F, penalty = "MCP", theta.fusion=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A list, the sequences of the tuning parameters (lambda1, lambda2, and lambda3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>n * p matrix, the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Int, a selected upper bound of K_0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.selection</code></td>
<td>
<p>The different initial values from two clustering methods, which can be selected from c("K-means","dbscan").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialize</code></td>
<td>
<p>A given initial values, which should be given when initial.selection is not in c("K-means","dbscan").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>The logical variable, whether to use averaging when integrating parameters that are identified as identical subgroups, the default setting is F, which means the estimated parameters for the subgroup with the largest sample size among the subgroups identified as identical subgroups is used as the final parameter for this subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymmetric</code></td>
<td>
<p>The logical variable, symmetry of the precision matrices or not, the default setting is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>A float value, algorithm termination threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Int, maximum number of cycles of the ADMM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter.AMA</code></td>
<td>
<p>Int, maximum number of cycles of the AMA algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_appro</code></td>
<td>
<p>The logical variable, whether to use local approximations when updating mean parameters, the default setting is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>The logical variable, whether or not to output the number of identified subgroups during the search for parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>The type of the penalty, which can be selected from c("MCP", "SCAD", "lasso").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.fusion</code></td>
<td>
<p>Whether or not the fusion penalty term contains elements of the precision matrices. The default setting is T.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list including all estimated parameters and the BIC values with all choices of given tuning parameters, and the selected optional parameters.
</p>


<h3>Author(s)</h3>

<p>Mingyang Ren, Sanguo Zhang, Qingzhao Zhang, Shuangge Ma. Maintainer: Mingyang Ren &lt;renmingyang17@mails.ucas.ac.cn&gt;.
</p>


<h3>References</h3>

<p>Ren, M., Zhang S., Zhang Q. and Ma S. (2022). Gaussian Graphical Model-based Heterogeneity Analysis via Penalized Fusion. Biometrics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
######## Example 1: Generate simulation data and apply this method to analysis #######
n &lt;- 200              # The sample size of each subgroup
p &lt;- 20               # The dimension of the precision matrix
K0 &lt;- 3               # The true number of subgroups
N &lt;- rep(n,K0)        # The sample sizes of K0 subgroups
K &lt;- 6                # The given upper bound of K0.

################ The true parameters ################
mue &lt;- 1.5
nonnum &lt;- 4
mu01 &lt;- c(rep(mue,nonnum),rep(-mue,nonnum),rep(0,p-2*nonnum))
mu02 &lt;- c(rep(mue,2*nonnum),rep(0,p-2*nonnum))
mu03 &lt;- c(rep(-mue,2*nonnum),rep(0,p-2*nonnum))

# Power law network
set.seed(2)
A.list &lt;- Power.law.network(p,s=5,I2=c(1),I3=c(2))
Theta01 &lt;- A.list$A1
Theta02 &lt;- A.list$A2
Theta03 &lt;- A.list$A3
sigma01 &lt;- solve(Theta01)
sigma02 &lt;- solve(Theta02)
sigma03 &lt;- solve(Theta03)
Mu0.list &lt;- list(mu01,mu02,mu03)
Sigma0.list &lt;- list(sigma01,sigma02,sigma03)
Theta0.list &lt;- list(Theta01,Theta02,Theta03)

################ Generating simulated data ################
whole.data &lt;- generate.data(N,Mu0.list,Theta0.list,Sigma0.list)

################ The implementation and evaluation ################
lambda &lt;- genelambda.obo(nlambda1=5,lambda1_max=0.5,lambda1_min=0.1,
                         nlambda2=15,lambda2_max=1.5,lambda2_min=0.1,
                         nlambda3=10,lambda3_max=3.5,lambda3_min=0.5)
res &lt;- GGMPF(lambda, whole.data$data, K, initial.selection="K-means")
Theta_hat.list &lt;- res$Theta_hat.list
Mu_hat.list &lt;- res$Mu_hat.list
prob.list &lt;- res$prob.list
L.mat.list &lt;- res$L.mat.list
opt_num &lt;- res$Opt_num
opt_Theta_hat &lt;- Theta_hat.list[[opt_num]]
opt_Mu_hat &lt;- Mu_hat.list[[opt_num]]
opt_L.mat &lt;- L.mat.list[[opt_num]]
opt_prob &lt;- prob.list[[opt_num]]
K_hat &lt;- dim(opt_Theta_hat)[3]
K_hat


######## Example 2: Call the built-in simulation data set and analyze #######
data(example.data)
K &lt;- 6
lambda &lt;- genelambda.obo(nlambda1=5,lambda1_max=0.5,lambda1_min=0.1,
                         nlambda2=15,lambda2_max=1.5,lambda2_min=0.1,
                         nlambda3=10,lambda3_max=3.5,lambda3_min=0.5)
res &lt;- GGMPF(lambda, example.data$data, K, initial.selection="K-means")
Theta_hat.list &lt;- res$Theta_hat.list
opt_num &lt;- res$Opt_num
opt_Theta_hat &lt;- Theta_hat.list[[opt_num]]
K_hat &lt;- dim(opt_Theta_hat)[3]
K_hat


</code></pre>


</div>