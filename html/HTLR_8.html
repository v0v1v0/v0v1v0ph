<div class="container">

<table style="width: 100%;"><tr>
<td>gendata_FAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Simulated Data with Factor Analysis Model</h2>

<h3>Description</h3>

<p>This function generates inputs <code>X</code> given by the response variable <code>y</code> 
using a multivariate normal model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gendata_FAM(n, muj, A, sd_g = 0, stdx = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muj</code></td>
<td>
<p>C by p matrix, with row c representing y = c, and column j representing <code class="reqn">x_j</code>.
Used to specify <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Factor loading matrix of size p by p, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_g</code></td>
<td>
<p>Numeric value indicating noise level <code class="reqn">\delta</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdx</code></td>
<td>
<p>Logical; if <code>TRUE</code>, data <code>X</code> is standardized to have <code>mean = 0</code> and <code>sd = 1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The means of each covariate <code class="reqn">x_j</code> depend on <code>y</code> specified by the 
matrix <code>muj</code>; the covariate matrix <code class="reqn">\Sigma</code> of the multivariate normal 
is equal to <code class="reqn">AA^t\delta^2I</code>, where <code>A</code> is the factor loading matrix
and <code class="reqn">\delta</code> is the noise level.
</p>


<h3>Value</h3>

<p>A list contains input matrix <code>X</code>, response variables <code>y</code>,
covariate matrix <code>SGM</code> and <code>muj</code> (standardized if <code>stdx = TRUE</code>).
</p>


<h3>See Also</h3>

<p><code>gendata_MLR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## feature #1: marginally related feature
## feature #2: marginally unrelated feature, but feature #2 is correlated with feature #1
## feature #3-5: marginally related features and also internally correlated
## feature #6-10: noise features without relationship with the y

set.seed(12345)
n &lt;- 100
p &lt;- 10

means &lt;- rbind(
  c(0, 1, 0),
  c(0, 0, 0),
  c(0, 0, 1),
  c(0, 0, 1),
  c(0, 0, 1)
) * 2

means &lt;- rbind(means, matrix(0, p - 5, 3))

A &lt;- diag(1, p)
A[1:5, 1:3] &lt;- rbind(
  c(1, 0, 0),
  c(2, 1, 0),
  c(0, 0, 1),
  c(0, 0, 1),
  c(0, 0, 1)
)

dat &lt;- gendata_FAM(n, means, A, sd_g = 0.5, stdx = TRUE)
ggplot2::qplot(dat$y, bins = 6)
corrplot::corrplot(cor(dat$X))

</code></pre>


</div>