<div class="container">

<table style="width: 100%;"><tr>
<td>predict.hda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heteroscedastic discriminant analysis</h2>

<h3>Description</h3>

<p>Computes linear transformation of new data into lower dimensional discriminative space using some model produced by <code>hda</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'hda'
predict(object, newdata, alldims = FALSE, task = c("dr", "c"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Model resulting from a call of <code>hda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A matrix or data frame to be transformed into lower dimensional space of the same dimension as the data used for building the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alldims</code></td>
<td>
<p>Logical flag specifying whether the result should contain only the reduced space (default) or should also 
include the redundant dimensions and thus be of the same dimension as the input data. In this case the reduced
space is given by the first <code>newdim</code> columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>task</code></td>
<td>
<p><code>"dr"</code> for standard application of the <code>hda</code> model to <code>newdata</code>. Choose <code>"c"</code> for classification of new data. 
This is an interface to predict function of <code>naiveBayes</code>. 
The option can be chosen if <code>crule = TRUE</code> has been specified in the <code>hda()</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the <code>naiveBayes</code> predict function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If option <code>type = "dr"</code> the transformed data are returned. For <code>type = "c"</code> both the transformed data as well as
the resulting object of the naive Bayes prediction are returned.
</p>


<h3>Author(s)</h3>

<p>Gero Szepannek</p>


<h3>References</h3>

<p>Kumar, N. and Andreou, A. (1998): <em>Heteroscedastic discriminant analysis and reduced rank HMMs 
for improved speech recognition.</em> Speech Communication 25, pp. 283-297.
</p>
<p>Szepannek G., Harczos, T., Klefenz, F. and Weihs, C. (2009): <em>Extending features for automatic speech recognition 
by means of auditory modelling.</em> In: Proceedings of European Signal Processing Conference (EUSIPCO) 2009, Glasgow, pp. 1235-1239. 
</p>


<h3>See Also</h3>

<p><code>hda</code>, <code>showloadings</code>, <code>plot.hda</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)
library(MASS)

# simulate data for two classes
n           &lt;- 50
meana       &lt;- meanb &lt;- c(0,0,0,0,0)
cova        &lt;- diag(5)
cova[1,1]   &lt;- 0.2
for(i in 3:4){
  for(j in (i+1):5){cova[i,j] &lt;- cova[j,i] &lt;- 0.75^(j-i)}
  }
covb       &lt;- cova
diag(covb)[1:2]  &lt;- c(1,0.2)

xa      &lt;- rmvnorm(n,meana,cova)
xb      &lt;- rmvnorm(n,meanb,covb)
x       &lt;- rbind(xa,xb)
classes &lt;- as.factor(c(rep(1,n),rep(2,n)))
# rotate simulated data
symmat &lt;- matrix(runif(5^2),5)
symmat &lt;- symmat + t(symmat)
even   &lt;- eigen(symmat)$vectors
rotatedspace &lt;- x %*% even

# apply heteroscedastic discriminant analysis and plot data in discriminant space
hda.res &lt;- hda(rotatedspace, classes)

# simulate new data
xanew      &lt;- rmvnorm(n,meana,cova)
xbnew      &lt;- rmvnorm(n,meanb,covb)
xnew       &lt;- rbind(xanew,xbnew)
classes &lt;- as.factor(c(rep(1,n),rep(2,n)))
newrotateddata &lt;- x %*% even
plot(as.data.frame(newrotateddata), col = classes)

# transform new data 
prediction &lt;- predict(hda.res, newrotateddata)
plot(as.data.frame(prediction), col = classes)

# predict classes for new data on automatically computed naive Bayes classification rule 
# this requires package e1071
hda.res2 &lt;- hda(rotatedspace, classes, crule = TRUE)
prediction2 &lt;- predict(hda.res2, newrotateddata, task = "c")
prediction2
</code></pre>


</div>