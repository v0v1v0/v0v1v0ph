<div class="container">

<table style="width: 100%;"><tr>
<td>PE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Projected Estimation for Large-Dimensional Matrix Factor Models 
</h2>

<h3>Description</h3>

<p>This function is to fit the matrix factor model via the PE method by projecting the observation matrix onto the row or column factor space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PE(X, m1, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Input an array with <code class="reqn">T \times p_1 \times p_2</code>, where <code class="reqn">T</code> is the sample size, <code class="reqn">p_1</code> is the the row dimension of each matrix observation and <code class="reqn">p_2</code> is the the column dimension of each matrix observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>

<p>A positive integer indicating the row factor numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>

<p>A positive integer indicating the column factor numbers.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the matrix factor models, Yu et al. (2022) propose a projection estimation method to estimate the model parameters. In details, for observations <code class="reqn">\bold{X}_t, t=1,2,\cdots,T</code>, the data matrix is projected to a lower dimensional space by setting 
</p>
<p style="text-align: center;"><code class="reqn">\bold{Y}_t = \frac{1}{p_2} \bold{X}_t \bold{C}.</code>
</p>

<p>Given <code class="reqn">\bold{Y}_t</code>, define </p>
<p style="text-align: center;"><code class="reqn"> \bold{M}_1 = \frac{1}{Tp_1} \sum_{t=1}^T \bold{Y}_t \bold{Y}_t^\top, </code>
</p>
<p> and then the row factor loading matrix <code class="reqn">\bold{R}</code> can be estimated by <code class="reqn">\sqrt{p_1}</code> times the leading <code class="reqn">k_1</code> eigenvectors of <code class="reqn">\bold{M}_1</code>. However, the projection matrix <code class="reqn">\bold{C}</code> is unavailable in practice. A natural solution is to replace it with a consistent initial estimator. The column factor loading matrix <code class="reqn">\bold{C}</code> can be similarly estimated by projecting <code class="reqn">\bold{X}_t</code> onto the space of <code class="reqn">\bold{C}</code> with <code class="reqn">\bold{R}</code>. See Yu et al. (2022) for the detailed algorithm.
</p>


<h3>Value</h3>

<p>The return value is a list. In this list, it contains the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>The estimated factor matrix of dimension <code class="reqn">T \times m_1\times m_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The estimated row loading matrix of dimension <code class="reqn">p_1\times m_1</code>, satisfying <code class="reqn">\bold{R}^\top\bold{R}=p_1\bold{I}_{m_1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The estimated column loading matrix of dimension <code class="reqn">p_2\times m_2</code>, satisfying <code class="reqn">\bold{C}^\top\bold{C}=p_2\bold{I}_{m_2}</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yong He, Changwei Zhao, Ran Zhao.
</p>


<h3>References</h3>

<p>Yu, L., He, Y., Kong, X., &amp; Zhang, X. (2022). Projected estimation for large-dimensional matrix factor models. Journal of Econometrics, 229(1), 201-217.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   set.seed(11111)
   T=20;p1=20;p2=20;k1=3;k2=3
   R=matrix(runif(p1*k1,min=-1,max=1),p1,k1)
   C=matrix(runif(p2*k2,min=-1,max=1),p2,k2)
   X=array(0,c(T,p1,p2))
   Y=X;E=Y
   F=array(0,c(T,k1,k2))
   for(t in 1:T){
     F[t,,]=matrix(rnorm(k1*k2),k1,k2)
     E[t,,]=matrix(rnorm(p1*p2),p1,p2)
     Y[t,,]=R%*%F[t,,]%*%t(C)
   }
   X=Y+E
   
   #Estimate the factor matrices and loadings
   fit=PE(X, k1, k2)
   Rhat=fit$R 
   Chat=fit$C
   Fhat=fit$F
   
   #Estimate the common component
   CC=array(0,c(T,p1,p2))
   for (t in 1:T){
   CC[t,,]=Rhat%*%Fhat[t,,]%*%t(Chat)
   }
   CC
</code></pre>


</div>