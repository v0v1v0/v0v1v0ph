<div class="container">

<table style="width: 100%;"><tr>
<td>extrapol.gev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial extrapolation of GEV parameters with the HKEVP</h2>

<h3>Description</h3>

<p>Predictive distributions of the GEV parameters at a set of ungauged sites (targets), given the output from the MCMC procedures <code>hkevp.fit</code> or <code>latent.fit</code>. See details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extrapol.gev(fit, targets, targets.covariates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Output from the <code>hkevp.fit</code> procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>A matrix of real values giving the spatial coordinates of the ungauged positions. Each row corresponds to an ungauged position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets.covariates</code></td>
<td>
<p>A matrix of real values giving the spatial covariates of the ungauged positions. Must match with the covariates used in <code>hkevp.fit</code> or <code>latent.fit</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since the GEV parameters are modelled with latent Gaussian processes, spatial extrapolation of the marginal distributions at target positions <code class="reqn">(s^*_1, ..., s^*_k)</code> is performed with simple kriging. Estimation is done at each MCMC step to produce a sample of the predictive distribution.
</p>


<h3>Value</h3>

<p>A named list of three elements: <code>loc</code>, <code>scale</code>, <code>shape</code>. Each one is a matrix with columns corresponding to targets positions.
</p>


<h3>Author(s)</h3>

<p>Quentin Sebille
</p>


<h3>See Also</h3>

<p><code>extrapol.return.level</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulation of HKEVP:
sites &lt;- as.matrix(expand.grid(1:3,1:3))
loc &lt;- sites[,1]*10
scale &lt;- 3
shape &lt;- 0
alpha &lt;- .4
tau &lt;- 1
ysim &lt;- hkevp.rand(10, sites, sites, loc, scale, shape, alpha, tau)

# HKEVP fit:
fit &lt;- hkevp.fit(ysim, sites, niter = 1000)

## Extrapolation:
targets &lt;- matrix(1.5, 1, 2)
gev.targets &lt;- extrapol.gev(fit, targets)

## True vs predicted:
predicted &lt;- sapply(gev.targets, median)
sd.predict &lt;- sapply(gev.targets, sd)
true &lt;- c(targets[,1]*10, scale, shape)
# cbind(true, predicted, sd.predict)


</code></pre>


</div>