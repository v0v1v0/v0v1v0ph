<div class="container">

<table style="width: 100%;"><tr>
<td>cortestClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Marginal Association Between Paired Clustered Data</h2>

<h3>Description</h3>

<p>Test for marginal association between paired samples in clustered data with potentially
informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cortestClust(x, ...)

## Default S3 method:
cortestClust(
  x,
  y,
  id,
  method = c("pearson", "kendall", "spearman"),
  alternative = c("two.sided", "less", "greater"),
  conf.level = 0.95,
  ...
)

## S3 method for class 'formula'
cortestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vectors of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector or factor object which identifies the clusters. The length of <code>id</code> should be the
same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which correlation coefficient is to be used for the test.
One of "<code>pearson</code>", "<code>kendall</code>", or "<code>spearman</code>". Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of "<code>two.sided</code>", "<code>greater</code>",
or "<code>less</code>".You can specify just the initial letter. "<code>greater</code>" corresponds to positive association,
"<code>less</code>" to negative association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level for the returned confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form ~ u + v, where each of <code>u</code> and <code>v</code> are numeric variables
giving the data values for one sample. The samples must be of the sample length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code>. By default the
variables are taken from <code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The three methods each estimate the marginal association between paired observations from
clustered data and compute a test of the value being zero.
</p>
<p>If <code>method</code> is "<code>pearson</code>" ("<code>kendall</code>"), the test statistic is based on the
Pearson product-moment (Kendall concordance coefficient) analog of Lorenz <em>et al.</em> (2011).
</p>
<p>If <code>method</code> is "<code>spearman</code>", the test statistic
is based on the Spearman coefficient analog of Lorenz <em>et al.</em> (2018) modified for paired data.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated measure of marginal association, with name "<code>cluster-weighted cor</code>",
"<code>cluster-weighted tau</code>", or "<code>cluster-weighted rho</code>" corresponding to the method employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the value of the association measure under the null hypothesis, always 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a confidence interval for the measure of association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating how the association was measured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lorenz, D., Datta, S., Harkema, S. (2011) Marginal association measures for clustered data.
<em>Statistics in Medicine</em>, <b>30</b>, 3181–3191.
</p>
<p>Lorenz, D., Levy, S., Datta, S. (2018) Inferring marginal association with paired and unpaired
clustered data. <em>Stat. Methods Med. Res.</em>, <b>27</b>, 1806–1817.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(screen8)
## test if math and reading scores are marginally correlated using vectors
cortestClust(screen8$read, screen8$math, screen8$sch.id)

## formula interface
cortestClust(~ math + read, sch.id, data=screen8, method="kendall")

</code></pre>


</div>