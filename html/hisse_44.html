<div class="container">

<table style="width: 100%;"><tr>
<td>TipCorrelation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic independent contrasts using tip rates</h2>

<h3>Description</h3>

<p>Performs linear regression between phylogenetic independent contrasts (PICs) of tip rates and continuous trais</p>


<h3>Usage</h3>

<pre><code class="language-R">TipCorrelation(phy, tip.rate, trait, log=TRUE, remove.cherries=TRUE, 
scaled=TRUE, positivise=TRUE, use.lmorigin=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>an ultrametric phylogenetic tree of class 'phylo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.rate</code></td>
<td>
<p>an object of class 'named numeric' containing tip.rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>an object of class 'named numeric' containing continuous trait data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Should tip.rate and trait values be logged before regression? The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.cherries</code></td>
<td>
<p>Should PICs of 'cherries' be pruned before regression? The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>Should PICs be scaled with their expected variances? The default to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positivise</code></td>
<td>
<p>Should PICs be positivised before regression? The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.lmorigin</code></td>
<td>
<p>Should a regression-through-origin be performed instead of regular linear model? The default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tip rates as those obtained with <code>MiSSEGreedy</code> are analogous to a continuous trait evolving in the tree and must also be corrected for phylogenetic 
non-independence before regression analyses. This function does that by using PICs (Felsenstein, 1985) and gives the additional option of removing PICs 
from 'cherries' from analyses. Cherries (theoretically) inherit the exact same rate class probabilities in any model that uses just branch lengths to estimate 
tip rates. For that reason, they may: (1) present identical tip rates, forcing the slope of the regression to be close to 0 since all PICs for cherries will be 0; 
and (2) constitute pseudoreplicates in the analyses. We suspect that, for that reason, it may make sense to prune them out from any PIC analyses that uses tip-rate
correlations from tree-only diversification approaches (see Vasconcelos et al. in prep.).
</p>


<h3>Value</h3>

<p>Returns an object that contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$correlation</code></td>
<td>
<p>summary of correlation results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$tip.rate PIC</code></td>
<td>
<p>tip rate PICs for each node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$trait PIC</code></td>
<td>
<p>trait PICs for each node.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thais Vasconcelos and Brian O'Meara</p>


<h3>References</h3>

<p>Vasconcelos, T, B.C. O'Meara, and J.M. Beaulieu. In prep.
Felsenstein, J. (1985). Phylogenies and the comparative method. The American Naturalist, 125, 1-15.
</p>


</div>