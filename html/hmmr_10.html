<div class="container">

<table style="width: 100%;"><tr>
<td>FFBS_BinomialNormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior (MCMC) samples for a hidden Markov model with a Binomial and Normal response using the forward-filtering backward-sampling algorithm.
</h2>

<h3>Description</h3>

<p>Posterior (MCMC) samples for a hidden Markov model with a Binomial and Normal response using the forward-filtering backward-sampling algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  
  FFBS_BinomialNormal(bin,norm,nstates,hyperPars=list(),ntimes,niter=1000,nburnin=0)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>the Binomial response variable. As in the glm function, this can be a binary vector with 1 indicating success and 0 failure, a factor where the first level is considered a failure and all other leves success, or a matrix with the number of successes and failures in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>the Normal response variable. This should be a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstates</code></td>
<td>
<p>the required number of states in the hidden Markov model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperPars</code></td>
<td>
<p>a named <code>list</code> with values of the hyper-parameters. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntimes</code></td>
<td>
<p>the lengths of time series in arguments <code>bin</code> and <code>norm</code>; it
defaults to assuming a single time series of length <code>length(bin)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>number of iterations to run the sampler for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburnin</code></td>
<td>
<p>number of initial samples to discard as burnin,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function runs the forward-filtering backwards-sampling MCMC algorithm for a hidden Markov model with a Binomial and Normal response variable. The response variables are assumed conditionally independent given the states.
</p>
<p>The following conjugate prior distributions are used:
</p>
<p>For the initial state probabilities, a Dirichlet prior with parameter vector <code>init_alpha</code>
</p>
<p>For each row in the transition probability matrix, a Dirichlet prior is used. The parameters of these Dirichlet distributions are contained in the matrix <code>trans_alpha</code>.
</p>
<p>For the probability of correct in the Binomial response, a Beta prior is used, with parameters <code>bin_alpha</code> and <code>bin_beta</code>.
</p>
<p>For the mean and variance of the Normal response, a Normal-inverse-Gamma prior is used.
</p>
<p>This function was written mainly for didactive purposes, not for speed (or compatibility with other packages which provide posterior samples). 
</p>


<h3>Value</h3>

<p>A named list with samples of the different parameters.
</p>


<h3>Author(s)</h3>

<p>Maarten Speekenbrink
</p>


<h3>References</h3>

<p>Visser, I., &amp; Speekenbrink, M. (in preparation). Mixture and hidden Markov models in R.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
  data(speed)
  set.seed(1)
  hyperPars &lt;- list(norm_invsigma_scale=.01,norm_invsigma_shape=.01,norm_mu_sca=.1)
  mcmc_samples &lt;- FFBS_BinomialNormal(speed$corr,speed$rt,nstates=2,
        ntimes=c(168,134,137),niter=500,hyperPars = hyperPars)
        
  plot(mcmc_samples$mu[,1])
  hist(mcmc_samples$mu[,1])

## End(Not run)

</code></pre>


</div>