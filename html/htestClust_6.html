<div class="container">

<table style="width: 100%;"><tr>
<td>icstestClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Informative Cluster Size</h2>

<h3>Description</h3>

<p>Performs a test for informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">icstestClust(x, id, test.method = c("TF", "TCM"), B = 1000, print.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of numeric responses. Can also be a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector or factor object which identifies the clusters; ignored if <code>x</code> is a data frame.
The length of <code>id</code> must be the same as the length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.method</code></td>
<td>
<p>character string specifying the method of construction for the test statistic.
Must be one of "<code>TF</code>" or "<code>TCM</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of bootstrap iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.it</code></td>
<td>
<p>a logical indicating whether to print the progression of bootstrap iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null is that the marginal distributions of the responses are independent of the cluster sizes.
A small p-value is evidence for the presence of informative cluster size.
</p>
<p>When <code>test.method = "TF"</code>, the test statistic is constructed based on differences between the null and
alternative distribution functions. "<code>TF</code>" is the suggested method when there are a large
number of unique cluster sizes and the number of clusters of each size is small. When <code>test.method = "TCM"</code>,
the test statistic is a multisample Cramer von Mises-based test. This method is recommended
when there are a small number of possible cluster sizes. See Nevalainen <em>et al.</em> (2017) for more details.
</p>
<p>When <code>x</code> is a data frame, the first column should contain values denoting cluster membership and
the second column the responses.
</p>
<p>This test is computationally intensive and can take significant time to execute. <code>print.it</code> defaults to
<code>TRUE</code> to identify the bootstrap progression.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the test performed and the method of construction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Nevalainen, J., Oja, H., Datta, S. (2017) Tests for informative cluster size using a novel balanced bootstrap scheme.
<em>Statistics in Medicine</em>, <b>36</b>, 2630â€“2640.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(screen8)
  ## using vectors
  ## test if cluster size is related to math scores
  icstestClust(screen8$math, screen8$sch.id, B=100)

  ## same test, but using a data frame and supressing iterations
  tdat &lt;- data.frame(screen8$sch.id, screen8$math)
  icstestClust(tdat, B=100, print.it = FALSE)

</code></pre>


</div>