<div class="container">

<table style="width: 100%;"><tr>
<td>cv_curegmifs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a penalized parametric mixture cure model using the GMIFS algorithm with cross-validation for model selection</h2>

<h3>Description</h3>

<p>Fits a penalized Weibull or exponential mixture cure model using the generalized monotone incremental forward stagewise (GMIFS) algorithm with k-fold cross-validation to select the optimal iteration step along the solution path. When FDR controlled variable selection is used, the model-X knockoffs method is applied and indices of selected variables are returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_curegmifs(
  formula,
  data,
  subset,
  x.latency = NULL,
  model = "weibull",
  penalty.factor.inc = NULL,
  penalty.factor.lat = NULL,
  fdr.control = FALSE,
  fdr = 0.2,
  epsilon = 0.001,
  thresh = 1e-05,
  scale = TRUE,
  maxit = 10000,
  inits = NULL,
  n_folds = 5,
  measure.inc = "c",
  one.se = FALSE,
  cure_cutoff = 5,
  parallel = FALSE,
  seed = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model to be fitted. The response must be a survival object as returned by the <code>Surv</code> function while the variables on the right side of the formula are the covariates that are included in the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the <code>formula</code> or in the <code>subset</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of observations to be used in the fitting process, either a numeric or factor variable should be used in subset, not a character variable. All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.latency</code></td>
<td>
<p>specifies the variables to be included in the latency portion of the model and can be either a matrix of predictors, a model formula with the right hand side specifying the latency variables, or the same data.frame passed to the <code>data</code> parameter. Note that when using the model formula syntax for <code>x.latency</code> it cannot handle <code>x.latency = ~ .</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>type of regression model to use for the latency portion of mixture cure model. Can be "weibull" or "exponential"; default is "weibull".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor.inc</code></td>
<td>
<p>vector of binary indicators representing the penalty to apply to each incidence coefficient: 0 implies no shrinkage and 1 implies shrinkage. If not supplied, 1 is applied to all incidence variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor.lat</code></td>
<td>
<p>vector of binary indicators representing the penalty to apply to each latency coefficient: 0 implies no shrinkage and 1 implies shrinkage. If not supplied, 1 is applied to all latency variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.control</code></td>
<td>
<p>logical, if TRUE, model-X knockoffs are used for FDR-controlled variable selection and indices of selected variables are returned (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>numeric value in (0, 1) range specifying the target FDR level to use for variable selection when <code>fdr.control=TRUE</code> (default is 0.2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>small numeric value reflecting incremental value used to update a coefficient at a given step (default is 0.001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>small numeric value. The iterative process stops when the differences between successive expected penalized complete-data log-likelihoods for both incidence and latency components are less than this specified level of tolerance (default is 10^-5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical, if TRUE the predictors are centered and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer specifying the maximum number of steps to run in the iterative algorithm (default is 10^4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>an optional list specifiying the initial value for the incidence intercept (<code>itct</code>), a numeric vector for the unpenalized incidence coefficients (<code>b_u</code>), and a numeric vector for unpenalized latency coefficients (<code>beta_u</code>), a numeric value for the rate parameter (<code>lambda</code>), and a numeric value for the shape parameter (<code>alpha</code>) when <code>model = "weibull"</code>. If not supplied or improperly supplied, initialization is automatically provided by the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_folds</code></td>
<td>
<p>an integer specifying the number of folds for the k-fold cross-valiation procedure (default is 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure.inc</code></td>
<td>
<p>character string specifying the evaluation criterion used in selecting the optimal <code class="reqn">\lambda_b</code>. Can be "c" or "auc"; default is "c". If <code>measure.inc="c"</code>, the C-statistic using the cure status weighting (CSW) method proposed by Asano and Hirakawa (2017) is used to select both <code class="reqn">\lambda_b</code> and <code class="reqn">\lambda_{\beta}</code>. If <code>measure.inc="auc"</code>, the AUC for cure prediction using the mean score imputation (MSI) method proposed by Asano et al. (2014) is used to select <code class="reqn">\lambda_b</code> while the C-statistic with CSW is used for <code class="reqn">\lambda_{\beta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one.se</code></td>
<td>
<p>logical, if TRUE then the one standard error rule is applied for selecting the optimal parameters. The one standard error rule selects the most parsimonious model having evaluation criterion no more than one standard error worse than that of the best evaluation criterion (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cure_cutoff</code></td>
<td>
<p>numeric value representing the cutoff time value that represents subjects not experiencing the event by this time are cured. This value is used to produce a proxy for the unobserved cure status when calculating C-statistic and AUC (default is 5 representing 5 years). Users should be careful to note the time scale of their data and adjust this according to the time scale and clinical application.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If TRUE, parallel processing is performed for K-fold CV using <code>foreach</code> and the <span class="pkg">doMC</span> package is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional integer representing the random seed. Setting the random seed fosters reproducibility of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, if TRUE running information is printed to the console (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b0 </code></td>
<td>
<p>Estimated intercept for the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b </code></td>
<td>
<p>Estimated coefficients for the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p>Estimated coefficients for the latency portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>Estimated shape parameter if the Weibull model is fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate </code></td>
<td>
<p>Estimated rate parameter if the Weibull or exponential model is fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik </code></td>
<td>
<p>Log-likelihood value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.step.inc </code></td>
<td>
<p>Iteration step selected for the incidence portion of the model using cross-validation. NULL when fdr.control is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.step.lat </code></td>
<td>
<p>Iteration step selected for the latency portion of the model using cross-validation. NULL when fdr.control is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.c </code></td>
<td>
<p>Maximum C-statistic achieved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.auc </code></td>
<td>
<p>Maximum AUC for cure prediction achieved; only output when <code>measure.inc="auc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.index.inc </code></td>
<td>
<p>Indices of selected variables for the incidence portion of the model when <code>fdr.control=TRUE</code>. If none selected, <code>int(0)</code> will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.index.lat </code></td>
<td>
<p>Indices of selected variables for the latency portion of the model when <code>fdr.control=TRUE</code>. If none selected, <code>int(0)</code> will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fu, H., Nicolet, D., Mrozek, K., Stone, R. M., Eisfeld, A. K., Byrd, J. C., Archer, K. J. (2022) Controlled variable selection in Weibull mixture cure models for high-dimensional data. <em>Statistics in Medicine</em>, <b>41</b>(22), 4340â€“4366.
</p>


<h3>See Also</h3>

<p><code>curegmifs</code>
</p>
<p><code>curegmifs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
set.seed(123)
temp &lt;- generate_cure_data(N = 100, J = 15, nTrue = 3, A = 1.8, rho = 0.2)
training &lt;- temp$Training

fit.cv &lt;- cv_curegmifs(Surv(Time, Censor) ~ ., data = training,
                      x.latency = training, fdr.control = FALSE,
                      maxit = 450, epsilon = 0.01,
                      n_folds = 2, seed = 23, verbose = TRUE)
</code></pre>


</div>