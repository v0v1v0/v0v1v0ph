<div class="container">

<table style="width: 100%;"><tr>
<td>whittle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Hawkes processes from discrete data</h2>

<h3>Description</h3>

<p>This function fits a Hawkes process to discrete data by minimizing the Whittle contrast.
</p>


<h3>Usage</h3>

<pre><code class="language-R">whittle(counts, kern, binsize = NULL, trunc = 5L, init = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A bin-count sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kern</code></td>
<td>
<p>Either a string (partially) matching one of the kernels implemented (see Details), or an object of class Model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>(Optional) The bin size of the bin-count sequence; if omitted, defaults to 1 if <code>kern</code> is a string, or uses the member <code>binsize</code> of <code>kern</code> if it is of class Model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>(Optional) The number of foldings taken into account due to aliasing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>(Optional) Initial values of the optimisation algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>optim</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If specified as string, the argument <code>kern</code> must match (partially) one of the following
(upper cases not taken into account): Exponential, SymmetricExponential,
Gaussian, PowerLaw, Pareto3, Pareto2, Pareto1.
The periodogram used in the optimisation procedure is computed in complexity
<code class="reqn">O(n \log n)</code>, using function <code>fft</code>.
</p>


<h3>Value</h3>

<p>Returns a list containing the solution of the optimisation procedure, the object Model
with its parameters updated to the solution, and the output produced by <code>optim</code>.
</p>


<h3>See Also</h3>

<p><code>hawkes()</code> for the simulation of Hawkes processes,
<code>discrete()</code> for the discretisation of simulated Hawkes processes,
Model for the abstract class, and Exponential for the specific
reproduction kernels.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate and fit a Hawkes process with exponential kernel
x = hawkes(1000, fun = 1, repr = .5, family = "exp", rate = 1)
y = discrete(x, binsize = 1)
opt = whittle(y, "Exponential")
opt$par      # Estimated parameters


# May take up to 20 seconds
# Simulate and fit a Hawkes process with power law kernel
x = hawkes(1000, fun = 1, repr= .3, family = "powerlaw", shape = 3.5, scale = 1.0)
y = discrete(x, binsize = 1)
opt = whittle(y, "powerlaw")
opt$par      # Estimated parameters

</code></pre>


</div>