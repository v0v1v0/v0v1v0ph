<div class="container">

<table style="width: 100%;"><tr>
<td>pairPhiST-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Provides the pairwise PhiST between populations</h2>

<h3>Description</h3>

<p>This function calculates pairwise PhiST between populations using the AMOVA framework.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Dna'
pairPhiST(x,populations,indels="sic",nperm=99, negatives=FALSE, subset =NULL, 
showprogbar=TRUE)
## S4 method for signature 'dist'
pairPhiST(x,populations,nperm=99, negatives=FALSE, subset=NULL,showprogbar=TRUE)
## S4 method for signature 'matrix'
pairPhiST(x,populations,nperm=99,negatives=FALSE, subset=NULL,showprogbar=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>Dna</code>, <code>"dist"</code> or <code>"matrix"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>populations</code></td>
<td>
<p>a vector giving the populations, with one element per individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indels</code></td>
<td>
<p>the indel coding method to be used. This must be one of "sic", "5th" or "missing". Any unambiguous substring can be given.  See <code>distance</code> for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>the number of permutations. Set this to 0 to skip the permutation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negatives</code></td>
<td>
<p>boolean; if it is FALSE all negative PhiST values are replaced with zero. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a vector of integers in the range [1, <code>length(unique(populations))</code>], only distances between selected population(s) and the rest of the populations are calculated. If it is NULL, all comparisons are done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showprogbar</code></td>
<td>
<p>boolean; whether the progress bar is displayed or not  displayed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null distribution of pairwise PhiST under the hypothesis of no difference between the populations is obtained by permuting individuals between populations.   
</p>


<h3>Value</h3>

<p>a list with following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PhiST</code></td>
<td>
<p>a matrix giving the PhiST values between populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a matrix giving the p-values, or NULL if permutation test is not performed.</p>
</td>
</tr>
</table>
<h3>Methods</h3>


<dl>
<dt><code>signature(x = "Dna")</code></dt>
<dd>
</dd>
<dt><code>signature(x = "dist")</code></dt>
<dd>
</dd>
<dt><code>signature(x = "matrix")</code></dt>
<dd>
</dd>
</dl>
<h3>Note</h3>

<p>An internal code <code>Statphi</code> is taken from package  <span class="pkg">ade4</span> version 1.7-8 without any modification, author Sandrine Pavoine. Function <code>amova</code> from package <span class="pkg">pegas</span> is used internally to estimate variance components, author Emmanuel Paradis.
</p>


<h3>Author(s)</h3>

<p>Caner Aktas, <a href="mailto:caktas.aca@gmail.com">caktas.aca@gmail.com</a>
</p>


<h3>References</h3>

<p>Excoffier, L., Smouse, P.E. and Quattro, J.M. (1992) Analysis of molecular variance inferred
from metric distances among DNA haplotypes: application to human mitochondrial DNA restriction
data. <em>Genetics</em>, <b>131</b>, 479-491.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("dna.obj")

### Method for signature 'Dna'.
x&lt;-dna.obj
x&lt;-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations&lt;-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")

##skip permutation testing
pst&lt;-pairPhiST(x, populations, nperm=0)
pst

##allow negative PhiST values
pst&lt;-pairPhiST(x, populations, nperm=0, negatives=TRUE)
pst

##Gaps as missing characters.
pst&lt;-pairPhiST(x, populations, indels="m", nperm=0, negatives=TRUE)
pst

##using subset, second population against others
pst &lt;-pairPhiST(x, populations, nperm=0,subset=c(2))
pst


## Not run: 
## 999 permutations.
pst&lt;-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst

## random populations
x&lt;-dna.obj
populations&lt;-sample(1:4,nrow(x),replace=TRUE)
pst&lt;-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst

## populations based on clusters
x&lt;-dna.obj
d&lt;-distance(x)
hc&lt;-hclust(d,method="ward.D")
populations&lt;-cutree(hc,4)
pst&lt;-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst

## End(Not run)

### Method for signature 'dist'.
x&lt;-dna.obj
x&lt;-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations&lt;-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
d&lt;-distance(x)
pst&lt;-pairPhiST(d, populations, nperm=0)
pst

### Method for signature 'matrix'.
x&lt;-dna.obj
x&lt;-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations&lt;-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
d&lt;-as.matrix(distance(x))
pst&lt;-pairPhiST(d, populations, nperm=0)
pst

</code></pre>


</div>