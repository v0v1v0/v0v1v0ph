<div class="container">

<table style="width: 100%;"><tr>
<td>hgrm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Hierarchical Graded Response Models (for Ordinal Responses)</h2>

<h3>Description</h3>

<p><code>hgrm</code> fits a hierarchical graded response model in which both
the mean and the variance of the latent preference (ability parameter)
may depend on person-specific covariates (<code>x</code> and <code>z</code>).
Specifically, the mean is specified as a linear combination of <code>x</code>
and the log of the variance is specified as a linear combination of
<code>z</code>. Nonresponses are treated as missing at random.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hgrm(
  y,
  x = NULL,
  z = NULL,
  constr = c("latent_scale", "items"),
  beta_set = 1L,
  sign_set = TRUE,
  init = c("naive", "glm", "irt"),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A data frame or matrix of item responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An optional model matrix, including the intercept term, that predicts the
mean of the latent preference. If not supplied, only the intercept term is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional model matrix, including the intercept term, that predicts the
variance of the latent preference. If not supplied, only the intercept term is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constr</code></td>
<td>
<p>The type of constraints used to identify the model: "latent_scale",
or "items". The default, "latent_scale" constrains the mean of latent preferences
to zero and the geometric mean of prior variance to one; "items" places constraints
on item parameters instead and sets the mean of item difficulty parameters to zero
and the geometric mean of the discrimination parameters to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_set</code></td>
<td>
<p>The index of the item for which the discrimination parameter is
restricted to be positive (or negative). It may take any integer value from
1 to <code>ncol(y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign_set</code></td>
<td>
<p>Logical. Should the discrimination parameter of
the corresponding item (indexed by <code>beta_set</code>) be positive
(if <code>TRUE</code>) or negative (if <code>FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A character string indicating how item parameters are initialized. It can be
"naive", "glm", or "irt".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control values
</p>

<dl>
<dt>max_iter</dt>
<dd>
<p>The maximum number of iterations of the EM algorithm.
The default is 150.</p>
</dd>
<dt>eps</dt>
<dd>
<p>Tolerance parameter used to determine convergence of the
EM algorithm. Specifically, iterations continue until the Euclidean
distance between <code class="reqn">\beta_{n}</code> and <code class="reqn">\beta_{n-1}</code> falls under <code>eps</code>,
where <code class="reqn">\beta</code> is the vector of item discrimination parameters.
<code>eps</code>=1e-4 by default.</p>
</dd>
<dt>max_iter2</dt>
<dd>
<p>The maximum number of iterations of the conditional
maximization procedures for updating <code class="reqn">\gamma</code> and <code class="reqn">\lambda</code>.
The default is 15.</p>
</dd>
<dt>eps2</dt>
<dd>
<p>Tolerance parameter used to determine convergence of the
conditional maximization procedures for updating <code class="reqn">\gamma</code> and
<code class="reqn">\lambda</code>. Specifically, iterations continue until the Euclidean
distance between two consecutive log likelihoods falls under <code>eps2</code>.
<code>eps2</code>=1e-3 by default.</p>
</dd>
<dt>K</dt>
<dd>
<p>Number of Gauss-Legendre quadrature points for the E-step. The default is 21.</p>
</dd>
<dt>C</dt>
<dd>
<p>[-C, C] sets the range of integral in the E-step. <code>C</code>=3 by default.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>hgrm</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A data frame of parameter estimates, standard errors,
z values and p values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A data frame of EAP estimates of latent preferences and
their approximate standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_Lik</code></td>
<td>
<p>The log-likelihood value at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Number of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>A vector denoting the number of response categories for each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylevels</code></td>
<td>
<p>A list showing the levels of the factorized response categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of predictors for the mean equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of predictors for the variance equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List of control values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhou, Xiang. 2019. "<a href="https://doi.org/10.1017/pan.2018.63">Hierarchical Item Response Models for Analyzing Public Opinion.</a>" Political Analysis.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- nes_econ2008[, -(1:3)]
x &lt;- model.matrix( ~ party * educ, nes_econ2008)
z &lt;- model.matrix( ~ party, nes_econ2008)
nes_m1 &lt;- hgrm(y, x, z)
nes_m1
</code></pre>


</div>