<div class="container">

<table style="width: 100%;"><tr>
<td>fit.NB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit negative binomial mixed models (NBMM) for one or more features.</h2>

<h3>Description</h3>

<p>Fit NBMM for one or more features and output the fit parameters. 
It is used before the function computeVPC.NB(). This function also allows 
to test the presence of heritability via random effect variance of the model. To fit a NBMM, the glmmADMB package is needed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.NB(CountMatrix, Strains, test = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CountMatrix</code></td>
<td>
<p>Sequencing count matrix for a list of features. Each row 
is for one feature, and the columns are for samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Strains</code></td>
<td>
<p>Strain labels for the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>TRUE or FALSE (default). Test the presence of heritability 
through examining the random effect variance <code class="reqn">\sigma_g^2 = 0</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two objects. The first object is a <code class="reqn">G \times 3</code> 
matrix indicating the fitted parameters for each feature. The columns are 
ordered by <code class="reqn">\alpha_g, \sigma_g^2, \phi_g</code>. 
Row names are feature names. If the argument test is set to
be true, the second object of the list consists of p-values for testing 
the hypothesis that random effects <code class="reqn">\sigma_a^2 = 0</code>; 
otherwise, the second object is NULL.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compute vpc for each feature under NBMM. This will take a while on the
##  entire dataset. For the purpose of illustration, here we only fit on 
##  the first 2 features.
result.nb &lt;- fit.NB(simData[1:2, ], strains)

</code></pre>


</div>