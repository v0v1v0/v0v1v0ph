<div class="container">

<table style="width: 100%;"><tr>
<td>hgrm2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical Graded Response Models with Known Item Parameters</h2>

<h3>Description</h3>

<p><code>hgrm2</code> fits a hierarchical graded response model where the item parameters
are known and supplied by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hgrm2(y, x = NULL, z = NULL, item_coefs, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A data frame or matrix of item responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An optional model matrix, including the intercept term, that predicts the
mean of the latent preference. If not supplied, only the intercept term is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional model matrix, including the intercept term, that predicts the
variance of the latent preference. If not supplied, only the intercept term is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_coefs</code></td>
<td>
<p>A list of known item parameters. The parameters of item <code class="reqn">j</code> are given
by the <code class="reqn">j</code>th element, which should be a vector of length <code class="reqn">H_j</code>, containing
<code class="reqn">H_j - 1</code> item difficulty parameters (in descending order) and one item discrimination
parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control values
</p>

<dl>
<dt>max_iter</dt>
<dd>
<p>The maximum number of iterations of the EM algorithm.
The default is 150.</p>
</dd>
<dt>eps</dt>
<dd>
<p>Tolerance parameter used to determine convergence of the
EM algorithm. Specifically, iterations continue until the Euclidean
distance between <code class="reqn">\beta_{n}</code> and <code class="reqn">\beta_{n-1}</code> falls under <code>eps</code>,
where <code class="reqn">\beta</code> is the vector of item discrimination parameters.
<code>eps</code>=1e-4 by default.</p>
</dd>
<dt>max_iter2</dt>
<dd>
<p>The maximum number of iterations of the conditional
maximization procedures for updating <code class="reqn">\gamma</code> and <code class="reqn">\lambda</code>.
The default is 15.</p>
</dd>
<dt>eps2</dt>
<dd>
<p>Tolerance parameter used to determine convergence of the
conditional maximization procedures for updating <code class="reqn">\gamma</code> and
<code class="reqn">\lambda</code>. Specifically, iterations continue until the Euclidean
distance between two consecutive log likelihoods falls under <code>eps2</code>.
<code>eps2</code>=1e-3 by default.</p>
</dd>
<dt>K</dt>
<dd>
<p>Number of Gauss-Legendre quadrature points for the E-step. The default is 21.</p>
</dd>
<dt>C</dt>
<dd>
<p>[-C, C] sets the range of integral in the E-step. <code>C</code>=3 by default.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>hgrm</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A data frame of parameter estimates, standard errors,
z values and p values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A data frame of EAP estimates of latent preferences and
their approximate standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_Lik</code></td>
<td>
<p>The log-likelihood value at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Number of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>A vector denoting the number of response categories for each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylevels</code></td>
<td>
<p>A list showing the levels of the factorized response categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of predictors for the mean equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of predictors for the variance equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List of control values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
y &lt;- nes_econ2008[, -(1:3)]
x &lt;- model.matrix( ~ party * educ, nes_econ2008)
z &lt;- model.matrix( ~ party, nes_econ2008)

n &lt;- nrow(nes_econ2008)
id_train &lt;- sample.int(n, n/4)
id_test &lt;- setdiff(1:n, id_train)

y_train &lt;- y[id_train, ]
x_train &lt;- x[id_train, ]
z_train &lt;- z[id_train, ]

mod_train &lt;- hgrm(y_train, x_train, z_train)

y_test &lt;- y[id_test, ]
x_test &lt;- x[id_test, ]
z_test &lt;- z[id_test, ]

item_coefs &lt;- lapply(coef_item(mod_train), `[[`, "Estimate")

model_test &lt;- hgrm2(y_test, x_test, z_test, item_coefs = item_coefs)
</code></pre>


</div>