<div class="container">

<table style="width: 100%;"><tr>
<td>hotelling.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-sample Hotelling's T-squared test</h2>

<h3>Description</h3>

<p>Performs a two-sample Hotelling's T-squared test for the difference in two
multivariate means
</p>


<h3>Usage</h3>

<pre><code class="language-R">hotelling.test(x, ...)

## Default S3 method:
hotelling.test(
  x,
  y,
  shrinkage = FALSE,
  var.equal = TRUE,
  perm = FALSE,
  B = 10000,
  progBar = (perm &amp;&amp; TRUE),
  ...
)

## S3 method for class 'formula'
hotelling.test(x, data = NULL, pair = c(1, 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix containing the data points from sample 1, or a formula
specifying the elements to be used as a response and the grouping variable
as a predictor, or a list containing elements <code>mean</code>, <code>cov</code>, and
<code>n</code> where <code>mean</code> is a mean vector of length p, <code>cov</code> is a
variance-covariance matrix of dimension p by p, and <code>n</code> is the sample
size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any additional arguments. This is useful to pass the optional
arguments for the default call from the formula version</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a matrix containing the data points from sample 2, or a list
containing elements <code>mean</code>, <code>cov</code>, and <code>n</code> where <code>mean</code>
is a mean vector of length p, <code>cov</code> is a variance-covariance matrix of
dimension p by p, and <code>n</code> is the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>if <code>TRUE</code> then Shaefer and Strimmer's James-Stein
shrinkage estimator is used to calculate the sample covariance matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p>set to <code>TRUE</code> if the covariance matrices are (assumed to be) equal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>if <code>TRUE</code> then permutation testing is used to estimate the
non-parametric P-value for the hypothesis test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>if perm is TRUE, then B is the number of permutations to perform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progBar</code></td>
<td>
<p>if <code>TRUE</code> and <code>perm</code> is TRUE then a progress bar
will be displayed whilst the permutation procedure is carried out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame needs to be specified if a formula is to be used to
perform the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair</code></td>
<td>
<p>a vector of length two which can be used when the grouping factor
has more than two levels to select different pairs of groups. For example
for a 3-level factor, pairs could be set to <code>c(1,3)</code> to perform
Hotelling's test between groups 1 an 3</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list (which is also of class 'hotelling.test') with the following
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>a list containing all of the output from
<code>hotelling.stat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>the P-value from the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>if <code>perm == TRUE</code>, then all of the permuation test
statisics are stored in results</p>
</td>
</tr>
</table>
<h3>Methods (by class)</h3>


<ul>
<li> <p><code>default</code>: Two-sample Hotelling's T-squared test
</p>
</li>
<li> <p><code>formula</code>: Two-sample Hotelling's T-squared test
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>James M. Curran
</p>


<h3>References</h3>

<p>Hotelling, H. (1931). “The generalization of Student's ratio.”
Annals of Mathematical Statistics 2 (3): 360–378.
</p>
<p>Schaefer, J., and K. Strimmer (2005). “A shrinkage approach to large-scale
covariance matrix estimation and implications for functional genomics.”
Statist. Appl. Genet. Mol. Biol. 4: 32.
</p>
<p>Opgen-Rhein, R., and K. Strimmer (2007). “Accurate ranking of
differentially expressed genes by a distribution-free shrinkage approach.”
Statist. Appl. Genet. Mol. Biol. 6: 9.
</p>
<p>Campbell, G.P. and J. M. Curran (2009). “The interpretation of elemental
composition measurements from forensic glass evidence III.” Science and
Justice, 49(1),2-7.
</p>


<h3>See Also</h3>

<p>hotelling.stat
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(container.df)
fit = hotelling.test(.~gp, data = container.df)
fit

subs.df = container.df[1:10,]
subs.df$gp = rep(1:2, c(5,5))
fitPerm = hotelling.test(Al+Fe~gp, data  = subs.df, perm =  TRUE)
fitPerm
plot(fitPerm)

data(bottle.df)
fit12 = hotelling.test(.~Number, data = bottle.df)
fit12

fit23 = hotelling.test(.~Number, data = bottle.df, pair = c(2,3))
fit23

data(manova1.df)
fit = hotelling.test(wratr+wrata~treatment, data = manova1.df, var.equal = FALSE)
fit

x = list(mean = c(7.81, 108.77, 44.92),
         cov = matrix(c(0.461, 1.18, 4.49,
                        1.18, 3776.4, -17.35, 
                        4.49, -17.35, 147.24), nc = 3, byrow = TRUE),
         n = 13)
y = list(mean = c(5.89, 41.9, 20.8),
         cov = matrix(c(0.148, -0.679, 0.209, 
                       -0.679, 96.10, 20.20,
                        0.209, 20.20, 24.18), nc = 3, byrow = TRUE),
         n = 10)
fit = hotelling.test(x, y, var.equal = FALSE)
fit
</code></pre>


</div>