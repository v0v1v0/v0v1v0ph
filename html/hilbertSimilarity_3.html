<div class="container">

<table style="width: 100%;"><tr>
<td>andrewsProjection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use Andrews plots to visualize the Hilbert curve</h2>

<h3>Description</h3>

<p>Use a Fourier series to project the Hilbert curve, based on the number of points
per Hilbert index. See <a href="https://en.wikipedia.org/wiki/Andrews_plot">Wikipedia - Andrews plot</a>
for a description of the method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">andrewsProjection(x, breaks = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of counts, where rows correspond to samples and columns to Hilbert index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>the number of points used to display the Andrews curve</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Andrews curve corresponds to a projection of each item to <code class="reqn">(1/2^0.5,sin(t),cos(t),sin(2t),cos(2t),...)</code> where
<em>t</em> (the Andrews index) varies between <code class="reqn">-\pi</code> and <code class="reqn">\pi</code>.
</p>


<h3>Value</h3>

<p>a list with 2 items:
</p>

<ul>
<li>
<p> freq : a matrix with <code>breaks</code> rows and <code>ncol(x)</code> columns containing the Andrews vector for projection
</p>
</li>
<li>
<p> i : a vector with <code>breaks</code> elements corresponding to the Andrews indices
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yann Abraham
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate a random matrix
ncols &lt;- 5
mat &lt;- matrix(rnorm(ncols*1000),ncol=ncols)
dimnames(mat)[[2]] &lt;- LETTERS[seq(ncols)]

# generate categories
conditions &lt;- sample(letters[1:3],nrow(mat),replace = TRUE)
# generate 4 bins with a minimum bin size of 5
horder &lt;- 4
cuts &lt;- make.cut(mat,n=horder+1,count.lim=5)
# Generate the cuts and compute the Hilbert index
cut.mat &lt;- do.cut(mat,cuts,type='fixed')
hc &lt;- do.hilbert(cut.mat,horder)
# compute hilbert index per condition
condition.mat &lt;- table(conditions,hc)
condition.pc &lt;- apply(condition.mat,1,function(x) x/sum(x))
condition.pc &lt;- t(condition.pc)
# project the matrix to the Andrews curve
av &lt;- andrewsProjection(condition.pc)
proj &lt;- condition.pc %*% t(av$freq)

plot(range(av$i),
     range(proj),
     type='n',
     xlab='Andrews index',
     ylab='Projection')
for(i in seq(nrow(proj))) {
    lines(av$i,
          proj[i,],
          col=i)
}
legend('bottomleft',
       legend=letters[1:3],
       col=seq(1,3),
       pch=16,
       bty='n')
</code></pre>


</div>