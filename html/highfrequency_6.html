<div class="container">

<table style="width: 100%;"><tr>
<td>AJjumpTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ait-Sahalia and Jacod (2009) tests for the presence of jumps in the price series.</h2>

<h3>Description</h3>

<p>This test examines the presence of jumps in highfrequency price series. It is based on the theory of Ait-Sahalia and Jacod (2009). 
It consists in comparing the multi-power variation of equi-spaced returns computed at a fast time scale (<code class="reqn">h</code>), <code class="reqn">r_{t,i}</code> (<code class="reqn">i=1, \ldots,N</code>) and those computed at the slower time scale (<code class="reqn">kh</code>), <code class="reqn">y_{t,i}</code>(<code class="reqn">i=1, \ldots ,\mbox{N/k}</code>).
</p>
<p>They found that the limit (for <code class="reqn">N</code> <code class="reqn">\to</code> <code class="reqn">\infty</code> ) of the realized power variation is invariant for different sampling scales and that their ratio is <code class="reqn">1</code> in case of jumps and <code class="reqn">\mbox{k}^{p/2}-1</code> if no jumps.
Therefore the AJ test detects the presence of jump using the ratio of realized power variation sampled from two scales. The null hypothesis is no jumps.
</p>
<p>The function returns three outcomes: 1.z-test value 2.critical value under confidence level of <code class="reqn">95\%</code> and 3. <code class="reqn">p</code>-value.
</p>
<p>Assume there is <code class="reqn">N</code> equispaced returns in period <code class="reqn">t</code>. Let <code class="reqn">r_{t,i}</code> be a return (with <code class="reqn">i=1, \ldots,N</code>) in period <code class="reqn">t</code>.
</p>
<p>And there is <code class="reqn">N/k</code> equispaced returns in period <code class="reqn">t</code>. Let <code class="reqn">y_{t,i}</code> be a return (with <code class="reqn">i=1, \ldots ,\mbox{N/k}</code>) in period <code class="reqn">t</code>.
</p>
<p>Then the AJjumpTest is given by: 
</p>
<p style="text-align: center;"><code class="reqn">
     \mbox{AJjumpTest}_{t,N}= \frac{S_t(p,k,h)-k^{p/2-1}}{\sqrt{V_{t,N}}}
   </code>
</p>

<p>in which, 
</p>
<p style="text-align: center;"><code class="reqn">
   \mbox{S}_t(p,k,h)= \frac{PV_{t,M}(p,kh)}{PV_{t,M}(p,h)}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mbox{PV}_{t,N}(p,kh)= \sum_{i=1}^{N/k}{|y_{t,i}|^p}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mbox{PV}_{t,N}(p,h)= \sum_{i=1}^{N}{|r_{t,i}|^p}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mbox{V}_{t,N}= \frac{N(p,k) A_{t,N(2p)}}{N A_{t,N(p)}}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mbox{N}(p,k)= \left(\frac{1}{\mu_p^2}\right)(k^{p-2}(1+k))\mu_{2p} + k^{p-2}(k-1) \mu_p^2 - 2k^{p/2-1}\mu_{k,p}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mbox{A}_{t,n(2p)}= \frac{(1/N)^{(1-p/2)}}{\mu_p} \sum_{i=1}^{N}{|r_{t,i}|^p} \ \ \mbox{for} \ \ |r_j|&lt; \alpha(1/N)^w
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
   \mu_{k,p}=  E(|U|^p  |U+\sqrt{k-1}V|^p)
 </code>
</p>
 
<p><code class="reqn">U, V</code>: independent standard normal random variables; <code class="reqn">h=1/N</code>; <code class="reqn">p, k, \alpha, w</code>: parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AJjumpTest(
  pData,
  p = 4,
  k = 2,
  alignBy = NULL,
  alignPeriod = NULL,
  alphaMultiplier = 4,
  alpha = 0.975,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pData</code></td>
<td>
<p>either an <code>xts</code> or a <code>data.table</code> containing the prices of a single asset, possibly over multiple days.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>can be chosen among 2 or 3 or 4. The author suggests 4. 4 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>can be chosen among 2 or 3 or 4. The author suggests 2. 2 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignBy</code></td>
<td>
<p>character, indicating the time scale in which <code>alignPeriod</code> is expressed. 
Possible values are: <code>"ticks"</code>, <code>"secs"</code>, <code>"seconds"</code>, <code>"mins"</code>, <code>"minutes"</code>, <code>"hours"</code>
To aggregate based on a 5 minute frequency, set <code>alignPeriod</code> to 5 and <code>alignBy</code> to "minutes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignPeriod</code></td>
<td>
<p>positive numeric, indicating the number of periods to aggregate over. For example, to aggregate
based on a 5 minute frequency, set <code>alignPeriod = 5</code> and <code>alignBy = "minutes"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaMultiplier</code></td>
<td>
<p>alpha multiplier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric of length one with the significance level to use for the jump test(s). Defaults to 0.975.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>used internally</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The theoretical framework underlying jump test is that the logarithmic price process <code class="reqn">X_t</code> belongs to the class of Brownian semimartingales, which can be written as:
</p>
<p style="text-align: center;"><code class="reqn">
     \mbox{X}_{t}=  \int_{0}^{t} a_udu + \int_{0}^{t}\sigma_{u}dW_{u} + Z_t
   </code>
</p>

<p>where <code class="reqn">a</code> is the drift term, <code class="reqn">\sigma</code> denotes the spot volatility process, <code class="reqn">W</code> is a standard Brownian motion and <code class="reqn">Z</code> is a jump process defined by:
</p>
<p style="text-align: center;"><code class="reqn">
     \mbox{Z}_{t}=  \sum_{j=1}^{N_t}k_j
   </code>
</p>

<p>where <code class="reqn">k_j</code> are nonzero random variables. The counting process can be either finite or infinite for finite or infinite activity jumps.
</p>
<p>Using the convergence properties of power variation and its dependence on the time scale on which it is measured, 
Ait-Sahalia and Jacod (2009) define a new variable which converges to 1 in the presence of jumps in the underlying return series, 
or to another deterministic and known number in the absence of jumps (Theodosiou and Zikes, 2009).
</p>


<h3>Value</h3>

<p>a list or <code>xts</code> in depending on whether input prices span more than one day.
</p>


<h3>Author(s)</h3>

<p>Giang Nguyen, Jonathan Cornelissen, Kris Boudt, and Emil Sjoerup.
</p>


<h3>References</h3>

<p>Ait-Sahalia, Y. and Jacod, J. (2009). Testing for jumps in a discretely observed process. The Annals of Statistics, 37(1), 184-222.
</p>
<p>Theodosiou, M., &amp; Zikes, F. (2009). A comprehensive comparison of alternative tests for jumps in asset prices. Unpublished manuscript, Graduate School of Business, Imperial College London.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

jt &lt;- AJjumpTest(sampleTData[, list(DT, PRICE)], p = 2, k = 3, 
                 alignBy = "seconds", alignPeriod = 5, makeReturns = TRUE)

</code></pre>


</div>