<div class="container">

<table style="width: 100%;"><tr>
<td>mediate_spcma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse Principal Component Mediation Analysis for High-Dimensional Mediators</h2>

<h3>Description</h3>

<p><code>mediate_spcma</code> applies sparse principal component mediation
analysis to mediation settings in which the mediators are high-dimensional.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mediate_spcma(
  A,
  M,
  Y,
  var_per = 0.8,
  n_pc = NULL,
  sims = 1000,
  boot_ci_type = "bca",
  ci_level = 0.95,
  fused = FALSE,
  gamma = 0,
  per_jump = 0.7,
  eps = 1e-04,
  maxsteps = 2000,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>length <code>n</code> numeric vector containing exposure variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p><code>n x p</code> numeric matrix of high-dimensional mediators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>length <code>n</code> numeric vector containing continuous outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_per</code></td>
<td>
<p>a numeric variable with the desired proportion of variance
explained. Default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_pc</code></td>
<td>
<p>optional numeric variable with the desired number of PCs, in which case
<code>var_per</code> is ignored. Default is <code>NULL</code> and the number of PCs is
determined based on the desired proportion of variance explained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>number of Monte Carlo draws for nonparametric bootstrap or
quasi-Bayesian approximation (see <code>mediation::mediate()</code>).
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot_ci_type</code></td>
<td>
<p>character string indicating the type of bootstrap
confidence intervals for when <code>boot = TRUE</code>. If <code>"bca"</code>,
bias-corrected and accelerated (BCa) confidence intervals will be estimated.
If <code>"perc"</code>, percentile confidence intervals will be estimated
(see <code>mediation::mediate()</code>). Default is "bca".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_level</code></td>
<td>
<p>the designated confidence level. Default 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fused</code></td>
<td>
<p>logical variable for whether the fused LASSO should be used
instead of the ordinary LASSO. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>numeric variable <code>&gt;=0</code> indicating the ratio of the
standard LASSO penalty to the fusion penalty (see <code>genlasso::genlasso()</code>).
Ignored if <code>fused = FALSE</code>. Default is 0, meaning there is no standard
penalty. Larger values result in more shrinkage and sparser PCs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per_jump</code></td>
<td>
<p>numeric value used for tuning parameter selection - the
quantile cut-off for total variance change under different <code>lambda</code> values
in the LASSO. Default is 0.7. Larger values result in more shrinkage and
sparser PCs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric variable indicating the multiplier for the ridge penalty
in case <code>X</code> is rank deficient (see  <code>genlasso::genlasso()</code>).
Default is <code>1e-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>an integer specifying the maximum number of steps for the
algorithm before termination (see <code>genlasso::genlasso()</code>). Default
is 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed used for fitting single-mediator models after PCA</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mediate_spcma</code> performs principal component mediation analysis, comparable
to <code>mediate_pcma</code>, with the modification that the PC loadings are sparsified
by a flexible LASSO penalty. This has the potential make the PCs more interpretable,
since, unlike in PCA, they are only linear combinations of a subset of mediators
rather than all of them. The choice of LASSO penalties is determined by
the <code>fused</code> argument - which, when set to <code>TRUE</code>, deploys a fused
LASSO penalty that encourages the model to give consecutive mediators
similar loadings. The default is <code>fused = FALSE</code>, and the standard
LASSO penalty is used instead of the fusion penalty. Once the sparse PCs are
computed, inference proceeds exactly like in PCMA, and the PC-mediators are
evaluated with methods from the <code>mediate</code> package.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>loadings</code>: a matrix of the PC loadings.
</p>
</li>
<li> <p><code>pcs</code>: a matrix of the PCs.
</p>
</li>
<li> <p><code>var_explained</code>: the cumulative proportion of variance explained by the PCs.
</p>
</li>
<li> <p><code>contributions</code>: a data frame containing the estimates, confidence
intervals, and p-values of the mediation contributions.
</p>
</li>
<li> <p><code>effects</code>: a data frame containing the estimated direct, global
mediation, and total effects.
</p>
</li>
</ul>
<h3>Source</h3>

<p><a href="https://rdrr.io/github/zhaoyi1026/spcma">https://rdrr.io/github/zhaoyi1026/spcma</a>
</p>


<h3>References</h3>

<p>Zhao, Y., Lindquist, M. A. &amp; Caffo, B. S. Sparse principal
component based high-dimensional mediation analysis. Comput. Stat.
Data Anal. 142, 106835 (2020).
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- med_dat$A
M &lt;- med_dat$M
Y &lt;- med_dat$Y

# Fit SPCMA with the fused LASSO penalty while choosing the number of PCs based
# on the variance they explain. In practice, var_per and sims should be higher.
out &lt;- mediate_spcma(A, M, Y, var_per = 0.25, fused = TRUE, gamma = 2, sims = 10)
out$effects

</code></pre>


</div>