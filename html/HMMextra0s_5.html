<div class="container">

<table style="width: 100%;"><tr>
<td>HMMextra0s-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hidden Markov Models with Extra Zeros Hidden Markov Models (HMMs) with Extra Zeros
</h2>

<h3>Description</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> HMMextra0s</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Hidden Markov Models with Extra Zeros</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.1.0</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> mvtnorm, ellipse</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> HiddenMarkov</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> methods</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2021-08-02</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Ting Wang, Wolfgang Hayek, and Alexander Pletzer</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Ting Wang &lt;ting.wang@otago.ac.nz&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Contains functions for hidden Markov models with observations having extra zeros as defined in the following two publications, Wang, T., Zhuang, J., Obara, K. and Tsuruoka, H. (2016) &lt;doi:10.1111/rssc.12194&gt;; Wang, T., Zhuang, J., Buckby, J., Obara, K. and Tsuruoka, H. (2018) &lt;doi:10.1029/2017JB015360&gt;. The observed response variable is either univariate or bivariate Gaussian conditioning on presence of events, and extra zeros mean that the response variable takes on the value zero if nothing is happening. Hence the response is modelled as a mixture distribution of a Bernoulli variable and a continuous variable. That is, if the Bernoulli variable takes on the value 1, then the response variable is Gaussian, and if the Bernoulli variable takes on the value 0, then the response is zero too. This package includes functions for simulation, parameter estimation, goodness-of-fit, the Viterbi algorithm, and plotting the classified 2-D data. Some of the functions in the package are based on those of the R package 'HiddenMarkov' by David Harte. This updated version has included an example dataset and R code examples to show how to transform the data into the objects needed in the main functions. We have also made changes to increase the speed of some of the functions.</td>
</tr>
<tr>
<td style="text-align: left;">
LazyData: </td>
<td style="text-align: left;"> no</td>
</tr>
<tr>
<td style="text-align: left;">
ZipData: </td>
<td style="text-align: left;"> no</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
<td style="text-align: left;">
URL: </td>
<td style="text-align: left;"> https://www.stats.otago.ac.nz/?people=ting_wang</td>
</tr>
<tr>
<td style="text-align: left;">
Packaged: </td>
<td style="text-align: left;"> 2021-08-02 01:56:30 UTC; twang</td>
</tr>
<tr>
<td style="text-align: left;">
NeedsCompilation: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
HMMextra0s-package      Hidden Markov Models with Extra Zeros Hidden
                        Markov Models (HMMs) with Extra Zeros
Kii                     Tremor data in the Kii region in 2002 and 2003
                        for use in function hmm0norm2d
Viterbi.hmm0norm        Viterbi Path of a 1-D HMM with Extra Zeros
Viterbi.hmm0norm2d      Viterbi Path of a Bivariate HMM with Extra
                        Zeros
cumdist.hmm0norm        Cumulative distribution of an HMM with Extra
                        Zeros
hmm0norm                Parameter Estimation of an HMM with Extra Zeros
hmm0norm2d              Parameter Estimation of a bivariate HMM with
                        Extra Zeros
plotVitloc2d            Plot the Classified 2-D Data of a Bivariate HMM
                        With Extra Zeros
plotVitpath2d           Plot the Viterbi Path of a Bivariate HMM With
                        Extra Zeros
sim.hmm0norm            Simulation of a 1-D HMM with Extra Zeros
sim.hmm0norm2d          Simulation of a Bivariate HMM with Extra Zeros
</pre>
<p>This package contains functions to estimate the parameters of the HMMs with extra zeros using <code>hmm0norm</code> (1-D HMM) 
and <code>hmm0norm2d</code> (2-D HMM), to calculate the cumulative distribution of the 1-D HMM using <code>cumdist.hmm0norm</code>, 
to estimate the Viterbi path using <code>Viterbi.hmm0norm</code> (1-D HMM) and <code>Viterbi.hmm0norm2d</code> (2-D HMM), to 
simulate this class of models using <code>sim.hmm0norm</code> (1-D HMM) and <code>sim.hmm0norm2d</code> (2-D HMM), to plot the 
classified 2-D data with different colours representing different hidden states using <code>plotVitloc2d</code>, and to plot the 
Viterbi path using <code>plotVitloc2d</code>.
</p>


<h3>Details</h3>

<p>This package is used to estimate the parameters, carry out simulations, and estimate the Viterbi path for 1-D and 2-D HMMs with extra 
zeros as defined in the two publications in the reference (also briefly defined below). It contains examples using simulated data for 
how to set up initial values for a data analysis and how to plot the results.
</p>
<p>An HMM is a statistical model in which the observed process is dependent on an unobserved Markov chain. A Markov chain is a sequence 
of states which exhibits a short-memory property such that the current state of the chain is dependent only on the previous state in 
the case of a first-order Markov chain. Assume that the Markov chain has <code class="reqn">m</code> states, where <code class="reqn">m</code> can be estimated from the data. 
Let <code class="reqn">S_t \in \{1,\cdots,m\}</code> denote the state of the Markov chain at time <code class="reqn">t</code>. The probability of a first-order Markov chain 
in state <code class="reqn">j</code> at time <code class="reqn">t</code> given the previous states is <code class="reqn">P(S_t=j|S_{t-1},\cdots,S_{1})=P(S_t=j|S_{t-1})</code>. 
These states are not observable. The observation <code class="reqn">Y_t</code> at time <code class="reqn">t</code> depends on the state <code class="reqn">S_t</code> of the Markov chain. 
</p>
<p>In this framework, we are interested in estimating the transition probability matrix <code class="reqn">\Gamma=(\gamma_{ij})_{m\times m}</code> of the 
Markov chain that describes the migration pattern and the density function <code class="reqn">f(y_t|S_t=i)</code> that gives the distribution feature of 
observations in state <code class="reqn">i</code>, where <code class="reqn">\gamma_{ij}=P(S_t=j|S_{t-1}=i)</code>.
</p>
<p>Let <code class="reqn">Z_t</code> be a Bernoulli variable, with <code class="reqn">Z_t=1</code> if an event is present at <code class="reqn">t</code>, and <code class="reqn">Z_t=0</code>, otherwise.
Let <code class="reqn">\mathbf{X}_t</code> be the response variable (e.g., location of the tremor cluster in 2D space) at time <code class="reqn">t</code>. 
We set <code class="reqn">P(Z_t=0|S_t=i)=1-p_i</code> and <code class="reqn">P(Z_t=1|S_t=i)=p_i</code>. We assume that, given <code class="reqn">Z_t=1</code> and <code class="reqn">S_t=i</code>, 
<code class="reqn">\mathbf{X}_t</code> follows a univariate or bivariate normal distribution, e.g. for a bivariate normal,
</p>
<p style="text-align: center;"><code class="reqn">
f(\mathbf{x}_t|Z_t=1, S_t=i)=\frac{1}{2\pi |\bm{\Sigma}_i|^{1/2}}\exp\left(-\frac{1}{2}
(\mathbf{x}_t-\bm{\mu}_i)^T\bm{\Sigma}_i^{-1}(\mathbf{x}_t-\bm{\mu}_i)\right).
</code>
</p>

<p>The joint probability density function of <code class="reqn">Z_t</code> and <code class="reqn">\mathbf{X}_t</code> conditional on the system being in state <code class="reqn">i</code> at time <code class="reqn">t</code> is
</p>
<p style="text-align: center;"><code class="reqn">
f(\mathbf{x}_t,z_t | S_t=i)=(1-p_i)^{1-z_t}\left[p_i\frac{1}{2\pi |\bm{\Sigma}_i|^{1/2}}\exp\left(-\frac{1}{2}(\mathbf{x}_t-\bm{\mu}_i)^T\bm{\Sigma}_i^{-1}(\mathbf{x}_t-\bm{\mu}_i)\right)\right]^{z_t},
</code>
</p>

<p>where <code class="reqn">p_i</code>, <code class="reqn">\bm{\mu}_i=E(\mathbf{X}_t|S_t=i,Z_t=1)</code> and <code class="reqn">\bm{\Sigma}_i=Var(\mathbf{X}_t|S_t=i,Z_t=1)</code> are parameters to be 
estimated.
</p>


<h3>Author(s)</h3>

<p>Ting Wang, Wolfgang Hayek, and Alexander Pletzer
</p>
<p>Maintainer: Ting Wang &lt;ting.wang@otago.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, T., Zhuang, J., Obara, K. and Tsuruoka, H. (2016) Hidden Markov Modeling of Sparse Time Series from Non-volcanic Tremor Observations. Journal of the Royal Statistical Society, Series C, Applied Statistics, 66, Part 4, 691-715.
</p>
<p>Wang, T., Zhuang, J., Buckby, J., Obara, K. and Tsuruoka, H. (2018) Identifying the recurrence patterns of non-volcanic tremors using a 2D hidden Markov model with extra zeros. Journal of Geophysical Research, doi: <a href="https://doi.org/10.1029/2017JB015360">10.1029/2017JB015360</a>.
</p>
<p>Some of the functions in the package are based on those of the R package â€œHiddenMarkov":
</p>
<p>Harte, D. (2021) HiddenMarkov: Hidden Markov Models. R package version 1.8-13. URL: <a href="https://cran.r-project.org/package=HiddenMarkov">https://cran.r-project.org/package=HiddenMarkov</a>
</p>


</div>