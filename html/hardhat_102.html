<div class="container">

<table style="width: 100%;"><tr>
<td>weighted_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted table</h2>

<h3>Description</h3>

<p><code>weighted_table()</code> computes a weighted contingency table based on factors
provided in <code>...</code> and a double vector of weights provided in <code>weights</code>. It
can be seen as a weighted extension to <code>base::table()</code> and an alternative
to <code>stats::xtabs()</code>.
</p>
<p><code>weighted_table()</code> always uses the <em>exact</em> set of levels returned by
<code>levels()</code> when constructing the table. This results in the following
properties:
</p>

<ul>
<li>
<p> Missing values found in the factors are never included in the table unless
there is an explicit <code>NA</code> factor level. If needed, this can be added to a
factor with <code>base::addNA()</code> or <code>forcats::fct_expand(x, NA)</code>.
</p>
</li>
<li>
<p> Levels found in the factors that aren't actually used in the underlying
data are included in the table with a value of <code>0</code>. If needed, you can
drop unused factor levels by re-running your factor through <code>factor()</code>,
or by calling <code>forcats::fct_drop()</code>.
</p>
</li>
</ul>
<p>See the examples section for more information about these properties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weighted_table(..., weights, na_remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Factors of equal length to use in the weighted table. If the
<code>...</code> are named, those names will propagate onto the "dimnames names" of
the resulting table. At least one factor must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A double vector of weights used to fill the cells of the
weighted table. This must be the same length as the factors provided in
<code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_remove</code></td>
<td>
<p>A single <code>TRUE</code> or <code>FALSE</code> for handling whether or not
missing values in <code>weights</code> should be removed when summing up the weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The result of <code>weighted_table()</code> does not have a <code>"table"</code> class attached
to it. It is only a double array. This is because "table" objects are
defined as containing integer counts, but weighted tables can utilize
fractional weights.
</p>


<h3>Value</h3>

<p>The weighted table as an array of double values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- factor(c("x", "y", "z", "x", "x", "y"))
y &lt;- factor(c("a", "b", "a", "a", "b", "b"))
w &lt;- c(1.5, 2, 1.1, .5, 3, 2)

weighted_table(x = x, y = y, weights = w)

# ---------------------------------------------------------------------------
# If `weights` contains missing values, then missing values will be
# propagated into the weighted table
x &lt;- factor(c("x", "y", "y"))
y &lt;- factor(c("a", "b", "b"))
w &lt;- c(1, NA, 3)

weighted_table(x = x, y = y, weights = w)

# You can remove the missing values while summing up the weights with
# `na_remove = TRUE`
weighted_table(x = x, y = y, weights = w, na_remove = TRUE)

# ---------------------------------------------------------------------------
# If there are missing values in the factors, those typically don't show
# up in the weighted table
x &lt;- factor(c("x", NA, "y", "x"))
y &lt;- factor(c("a", "b", "a", NA))
w &lt;- 1:4

weighted_table(x = x, y = y, weights = w)

# This is because the missing values aren't considered explicit levels
levels(x)

# You can force them to show up in the table by using `addNA()` ahead of time
# (or `forcats::fct_expand(x, NA)`)
x &lt;- addNA(x, ifany = TRUE)
y &lt;- addNA(y, ifany = TRUE)
levels(x)

weighted_table(x = x, y = y, weights = w)

# ---------------------------------------------------------------------------
# If there are levels in your factors that aren't actually used in the
# underlying data, then they will still show up in the table with a `0` value
x &lt;- factor(c("x", "y", "x"), levels = c("x", "y", "z"))
y &lt;- factor(c("a", "b", "a"), levels = c("a", "b", "c"))
w &lt;- 1:3

weighted_table(x = x, y = y, weights = w)

# If you want to drop these empty factor levels from the result, you can
# rerun `factor()` ahead of time to drop them (or `forcats::fct_drop()`)
x &lt;- factor(x)
y &lt;- factor(y)
levels(x)

weighted_table(x = x, y = y, weights = w)
</code></pre>


</div>