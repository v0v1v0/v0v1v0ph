<div class="container">

<table style="width: 100%;"><tr>
<td>bootcor_restr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap correction to obtain desired failure probability</h2>

<h3>Description</h3>

<p>Simulation-based iterative procedure to correct for possible bias with respect to the
failure probability alpha
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootcor_restr(
  ppdata,
  cutoff,
  numit = 100,
  tol = 0.001,
  nxprob = 0.1,
  hole = NULL,
  obsprobimage = NULL,
  intens = NULL,
  covmatrix = NULL,
  simulate = "intens",
  radiusClust = NULL,
  clustering = 5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Desired failure probability alpha, which is the probability of having
unobserved events outside the high-risk zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numit</code></td>
<td>
<p>Number of iterations to perform (per tested value for cutoff). Default value is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance: acceptable difference between the desired failure probability and the fraction of
high-risk zones not covering all events. Default value is 0.02.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hole</code></td>
<td>
<p>(optional) an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsprobimage</code></td>
<td>
<p>(optional) an object of class <code>im</code> giving the observation probabilities inside the
observation window. Ranges of the coordinates must equal those of <code>ppdata</code>.
Only used if <code>obsprobs</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class "im",
see <code>density.ppp</code>). If not given,
it will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only meaningful
if no intensity is given. If not given, it will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate</code></td>
<td>
<p>The type of simulation, can be one of <code>"thinning", "intens"</code> or <code>"clintens"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radiusClust</code></td>
<td>
<p>(optional) radius of the circles around the parent points in which the cluster
points are located. Only used for <code>simulate = "clintens"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>a value &gt;= 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it also is the parameter of the Poisson distribution
for the number of points per cluster. Only used for <code>simulate = "clintens"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should information on tested values/progress be printed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a desired failure probability alpha, the corresponding parameter which is to use
when determining a high-risk zone is found in an iterative procedure. The simulation procedure
is the same as in <code>eval_method</code>. In every iteration,
the number of high-risk zones with at least one unobserved event located outside is
compared with the desired failure probability. If necessary, the value of <code>cutoff</code> is
increased or decreased. The final value <code>alphastar</code> can than be used in
<code>det_hrz</code>.
</p>
<p>The function offers the possibility to take into account so-called restriction areas. This is relevant in
situations where the observed point pattern <code>ppdata</code> is incomplete. If it is known that no observations
can be made in a certain area (for example because of water expanses),
this can be accounted for by integrating a hole in the observation window.
The shape and location of the hole is given by <code>hole</code>. Holes are
part of the resulting high-risk zone.
Another approach consists in weighting the observed events with their reciprocal observation probability when
estimating the intensity. To do so, the observation probability can be specified by using
<code>obsprobsimage</code> (an image of the observation probability). Note that the
observation probability may vary in space.
</p>
<p>For further information, see Mahling (2013), Appendix A (References).
</p>
<p>If there are no restriction areas in the observation window, <code>bootcor</code>
can be used instead.
</p>


<h3>Value</h3>

<p>An object of class bootcorr, which consists of a list of the final value for alpha (<code>alphastar</code>)
and a data.frame <code>course</code> containing information on the simulation course, e.g. the tested values.
</p>


<h3>References</h3>

<p>Monia Mahling, Michael H?hle &amp; Helmut K?chenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag G?ttingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
Chapter 6 and Appendix A
</p>


<h3>See Also</h3>

<p><code>det_hrz</code>, <code>eval_method</code>, <code>bootcor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(craterA)
set.seed(4321)
# define restriction area
restrwin &lt;- spatstat.geom::owin(xrange = craterA$window$xrange, 
                          yrange = craterA$window$yrange,
                          poly = list(x = c(1500, 1500, 2000, 2000), 
                                      y = c(2000, 1500, 1500, 2000)))

# create image of observation probability (30% inside restriction area)
wim &lt;- spatstat.geom::as.im(craterA$window, value = 1)
rim &lt;- spatstat.geom::as.im(restrwin, xy = list(x = wim$xcol, y = wim$yrow))
rim$v[is.na(rim$v)] &lt;- 0
oim1 &lt;- spatstat.geom::eval.im(wim - 0.7 * rim)

## Not run: 
# perform bootstrap correction
bc1 &lt;- bootcor_restr(ppdata=craterA, cutoff=0.4, numit=100, tol=0.02, obsprobimage=oim1, nxprob=0.1)
bc1
summary(bc1)
plot(bc1)

# determine high-risk zone by weighting the observations
hrzi1 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
 cutoff = bc1$alphastar, hole=NULL, obsprobs=NULL, obsprobimage=oim1, nxprob = 0.1)

# perform bootstrap correction
set.seed(4321)
bc2 &lt;- bootcor_restr(ppdata=craterA, cutoff=0.4, numit=100, tol=0.02, hole=restrwin, nxprob=0.1)
bc2
summary(bc2)
plot(bc2)

# determine high-risk zone by accounting for a hole
hrzi2 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
 cutoff = bc2$alphastar, hole=restrwin, obsprobs=NULL, obsprobimage=NULL, nxprob = 0.1)

## End(Not run)
</code></pre>


</div>