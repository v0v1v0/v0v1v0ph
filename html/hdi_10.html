<div class="container">

<table style="width: 100%;"><tr>
<td>lasso.proj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>P-values based on lasso projection method</h2>

<h3>Description</h3>

<p>Compute p-values based on the lasso projection method, also known as
the de-sparsified Lasso, using an asymptotic gaussian approximation
to the distribution of the estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lasso.proj(x, y, family = "gaussian", standardize = TRUE,
           multiplecorr.method = "holm", N = 10000,
           parallel = FALSE, ncores = getOption("mc.cores", 2L),
           betainit = "cv lasso", sigma = NULL, Z = NULL, verbose = FALSE,
           return.Z = FALSE, suppress.grouptesting = FALSE, robust = FALSE,
	   do.ZnZ = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Design matrix (without intercept).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Should design matrix be standardized to unit column
standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplecorr.method</code></td>
<td>
<p>Either "WY" or any of
<code>p.adjust.methods</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of empirical samples (only used if multiplecorr.method
== "WY")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Should parallelization be used? (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores used for parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betainit</code></td>
<td>
<p>Either a numeric vector, corresponding to a sparse
estimate of the coefficient vector, or the method to be used for the
initial estimation, "scaled lasso" or "cv lasso".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Estimate of the standard deviation of the error term. This
estimate needs to be compatible with the initial
estimate (see betainit) provided or calculated. Otherwise, results
will not be correct.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>user input, also see <code>return.Z</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A boolean to enable reporting on the progress of the
computations. (Only prints out information when Z is not provided by
the user)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.Z</code></td>
<td>
<p>An option to return the intermediate result which only
depends on the design matrix x. This intermediate results
can be used when calling the function again and the design matrix
is the same as before.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.grouptesting</code></td>
<td>
<p>A boolean to optionally suppress the
preparations made for testing groups. This will avoid quite a bit of
computation and memory usage. The output will also be smaller.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Uses a robust variance estimation procedure to be able
to deal with model misspecification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.ZnZ</code></td>
<td>
<p>Use a slightly different way of choosing tuning
parameters to compute Z, called Z&amp;Z based on Zhang and Zhang (2014).
This choice of tuning parameter
results in a slightly higher variance of the estimator.
More concretely, it achieves a 25
variance of the estimator (over j=1..ncol(x)) in comparison to tuning with
cross-validation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Individual p-values for each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.corr</code></td>
<td>
<p>Multiple testing corrected p-values for each
parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupTest</code></td>
<td>
<p>Function to perform groupwise tests. Groups are
indicated using an index vector with entries in 1,...,p or a list thereof.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterGroupTest</code></td>
<td>
<p>Function to perform groupwise tests based on
hierarchical clustering. You can either provide a distance matrix
and clustering method or the output of hierarchical clustering from
the function <code>hclust</code> as for
<code>clusterGroupBound</code>. P-values are adjusted for multiple testing.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>sigmahat</code></td>
<td>
<p><code class="reqn">\widehat{\sigma}</code> coming from the scaled lasso.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Only different from NULL if the option return.Z is on. This
is an intermediate result from the computation which only depends on
the design matrix x. These are the residuals of the nodewise regressions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ruben Dezeure</p>


<h3>References</h3>

<p>van de Geer, S., Bühlmann, P., Ritov, Y. and Dezeure, R. (2014)
On asymptotically optimal confidence regions and tests for
high-dimensional models. <em>Annals of Statistics</em> <b>42</b>, 1166–1202._
</p>
<p>Zhang, C., Zhang, S. (2014)
Confidence intervals for low dimensional parameters in high
dimensional linear models. <em>Journal of the Royal Statistical
Society: Series B</em> <b>76</b>, 217–242.
</p>
<p>Bühlmann, P. and van de Geer, S. (2015)
High-dimensional inference in misspecified linear models.
<em>Electronic Journal of Statistics</em> <b>9</b>, 1449–1473.
</p>


<h3>Examples</h3>

<pre><code class="language-R">



x &lt;- matrix(rnorm(100 * 10), nrow = 100, ncol = 10)
y &lt;- x[,1] + x[,2] + rnorm(100)
fit.lasso &lt;- lasso.proj(x, y)
which(fit.lasso$pval.corr &lt; 0.05) # typically: '1' and '2' and no other

## Group-wise testing of the first two coefficients
fit.lasso$groupTest(1:2)

##Compute confidence intervals
confint(fit.lasso, level = 0.95)


## Hierarchical testing using distance matrix based on
## correlation matrix
out.clust &lt;- fit.lasso$clusterGroupTest()
plot(out.clust)

## Fit the lasso projection method without doing the preparations
## for group testing (saves time and memory)
fit.lasso.faster &lt;- lasso.proj(x, y, suppress.grouptesting = TRUE)

## Use the scaled lasso for the initial estimate
fit.lasso.scaled &lt;- lasso.proj(x, y, betainit = "scaled lasso")
which(fit.lasso.scaled$pval.corr &lt; 0.05)

## Use a robust estimate for the standard error
fit.lasso.robust &lt;- lasso.proj(x, y, robust = TRUE)
which(fit.lasso.robust$pval.corr &lt; 0.05)


## Perform the Z&amp;Z version of the lasso projection method
fit.lasso &lt;- lasso.proj(x, y, do.ZnZ = TRUE)

which(fit.lasso$pval.corr &lt; 0.05) # typically: '1' and '2' and no other
</code></pre>


</div>