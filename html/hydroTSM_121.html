<div class="container">

<table style="width: 100%;"><tr>
<td>seasonalfunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Seasonal Function
</h2>

<h3>Description</h3>

<p>Generic function for applying any R function to a zoo object, in order to obtain 4 representative seasonal values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seasonalfunction(x, ...)

## Default S3 method:
seasonalfunction(x, FUN, na.rm = TRUE, type="default", ...)

## S3 method for class 'zoo'
seasonalfunction(x, FUN, na.rm = TRUE, type="default", ...)

## S3 method for class 'data.frame'
seasonalfunction(x, FUN, na.rm = TRUE, type="default",
                          dates=1, date.fmt = "%Y-%m-%d", 
                          out.type = "data.frame", verbose = TRUE, ...)
                          
## S3 method for class 'matrix'
seasonalfunction(x, FUN, na.rm = TRUE, type="default",
                          dates=1, date.fmt = "%Y-%m-%d", 
                          out.type = "data.frame", verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>zoo, data.frame or matrix object, with daily or monthly time series. <br>
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>Function that will be applied to ALL the values in <code>x</code> belonging to each one of the 4 weather seasons (e.g., <code>FUN</code> can be some of <code>mean</code>, <code>max</code>, <code>min</code>, <code>sd</code>). <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>Logical. Should missing values be removed before the computations? <br>
-) <kbd>TRUE</kbd> : the monthly values  are computed considering only those values in <code>x</code> different from NA  (<b>very important when <code>FUN=sum</code></b>) <br>
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the FUN and monthly values are NA    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>character, indicating which weather seasons will be used for computing the output. Possible values are: <br>
-) <kbd>default</kbd>          =&gt;  "winter"= Dec, Jan, Feb;      "spring"= Mar, Apr, May;  "summer"=Jun, Jul, Aug;       "autumn"= Sep, Oct, Nov  <br>
-) <kbd>FrenchPolynesia</kbd>  =&gt;  "winter"= Dec, Jan, Feb, Mar; "spring"= Apr, May;       "summer"=Jun, Jul, Aug, Sep;  "autumn"= Oct, Nov 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>

<p>numeric, factor, Date indicating how to obtain the dates. <br>
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br>
If <code>dates</code> is a factor, it is converted into Date class, by using the date format specified by <code>date.fmt</code>  <br>
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <code>dates</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code>as.Date</code>. <br>
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.type</code></td>
<td>

<p>Character defining the desired type of output. Valid values are: <br>
-) <kbd>data.frame</kbd>: a data.frame, with 4 columns representing the weather seasons, and as many rows as stations are included in <code>x</code> <br>
-) <kbd>db</kbd>        : a data.frame, with 4 colums will be produced. Useful for a posterior boxplot <br>
The first column (StationID) will store the ID of the station,  <br>
The second column (Year) will store the year,              <br>
The third column (Season) will store the season,  <br>
The fourth column (Value) will contain the seasonal value corresponding to that year and that station.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical; if TRUE, progress messages are printed 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The <var>FUN</var> value for the winter season (DJF) is computed considering the consecutive months of December, January and February. Therefore, if <code>x</code> starts in January and ends in December of any year, the winter value of the first year is computed considering only the January and February value of that year, whereas the December value of the first year is used to compute the winter value of the next year.
</p>


<h3>Note</h3>

<p><code>FUN</code> is applied to all the values of <code>x</code> belonging to each one of the four weather seasons, so the results of this function depends on the frequency sampling of <code>x</code> and the type of function given by <code>FUN</code> <br></p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code>dm2seasonal</code>, <code>time2season</code>, <code>monthlyfunction</code>, <code>annualfunction</code>, <code>extract</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Amount of years
nyears &lt;- yip(from=start(x), to=end(x), out.type="nmbr")

## Mean annual precipitation.
# It is necessary to divide by the amount of years to obtain the mean annual value, 
# otherwise it will give the total precipitation for all the 70 years
seasonalfunction(x, FUN=sum, na.rm=TRUE) / nyears

#####################
### verification ####
# Mean winter (DJF) value
sum( extractzoo(x, trgt="DJF") ) / nyears

# Mean spring (MAM) value
sum( extractzoo(x, trgt="MAM") ) / nyears

# Mean summer (JJA) value
sum( extractzoo(x, trgt="JJA") ) / nyears

# Mean autumn (SON) value
sum( extractzoo(x, trgt="SON") ) / nyears



</code></pre>


</div>