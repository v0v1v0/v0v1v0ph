<div class="container">

<table style="width: 100%;"><tr>
<td>computeVPC.NB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the negative binomial (NB) variance partition coefficient (VPC)
for one or more features.</h2>

<h3>Description</h3>

<p>Calculate the NB VPC for one or more features following the model fitting 
function fit.NB().
</p>


<h3>Usage</h3>

<pre><code class="language-R">computeVPC.NB(para)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A <code class="reqn">G \times 3</code> matrix of negative binomial fit 
parameters for <code class="reqn">G</code> features, <code class="reqn">G\geq 1</code>. The column order is intercept 
<code class="reqn">\alpha_g</code>, random effect <code class="reqn">\sigma_g^2 (\sigma_g^2\geq0)</code>, 
and dispersion <code class="reqn">\phi (\phi&gt;0)</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A <code class="reqn">G \times 1</code> matrix consisting of VPC for
<code class="reqn">G</code> features based on negative binomial mixed model. Column name 
is "NB-fit"; row names are the feature names.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Compute VPC for each feature under negative binomial mixed model.
vpc.nb &lt;- computeVPC.NB(para_nb)

## Visulize the distribution of the VPCs. 
hist(vpc.nb, breaks = 50, col = "cyan")

## Plot sorted VPCs.
plot(sort(vpc.nb), ylab = "Heritability (h2)", ylim = c(0,1), 
main = "Sorted NB VPC scores")
abline(h = 0.9, lty = 2, col = "red")
text(50, 0.92, "h2 = 0.9", col = "red")
</code></pre>


</div>