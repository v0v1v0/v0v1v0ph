<div class="container">

<table style="width: 100%;"><tr>
<td>simple_ensemble</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ensemble model outputs by summarizing component model outputs for
each combination of model task, output type, and output type id. Supported
output types include <code>mean</code>, <code>median</code>, <code>quantile</code>, <code>cdf</code>, and <code>pmf</code>.</h2>

<h3>Description</h3>

<p>Compute ensemble model outputs by summarizing component model outputs for
each combination of model task, output type, and output type id. Supported
output types include <code>mean</code>, <code>median</code>, <code>quantile</code>, <code>cdf</code>, and <code>pmf</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simple_ensemble(
  model_out_tbl,
  weights = NULL,
  weights_col_name = "weight",
  agg_fun = mean,
  agg_args = list(),
  model_id = "hub-ensemble",
  task_id_cols = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model_out_tbl</code></td>
<td>
<p>an object of class <code>model_out_tbl</code> with component
model outputs (e.g., predictions).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>data.frame</code> with component model weights. If
provided, it should have a column named <code>model_id</code> and a column containing
model weights. Optionally, it may contain additional columns corresponding
to task id variables, <code>output_type</code>, or <code>output_type_id</code>, if weights are
specific to values of those variables. The default is <code>NULL</code>, in which case
an equally-weighted ensemble is calculated. Should be prevalidated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_col_name</code></td>
<td>
<p><code>character</code> string naming the column in <code>weights</code>
with model weights. Defaults to <code>"weight"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_fun</code></td>
<td>
<p>a function or character string name of a function to use for
aggregating component model outputs into the ensemble outputs. See the
details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_args</code></td>
<td>
<p>a named list of any additional arguments that will be passed
to <code>agg_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_id</code></td>
<td>
<p><code>character</code> string with the identifier to use for the
ensemble model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>task_id_cols</code></td>
<td>
<p><code>character</code> vector with names of columns in
<code>model_out_tbl</code> that specify modeling tasks. Defaults to <code>NULL</code>, in which
case all columns in <code>model_out_tbl</code> other than <code>"model_id"</code>, <code>"output_type"</code>,
<code>"output_type_id"</code>, and <code>"value"</code> are used as task ids.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default for <code>agg_fun</code> is <code>"mean"</code>, in which case the ensemble's
output is the average of the component model outputs within each group
defined by a combination of values in the task id columns, output type, and
output type id. The provided <code>agg_fun</code> should have an argument <code>x</code> for the
vector of numeric values to summarize, and for weighted methods, an
argument <code>w</code> with a numeric vector of weights. If it desired to use an
aggregation function that does not accept these arguments, a wrapper
would need to be written. For weighted methods, <code>agg_fun = "mean"</code> and
<code>agg_fun = "median"</code> are translated to use <code>matrixStats::weightedMean</code> and
<code>matrixStats::weightedMedian</code> respectively. For <code>matrixStats::weightedMedian</code>,
the argument <code>interpolate</code> is automatically set to FALSE to circumvent a
calculation issue that results in invalid distributions.
</p>


<h3>Value</h3>

<p>a <code>model_out_tbl</code> object of ensemble predictions. Note that
any additional columns in the input <code>model_out_tbl</code> are dropped.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate a weighted median in two ways
data(model_outputs)
data(fweights)

weighted_median1 &lt;- simple_ensemble(model_outputs, weights = fweights,
                                    agg_fun = stats::median)
weighted_median2 &lt;- simple_ensemble(model_outputs, weights = fweights,
                                     agg_fun = matrixStats::weightedMedian)
all.equal(weighted_median1, weighted_median2)

</code></pre>


</div>