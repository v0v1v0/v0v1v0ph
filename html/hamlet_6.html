<div class="container">

<table style="width: 100%;"><tr>
<td>hmap.key</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add a color key to a plot-region based heatmap built with 'hmap'
</h2>

<h3>Description</h3>

<p>A continuous color scale key for a heatmap. By default the key is constructed according to the 'h'-object which is invisibly returned by the original 'hmap'-call. Some customization may be supplied to position the legend or to customize ticks and style.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmap.key(h, x0 = h$leftlim[1], x1 = h$leftlim[2], y0 =
                 h$toplim[1], y1 = h$toplim[2], xlim = range(h$valseq),
                 ratio = 0.5, tick = 0.1, at = seq(from =
                 min(h$valseq), to = max(h$valseq), length.out = 5),
                 bty = "c", cex = 0.5, pos = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>The list of heatmap parameters returned invisibly by the original 'hmap'-call.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>

<p>Coordinates for the color key; left border
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>

<p>Coordinates for the color key; right border
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>

<p>Coordinates for the color key; lower border
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>

<p>Coordinates for the color key; upper border
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Value range for the x-axis within the key itself, by default extracted from the h-object
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>

<p>Ratio between y-axis coordinates to separate the key box to upper color key box and lower tick and values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick</code></td>
<td>

<p>The vertical length in value ticks
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>

<p>The values in color key at which to plot ticks and the values at ticks
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>

<p>Type of box to plot around the color key
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>The zooming factor for plotting the text and other objects affected by the 'cex' parameter in 'par'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>

<p>The text alignment and position parameter given to the 'text' function in the key
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Teemu Daniel Laajala &lt;teelaa@utu.fi&gt;
</p>


<h3>See Also</h3>

<p><code>heatmap</code>
<code>hmap</code>
<code>hmap.annotate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some data
set.seed(1)
r1 &lt;- replicate(30, rnorm(20))
lab &lt;- sample(letters[1:2], 20, replace=TRUE)
r1[lab==lab[1],] &lt;- r1[lab==lab[1],] + 2
r2a &lt;- replicate(10, rnorm(10))
r2b &lt;- replicate(10, rnorm(10))

# Set up a new plot region, notice we have a 2-fold wider x-axis
plot.new()
plot.window(xlim=c(0,2), ylim=c(0,1))

# Plot an example plot along with the color key and annotations for our 'lab' vector
h1 &lt;- hmap(r1, add = TRUE)
hmap.key(h1, x1=0.18)
hmap.annotate(h1, rw = lab, rw.wid=c(0.82,0.90))

# Plot the rest to show how the coordinates are adjusted to place the heatmap(s) differently
h2a &lt;- hmap(r2a, add = TRUE, xlim=c(1.2, 1.8), leftlim=c(1.0, 1.2), 
	rightlim=c(1.8,2.0), ylim=c(0.6, 1.0), bottomlim=c(0.5,0.6), Colv=NA)
h2b &lt;- hmap(r2b, add = TRUE, xlim=c(1.2, 1.8), leftlim=c(1.0, 1.2), 
	rightlim=c(1.8,2.0), ylim=c(0.1, 0.5), bottomlim=c(0.0,0.1), Colv=NA)

# Show the normal plot region axes 
axis(1, at=c(0.5,1.5), c("A", "B"))

</code></pre>


</div>