<div class="container">

<table style="width: 100%;"><tr>
<td>icsPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of Marginal Proportion for Clustered Data</h2>

<h3>Description</h3>

<p>Function to visualize informative cluster size. Plots within-cluster summary statistic from
quantitative variables against the size of each cluster. For categorical variables, a barplot of
category proportions for quantiles of cluster size is produced.
</p>


<h3>Usage</h3>

<pre><code class="language-R">icsPlot(
  x,
  id,
  FUN = c("mean", "median", "var", "sd", "range", "IQR", "prop"),
  breaks,
  xlab = NULL,
  ylab = NULL,
  legend = c(TRUE, FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of data values. Alternatively a two-dimensional table or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector which identifies the clusters, with length equal to length of <code>x</code>; ignored if <code>x</code> is a matrix or table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>the name of the function that produces the desired intra-cluster summary statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a single number giving the number of desired quantiles for the barplot of categorical variables with &gt;2 categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis, defaults to "cluster size".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of <code>FUN</code> of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a logical indicating whether a legend should be included in a barplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> is a matrix or table and <code>x</code> has exactly two columns, the first column should contain the cluster
sizes and the second column the respective intra-cluster summary statistic (e.g., mean, variance) that will be plotted
against cluster size.
</p>
<p>If <code>x</code> has more than two columns, the first column is assumed to contain the cluster size
and the subsequent columns the counts of intra-cluster observations belonging to the different categorical variable levels.
If there are exactly two categorical levels (e.g., <code>x</code> has exactly three columns), a scatterplot of the proportion of
intracluster observations belonging to the first category will be plotted against the cluster size. If the number of
categories is &gt; 2, a barplot of category proportions against quantiles of cluster size is produced.
</p>
<p>Standard graphical parameters can be passed to <code>icsPlot</code> through the <code>...</code> argument.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(screen8)
## VECTOR INPUT
## plot average math score by cluster size
icsPlot(x = screen8$math, id = screen8$sch.id, pch = 20)

## plot proportion of females by cluster size
icsPlot(screen8$gender, screen8$sch.id, pch = 20, main = "Female proportion by cluster size")

## barchart of activity proportion by quartile of cluster size
icsPlot(x = screen8$activity, id = screen8$sch.id)

## TABLE INPUT
## Plot intra-cluster variance of math score by cluster size
cl.size &lt;- as.numeric(table(screen8$sch.id))
tab1 &lt;- cbind(cl.size, aggregate(screen8$math, list(screen8$sch.id), var)[,2])
colnames(tab1) &lt;- c("cl.size", "variance")
icsPlot(x = tab1, pch = 17, main = "math score variance by cluster size")

## barchart of activity proportion across five quantiles of cluster size
tab2 &lt;- cbind(cl.size, table(screen8$sch.id, screen8$activity))
icsPlot(tab2, breaks = 5)

</code></pre>


</div>