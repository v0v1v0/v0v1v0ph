<div class="container">

<table style="width: 100%;"><tr>
<td>ivregimes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of regime models with endogenous variables</h2>

<h3>Description</h3>

<p>The function <code>ivregimes</code> deals with
the estimation of regime models.
Most of the times the variable identifying the regimes
reveals some spatial aspects of the data (e.g., administrative boundaries).
The model includes exogenous as well as endogenous
variables among the regressors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ivregimes(formula, data, rgv = NULL, vc = c("homoskedastic", "robust", "OGMM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x_f | x_v | h_f | h_v</code> where <code>y</code> is the dependent variable, <code>x_f</code> are the regressors that do not vary by regimes,  <code>x_v</code> are the regressors that vary by regimes, <code>h_f</code> are the fixed instruments and <code>h_v</code> are the instruments that vary by regimes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rgv</code></td>
<td>
<p>an object of class <code>formula</code> to identify the regime variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc</code></td>
<td>
<p>one of <code>c("homoskedastic", "robust", "OGMM")</code>. If <code>"OGMM"</code> an optimal weighted GMM is used to estimate the VC matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The basic (non spatial) model with endogenous variables
can be written in a general way as:
</p>
<p style="text-align: center;"><code class="reqn">
y
=
\begin{bmatrix}
X_1&amp; 0 \\
0 &amp; X_2 \\
\end{bmatrix}
\begin{bmatrix}
\beta_1 \\
\beta_2 \\
\end{bmatrix}
+ X\beta +
\begin{bmatrix}
Y_1&amp; 0 \\
0 &amp; Y_2 \\
\end{bmatrix}
\begin{bmatrix}
\pi_1 \\
\pi_2 \\
\end{bmatrix}
+ Y\pi +
 \varepsilon
</code>
</p>

<p>where  <code class="reqn">y = [y_1^\prime,y_2^\prime]^\prime</code>,
and the <code class="reqn">n_1 \times 1</code> vector <code class="reqn">y_1</code> contains the observations
on the dependent variable for the first regime,
and the <code class="reqn">n_2 \times 1</code> vector <code class="reqn">y_2</code> (with <code class="reqn">n_1 + n_2 = n</code>)
contains the observations on the dependent variable for the second regime.
The <code class="reqn">n_1 \times k</code> matrix <code class="reqn">X_1</code> and the <code class="reqn">n_2 \times k</code>
matrix <code class="reqn">X_2</code> are blocks of a block diagonal matrix,
the vectors of parameters  <code class="reqn">\beta_1</code> and <code class="reqn">\beta_2</code> have
dimension <code class="reqn">k_1 \times 1</code> and <code class="reqn">k_2 \times 1</code>, respectively,
<code class="reqn">X</code> is the <code class="reqn">n \times p</code> matrix of regressors that do not vary by regime,
<code class="reqn">\beta</code>  is a <code class="reqn">p\times 1</code> vector of parameters.
The three matrices <code class="reqn">Y_1</code> (<code class="reqn">n_1 \times q</code>),
<code class="reqn">Y_2</code> (<code class="reqn">n_2 \times q</code>) and <code class="reqn">Y</code> (<code class="reqn">n \times r</code>)
with corresponding vectors of parameters <code class="reqn">\pi_1</code>, <code class="reqn">\pi_2</code> and <code class="reqn">\pi</code>,
contain the endogenous variables.
Finally, <code class="reqn">\varepsilon = [\varepsilon_1^\prime,\varepsilon_2^\prime]^\prime</code>
is the <code class="reqn">n\times 1</code> vector of innovations.
The model is estimated by two stage least square.
In particular:
</p>

<ul>
<li>
<p> If <code>vc = "homoskedastic"</code>,
the variance-covariance matrix is estimated by <code class="reqn">\sigma^2(\hat Z^\prime \hat Z)^{-1}</code>,
where <code class="reqn">\hat Z= PZ</code>,  <code class="reqn">P= H(H^\prime H)^{-1}H^\prime</code>, <code class="reqn">H</code> is the matrix of instruments,
and <code class="reqn">Z</code> is the matrix of all exogenous and endogenous variables in the model.
</p>
</li>
<li>
<p> If <code>vc = "robust"</code>, the variance-covariance matrix is estimated by
<code class="reqn">(\hat Z^\prime \hat Z)^{-1}(\hat Z^\prime \hat\Sigma \hat Z) (\hat Z^\prime \hat Z)^{-1}</code>,
where <code class="reqn">\hat\Sigma</code> is a diagonal matrix with diagonal elements <code class="reqn">\hat\sigma_i</code>,
for <code class="reqn">i=1,...,n</code>.
</p>
</li>
<li>
<p> Finally, if <code>vc = "OGMM"</code>, the model is estimated in two steps.
In the first step, the model is estimated by 2SLS yielding
the residuals <code class="reqn">\hat \varepsilon</code>.
With the residuals, the diagonal matrix <code class="reqn">\hat \Sigma</code> is estimated and is
used to construct the matrix <code class="reqn">\hat S = H^\prime \hat \Sigma H</code>.
Then <code class="reqn">\eta_{OWGMM}=(Z^\prime H\hat S^{-1}H^\prime Z)^{-1}Z^\prime H\hat S^{-1}H^\prime y</code>, where <code class="reqn">\eta_{OWGMM}</code>
is the vector of all the parameters in the model,
The variance-covariance matrix is: <code class="reqn">n(Z^\prime H\hat S^{-1}H^\prime Z)^{-1}</code>.</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of class <code>ivregimes</code>. A <code>list</code> of five elements. The first element of the list contains the estimation results. The other elements are needed for printing the results.
</p>


<h3>Author(s)</h3>

<p>Gianfranco Piras and Mauricio Sarrias
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("natreg")
form   &lt;- HR90  ~ 0 | MA90 + PS90 + RD90 + UE90 | 0 | MA90 + PS90 + RD90 + FH90 + FP89 + GI89
split  &lt;- ~ REGIONS
mod &lt;- ivregimes(formula = form, data = natreg, rgv = split, vc = "robust")
summary(mod)
mod1 &lt;- ivregimes(formula = form, data = natreg, rgv = split, vc = "OGMM")
summary(mod1)
form1   &lt;- HR90  ~ MA90 + PS90 |  RD90 + UE90 -1 | MA90 + PS90 | RD90 + FH90 + FP89 + GI89 -1
mod2 &lt;- ivregimes(formula = form1, data = natreg, rgv = split, vc = "homoskedastic")
summary(mod2)

</code></pre>


</div>