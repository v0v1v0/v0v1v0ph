<div class="container">

<table style="width: 100%;"><tr>
<td>boot_hopit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrapping hopit model</h2>

<h3>Description</h3>

<p><code>boot_hopit</code> performs the bootstrap of a function dependent on a fitted model.
In each of the bootstrap repetitions, a set of new model coefficients is drawn from the multivariate normal distribution,
assuming the originally estimated model coefficients (see <code>coef.hopit</code>)
as a mean and using the model variance-covariance matrix (see <code>vcov.hopit</code>).
The drawn coefficients are then used to calculate the measure of interest using a function delivered by the <code>func</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot_hopit(
  model,
  func,
  data = model$frame,
  nboot = 500,
  unlist = TRUE,
  boot.only.latent = TRUE,
  parallel.flag = FALSE,
  parallel.nb_cores = NULL,
  parallel.packages = NULL,
  parallel.variables = NULL,
  robust.vcov,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted <code>hopit</code> model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>a function to be bootstrapped of the form <code>func(model, ...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>a number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unlist</code></td>
<td>
<p>a logical indicating whether to unlist the boot object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.only.latent</code></td>
<td>
<p>a logical indicating whether to perform the bootstrap on latent variables only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.flag</code></td>
<td>
<p>a logical if to use parallel computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.nb_cores</code></td>
<td>
<p>number of cores (&lt;= number of CPU cores on the current host).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.packages</code></td>
<td>
<p>list of packages needed to run "func".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.variables</code></td>
<td>
<p>list of global variables and functions needed to run "func".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust.vcov</code></td>
<td>
<p>see <code>vcov.hopit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to the <code>func</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with bootstrapped elements.
</p>


<h3>Author(s)</h3>

<p>Maciej J. Danko
</p>


<h3>See Also</h3>

<p><code>percentile_CI</code>, <code>getLevels</code>, <code>getCutPoints</code>, <code>latentIndex</code>, <code>standardiseCoef</code>, <code>hopit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# DATA
data(healthsurvey)

# the order of response levels decreases from the best health to
# the worst health; hence the hopit() parameter decreasing.levels
# is set to TRUE
levels(healthsurvey$health)

# fit a model
model1 &lt;- hopit(latent.formula = health ~ hypertension + high_cholesterol +
                heart_attack_or_stroke + poor_mobility + very_poor_grip +
                depression + respiratory_problems +
                IADL_problems + obese + diabetes + other_diseases,
              thresh.formula = ~ sex + ageclass + country,
              decreasing.levels = TRUE,
              control = list(trace = FALSE),
              data = healthsurvey)

# Example 1 ---------------------
# bootstrapping cut-points

# a function to be bootstrapped
cutpoints &lt;-  function(model) getCutPoints(model)$cutpoints
B &lt;- boot_hopit(model = model1, func = cutpoints, nboot = 100)

# calculate lower and upper bounds using the percentile method
cutpoints.CI &lt;- percentile_CI(B)

# print estimated cutpoints and their confidence intervals
cutpoints(model1)
cutpoints.CI

# Example 2 ---------------------
# bootstrapping differences in health levels

# a function to be bootstrapped
diff_BadHealth &lt;- function(model) {
  hl &lt;- getLevels(model = model, formula=~ sex + ageclass, sep=' ')
  hl$original[,1] + hl$original[,2] - hl$adjusted[,1]- hl$adjusted[,2]
}

# estimate the difference
est.org &lt;- diff_BadHealth(model = model1)

# perform the bootstrap
B &lt;- boot_hopit(model = model1, func = diff_BadHealth, nboot = 100)

# calculate lower and upper bounds using the percentile method
est.CI &lt;- percentile_CI(B)

# plot the difference and its (asymmetrical) confidence intervals
pmar &lt;- par('mar'); par(mar = c(9.5,pmar[2:4]))
m &lt;- max(abs(est.CI))
pos &lt;- barplot(est.org, names.arg = names(est.org), las = 3,
               ylab = 'Original - Adjusted',
               ylim=c(-m, m), density = 20, angle = c(45, -45),
               col = c('blue', 'orange'))
for (k in seq_along(pos)) lines(c(pos[k,1],pos[k,1]),
                                est.CI[,k], lwd = 2, col = 2)
abline(h = 0); box(); par(mar = pmar)

</code></pre>


</div>