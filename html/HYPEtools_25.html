<div class="container">

<table style="width: 100%;"><tr>
<td>CreateOptpar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an optpar list</h2>

<h3>Description</h3>

<p><code>CreateOptpar</code> creates a list representing a HYPE optpar.txt file from an imported par.txt file
and a selection of parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CreateOptpar(
  x,
  pars,
  tasks = data.frame(character(), character()),
  comment = "",
  fun.ival = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with named vector elements, as an object returned from <code>ReadPar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>Character vector with HYPE parameter names to be included in optpar list. Parameters must
exist in <code>x</code>. Not case-sensitive. For a complete list of HYPE parameters, see the
<a href="http://hype.smhi.net//wiki/doku.php?id=start:hype_file_reference:par.txt">par.txt online documentation</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tasks</code></td>
<td>
<p>Data frame with two columns providing optimization tasks and settings (key-value pairs) as
described in the
<a href="http://hype.smhi.net//wiki/doku.php?id=start:hype_file_reference:optpar.txt">optpar.txt online documentation</a>.
Defaults to an empty task section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comment</code></td>
<td>
<p>Character string, comment (first row in optpar.txt file).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun.ival</code></td>
<td>
<p>Either <code>NULL</code> (default), or a function with a single argument. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CreateOptpar</code> makes it a bit more convenient to compose a HYPE optimization file. The function creates a template
with all parameters to be included in an optimization run.
</p>
<p>Parameter boundaries for individual classes have to be adapted after creation of the template, the function takes the
existing parameter value(s) in <code>x</code> as upper and lower boundaries.
</p>
<p>Parameter step width intervals (third parameter rows in optpar.txt files) are calculated with an internal function
which per default returns the nearest single 1/1000th of the parameter value, with conditional replacement of '0' intervals:
</p>
<pre>function(x) {
  res &lt;- 10^floor(log10(x/1000))
  ifelse(res == 0, .1, res)
}</pre>
<p>Alternative functions can be passed to <code>CreateOptpar</code> using argument <code>fun.ival</code>. Such functions must have a
single argument <code>x</code>, which represents the parameter value taken from argument <code>x</code>. The function is applied to
all parameters in the resulting optpar list.
</p>


<h3>Value</h3>

<p>The function returns a list with elements as described in <code>ReadOptpar</code>.
</p>


<h3>See Also</h3>

<p><code>ReadOptpar</code> <code>WriteOptpar</code> <code>OptimisedClasses</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Import a HYPE parameter file
te1 &lt;- ReadPar(filename = system.file("demo_model", "par.txt", package = "HYPEtools"))
# Create optimization parameters for a Monte Carlo run with 1000 iterations
te2 &lt;- data.frame(key = c("task", "num_mc", "task"), value = c("MC", 1000, "WS"))
# Create an optpar file structure for HYPE recession coefficients
te3 &lt;- CreateOptpar(x = te1, pars = c("rrcs1", "rrcs2"), tasks = te2)
te3

</code></pre>


</div>