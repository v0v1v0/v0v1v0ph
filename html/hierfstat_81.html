<div class="container">

<table style="width: 100%;"><tr>
<td>varcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates variance components for each allele of a locus</h2>

<h3>Description</h3>

<p>Estimates variance components for each allele for a (fully) hierarchical random design defined by all but the last column of the data frame  <kbd>data</kbd>, the last column containing the genetic data to analyse. Columns for the hierarchical design should be given from the outermost to the innermost before the individual (e.g. continent, region, population, patch,...)</p>


<h3>Usage</h3>

<pre><code class="language-R">varcomp(data,diploid=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame that contains the different factors from the outermost (e.g. region)
to the innermost before the individual. the last column of the data frame 'data' contains the locus to analyse, which can be multiallelic. Missing data are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diploid</code></td>
<td>
<p>a boolean stating whether the data come from diploid (TRUE=default) or haploid (FALSE) organisms</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The format for genotypes is simply the code for the 2 alleles put one behind the other, without space in between. For instance if allele 1 at the locus has code <kbd>23</kbd> and allele 2 <kbd>39</kbd>, the genotype format is <kbd>2339</kbd>. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom for each level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the k matrix, the coefficients associated with the variance components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>the variance components for each allele</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overall</code></td>
<td>
<p>the variance components summed over alleles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>a matrix of hierarchical F-statistics type-coefficients
with the first line corresponding to <code class="reqn">F_{(n-1)/n}</code>,<code class="reqn">F_{(n-2)/n}</code>...<code class="reqn">F_{i/n}</code> and
the diagonal corresponding to <code class="reqn">F_{(n-1)/n}</code>, <code class="reqn">F_{(n-2)/(n-1)}</code>,<code class="reqn">F_{i/2}</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jerome Goudet,
DEE, UNIL, 
CH-1015
Lausanne
Switzerland 
</p>
<p><a href="mailto:jerome.goudet@unil.ch">jerome.goudet@unil.ch</a>
</p>
<p><a href="http://www.unil.ch/popgen/people/jerome.htm">http://www.unil.ch/popgen/people/jerome.htm</a>
</p>


<h3>References</h3>

<p>Goudet J. (2005). Hierfstat, a package for R to compute and test variance components and F-statistics. Molecular Ecology Notes. 5:184-186
</p>
<p>Weir, B.S. (1996) Genetic Data Analysis II. Sinauer Associates.
</p>
<p>Yang, R.C. (1998). Estimating hierarchical F-statistics. Evolution 52(4):950-956
</p>


<h3>See Also</h3>

<p><code>varcomp.glob</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">#load data set
data(gtrunchier)
attach(gtrunchier)
#
varcomp(data.frame(Locality,Patch,L21.V))
</code></pre>


</div>