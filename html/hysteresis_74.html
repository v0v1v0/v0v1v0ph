<div class="container">

<table style="width: 100%;"><tr>
<td>floop.repeated</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Methods for easily fitting multiple loops from repeated measures designs.
</h2>

<h3>Description</h3>

<p>Fit a sinusoidal hysteretic process between an input and an output variable across multiple loops separated by subjects and repeated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">floop.repeated(x,y=NULL,m=1,n=1,subjects=NULL,repeated=NULL,
subjects.in="all",repeated.in="all",...)
floop2r.repeated(x,y=NULL,m=1,n=1,subjects=NULL,repeated=NULL,
subjects.in="all",repeated.in="all",...)
## S3 method for class 'fittedlooplist'
summary(object,N=1000,boot=TRUE,seed=NULL,...)
## S3 method for class 'fittedlooplist2r'
summary(object,N=1000,boot=TRUE,seed=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric input vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>numeric output vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>positive integer. Loop shape parameter, see <code>loop.parameters</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>positive odd integer. Loop bulging parameter, see <code>loop.parameters</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjects</code></td>
<td>

<p>factor of the same length as x that represents experimental units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated</code></td>
<td>

<p>factor of the same length as x that represents the repeated measure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjects.in</code></td>
<td>

<p>a vector of characters, the levels of <code>subjects</code> to be included. Default is "all".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated.in</code></td>
<td>

<p>a vector of characters, the levels of <code>repeated</code> to be included. Default is "all".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an <code>fittedlooplist</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>number of bootstrap replicates. See <code>summary.fittedloop</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>

<p>whether or not bootstrapping should be performed. See <code>summary.fittedloop</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>for generating random numbers. See <code>summary.fittedloop</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>extra arguments to either  <code>floop</code> or <code>summary.fittedloop</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits multiple loops with one call, separated by the factors <code>subjects</code> and <code>repeated</code>. The arguments <code>subjects.in</code> and <code>repeated.in</code> are used to select subsets of the factors <code>subjects</code> and <code>repeated</code>.
</p>


<h3>Value</h3>

<p><code>floop.repeated</code> returns an object of class <code>fittedlooplist</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>Separate model fits for each loop, see <code>floop</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimates</code></td>
<td>
<p>Parameter estimates for all loops in matrix form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Std.Errors</code></td>
<td>
<p>Delta standard errors for all loops in matrix form.</p>
</td>
</tr>
</table>
<p>When <code>boot=TRUE</code> <code>floop.repeated</code> returns an object of class <code>loopsummarylist</code> which consists of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>Separate model summaries for each ellipse, see <code>summary.fittedloop</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Bootstrapped parameter estimates, standard errors, quantiles, and more for each loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boot.Estimates</code></td>
<td>
<p>Bootstrapped parameter estimates with reduced bias.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boot.Std.Errors</code></td>
<td>
<p>Standard errors provided by bootstrapping.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Spencer Maynes, Fan Yang, and Anne Parkhurst.
</p>


<h3>References</h3>

<p>Yang, F. and A. Parkhurst, Efficient Estimation of Elliptical Hysteresis (submitted)
</p>


<h3>See Also</h3>

<p><code>floop</code> and <code>summary.fittedloop</code>, also  <code>fel.repeated</code> and <code>summary.ellipsefitlist</code>. Also <code>residuals.fittedlooplist</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HysteresisData)
loopmodels.rep &lt;- floop.repeated(HysteresisData$X, HysteresisData$Y,
n=5,m=3, subjects = HysteresisData$subjects,subjects.in=c("A","C"),
repeated=HysteresisData$repeated)
loopmodels.rep                #Gives estimates and delta standard errors
loopmodels.rep$Estimates      #List estimates only
loopmodels.rep$Std.Errors     #List delta standard errors

par(mfrow=c(2,2))
plot(loopmodels.rep,main='Simulated Rep Loops',values="hysteresis")
par(mfrow=c(1,1))

loopmodels.rep$models["A",1]       #Select one subject, one replication

### Bootstrap estimates and standard errors (Seed is necessary if want to reproduce results)
boot.rep.loop=floop.repeated(HysteresisData$X, HysteresisData$Y,
n=5,m=3, subjects = HysteresisData$subjects,subjects.in=c("A","C"),
repeated=HysteresisData$repeated,boot=TRUE,seed=123)
boot.rep.loop                 #Gives boot estimates, boot bias, boot SE and boot quartiles
boot.rep.loop$Boot.Estimates  #Lists boot estimates
boot.rep.loop$Boot.Std.Errors #Gives boot standard errors 

par(mfrow=c(2,2))
plot(boot.rep.loop, main='Simulated Rep Boot Loops', values="hysteresis")
par(mfrow=c(1,1))

##Can write results to a file. First set your directory from the file tab.
## Change file path in command below to coincide with where you want to store data files
##setwd("C:/Users/..........................")
##write.table(boot.rep.loop$Boot.Estimates,"Hys.eg.repbootvalues.txt")
##test.floop=read.table("Hys.eg.repbootvalues.txt",header=TRUE)
##head(test.floop)
</code></pre>


</div>