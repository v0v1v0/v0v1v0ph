<div class="container">

<table style="width: 100%;"><tr>
<td>HDBRR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
High Dimensional Bayesian Ridge Regression without MCMC.
</h2>

<h3>Description</h3>

<p>Ridge regression provide biased estimators of the regression parameters with lower variance. The HDBRR ("High Dimensional Bayesian Ridge Regression") function fits Bayesian Ridge regression without MCMC, this one uses the SVD or QR decomposition for the posterior computation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HDBRR(y, X, n0 = 5, p0 = 5, s20 = NULL, d20 = NULL, h = 0.5,
    intercept = TRUE, vpapp = TRUE,npts = NULL,c = NULL,
    corpred = NULL, method = c("svd","qr"),bigmat = TRUE, ncores = 2, svdx = NULL)

## S3 method for class 'HDBRR'
summary(object, all.coef = FALSE, crit = log(4), ...)

## S3 method for class 'HDBRR'
plot(x, crit = log(4), var_select = FALSE, post = FALSE, ...)

## S3 method for class 'HDBRR'
predict(object,  ...)

## S3 method for class 'summary.HDBRR'
print(x, ...)

## S3 method for class 'HDBRR'
print(x, ...)

## S3 method for class 'HDBRR'
coef(object, all = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The data vector (numeric, n) NAs allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Design Matrix of dimension <code>n x p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0,p0</code></td>
<td>

<p><code>n0/2</code> and <code>p0/2</code> are the shape parameter of the Gamma Inverse prior assigned to the residual variance and the shape parameter of the Gamma Inverse prior assigned to the Beta's variance respectively. The default value for <code>n0/2</code> and <code>p0/2</code> parameter is 5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s20,d20</code></td>
<td>

<p><code>(n0s20)/2</code> and <code>(p0d20)/2</code> are the scale parameter of the Gamma Inverse prior assigned to the residual variance and the scale parameter of the Gamma Inverse prior assigned to the Beta's variance respectively. The default value for the <code>s20</code> and <code>d20</code> is <code>NULL</code>. If the scale is not specified a value is calculated with <code>h</code> and quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>(numeric, 0&lt;<code>h</code>&lt;1) shrinkage factor. Only used if the hyper-parameters are not specified; If h -&gt; 0 then we have greater shrinkage, this is, <code class="reqn">\beta</code> -&gt; 0. If h -&gt; 1 then we have less shrinkage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>Logic value. The default value for the <code>intercept</code> is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpapp</code></td>
<td>

<p>Logic value. Compute an approximation of the predictive variance. The default value for the <code>vpapp</code> is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npts</code></td>
<td>

<p>Number (integer) of points used to evaluate the u's density for the numeric aprroach. The default value for the <code>npts</code> parameter is 200.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>

<p>ratio of Gaussian densities (Spike/Slab) in the prior mixture density of each Beta for variable selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corpred</code></td>
<td>

<p>The method for the compute of the correlation, there are two methods, Empirical Bayes (<code>"eb"</code>) and Bayesian (<code>"b"</code>) method. The default value for the parameter corpred is NULL. If the values is NULL then the corr and edf values will be NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Options for the posterior computation. There are two methods available: <code>"qr"</code> decomposition of <code>X*t(X)</code> and <code>"svd"</code> decomposition of matrix <code>X</code>. The default value for the method is SVD decomposition.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bigmat</code></td>
<td>

<p>Use of the bigstatsr package. The default value for <code>bigmat</code> is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>

<p>Number of the cores for computation. The default value for the ncores is 2, you can detect your number of cores with <code>detectCores()</code> and use it (iOS and Linux).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A HDBRR object, typically generated by a call to <code>HDBRR</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.coef</code></td>
<td>

<p>Logical. Should results be returned for all ridge regression penalty
parameters (<code>all.coef = TRUE</code>), or only  those whose <code>log(bayes factor)&gt;crit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>

<p>Numerical. The lower bound of the log Bayes factor in favour to include a variable in the model. The default value for <code>crit</code> is <code>log(4)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to or from other methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A HDBRR object, typically generated by a call to <code>HDBRR</code> (for the
<code>print.HDBRR</code> and <code>plot.HDBRR</code> functions) or an object of class
<code>summary.HDBRR</code> (for the <code>print.summary.HDBRR</code>
function).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_select</code></td>
<td>

<p>Logical. If is TRUE a plot with variable selection is returned. The default value is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>

<p>Logical. If is TRUE a plot with marginal posterior of u is returned. The default value is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>

<p>Logical. All coefficients are returned. If is FALSE, then, if <code>p &gt; 250</code> only 250 coefficients are returned. The default value es FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svdx</code></td>
<td>

<p>It is possible to add the svd. The default value es NULL.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Ridge regression is a useful tool to deal with colinerity in the homocesastic linear regression model providing biased estimators of the regression parameters with lower variance than the least square estimators.
The model </p>
<p style="text-align: center;"><code class="reqn">y = X\beta + \epsilon</code>
</p>
<p> where <code class="reqn">\epsilon</code> vector is assumed Normal with mean vector 0 and covariance matrix <code class="reqn">\sigma^2 I_n</code>. For further details see the vignettes in the package.
</p>


<h3>Value</h3>

<p>List containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betahat</code></td>
<td>

<p>Vector (numeric, <code>p</code>)  with the betas estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>

<p>Vector (numeric, <code>n</code>) with the y's estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdyhat</code></td>
<td>

<p>Vector (numeric, <code>n</code>) with the standard deviation of the predicts values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdpred</code></td>
<td>

<p>Vector (numeric, <code>n</code>) with the standard deviation of predict variances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varb</code></td>
<td>

<p>Vector (numeric, <code>p</code>) with the beta's variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigsqhat</code></td>
<td>

<p>Value (numeric) of the residual variance estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigbsqhat</code></td>
<td>

<p>Value (numeric) of the Beta's variance estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>Vector (numeric, <code>npts</code>) with the u's values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postu</code></td>
<td>

<p>Vector (numeric, <code>npts</code>) with the values of the u posterior.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uhat</code></td>
<td>

<p>Value (numeric) of u estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umode</code></td>
<td>

<p>Value (numeric) of the posterior mode of u.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichNa</code></td>
<td>

<p>Value (integer) of NAs in the y vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phat</code></td>
<td>

<p>Vector (numeric, <code>p</code>), selection probability of x_i.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>Used in the variable selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edf</code></td>
<td>

<p>Value (numeric) of the effective degrees of freedom for regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>

<p>Vector (numeric, <code>n</code>) of the correlation between <code>y_i</code> estimates and <code>y_i</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svdx</code></td>
<td>

<p>The svd decomposition.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sergio Perez-Elizalde, Blanca E. Monroy-Castillo, Paulino Perez-Rodriguez, Jose Crossa.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

data("phenowheat")
mod &lt;- lmer(pheno$HD~pheno$env+(1|pheno$Line))
y &lt;- unlist(ranef(mod))
n &lt;- length(y)
X &lt;- scale(X, scale=F)
fitall &lt;- HDBRR(y,X/sqrt(ncol(X)),intercept = FALSE, corpred = "eb", c = 100)
fitall
sumarry(fitall, crit = 0)
plot(fitall, crit = 0)
predict(fitall)


## End(Not run)
</code></pre>


</div>