<div class="container">

<table style="width: 100%;"><tr>
<td>hotelling.stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Hotelling's two sample T-squared test statistic</h2>

<h3>Description</h3>

<p>Calculate Hotelling's T-squared test statistic for the difference in two
multivariate means.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hotelling.stat(x, y, shrinkage = FALSE, var.equal = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a nx by p matrix containing the data points from sample 1 or a list containing elements <code>mean</code>, <code>cov</code>, and <code>n</code> where
<code>mean</code> is a mean vector of length p, <code>cov</code> is a variance-covariance matrix of dimension p by p, and <code>n</code> is the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a ny by p matrix containg the data points from sample 2  or a list containing elements <code>mean</code>, <code>cov</code>, and <code>n</code> where
<code>mean</code> is a mean vector of length p, <code>cov</code> is a variance-covariance matrix of dimension p by p, and <code>n</code> is the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>set to <code>TRUE</code> if the covariance matrices are to be estimated using Schaefer and Strimmer's James-Stein 
shrinkage estimator. Note this only works when raw data is supplied, and will 
not work if summary statistics are supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p>set to <code>TRUE</code> if the covariance matrices are (assumed to be) equal</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note, the sample size requirements are that nx + ny - 1 &gt; p. The procedure
will stop if this is not met and the shrinkage estimator is not being used.
The shrinkage estimator has not been rigorously tested for this application
(small p, smaller n).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Hotelling's (unscaled) T-squared statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The
scaling factor - this can be used by by multiplying it with the test
statistic, or dividing the critical F value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a vector of length
containing the numerator and denominator degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>The
sample size of sample 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>The sample size of sample 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The
number of variables to be used in the comparison</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James M. Curran
</p>
<p>Taylor Hersh
</p>


<h3>References</h3>

<p>Hotelling, H. (1931). “The generalization of Student's ratio.”
Annals of Mathematical Statistics 2 (3): 360–378.
</p>
<p>Schaefer, J., and K. Strimmer (2005). “A shrinkage approach to large-scale
covariance matrix estimation and implications for functional genomics.”
Statist. Appl. Genet. Mol. Biol. 4: 32.
</p>
<p>Opgen-Rhein, R., and K. Strimmer (2007). “Accurate ranking of
differentially expressed genes by a distribution-free shrinkage approach.”
Statist. Appl. Genet. Mol. Biol. 6: 9.
</p>
<p>NEL, D.G. and VAN DER MERWE, C.A. (1986). “A solution to the -
multivariate Behrens-Fisher problem.”
Comm. Statist. Theor.- Meth., A15, 12, 3719-3736.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(container.df)
split.data = split(container.df[,-1],container.df$gp)
x = split.data[[1]]
y = split.data[[2]]
hotelling.stat(x, y)
hotelling.stat(x, y, TRUE)

</code></pre>


</div>