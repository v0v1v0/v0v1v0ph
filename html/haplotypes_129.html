<div class="container">

<table style="width: 100%;"><tr>
<td>pieplot-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots pie charts on statistical parsimony network</h2>

<h3>Description</h3>

<p>Plotting pie charts on the statistical parsimony network.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Parsimnet,Haplotype'
pieplot(x,y,net=1,factors, coord = NULL,inter.labels=FALSE,interactive=FALSE,rex=1,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a <code>Parsimnet</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> a <code>Haplotype</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>net</code></td>
<td>
<p>a numeric vector of length one indicating which network to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>a vector or factor giving the grouping variable (populations, species, etc.), with one element per individual. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>a matrix that contains user specified coordinates of the vertices, or NULL to  generate vertex layouts with <code>network.layout</code> function from package <span class="pkg">network</span>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inter.labels</code></td>
<td>
<p>boolean; should vertex labels of intermediate haplotypes be displayed? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>boolean; should vertices be interactively adjusted? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rex</code></td>
<td>
<p> expansion factor for the pie radius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments to be passed to <code>floating.pie</code> and others. See ‘Details’ </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method calls <code>floating.pie</code> <code>{plotrix}</code>, <code>network.vertex</code> <code>{network}</code>, and <code>plot.default</code>, <code>lines</code>, and <code>text</code>  <code>{graphics}</code>. This method also uses some internal structures of <code>plot.network.default</code> from package <span class="pkg">network</span>. The following additional arguments can be passed to these functions: 
</p>

<dl>
<dt>mode</dt>
<dd>
<p> the vertex placement algorithm. Default is set to <code>"fruchtermanreingold"</code>. </p>
</dd>
<dt>pad</dt>
<dd>
<p> amount to pad the plotting range; useful if labels are being clipped. Default is set to 1.</p>
</dd>
<dt>displaylabels</dt>
<dd>
<p>boolean; should vertex labels be displayed? </p>
</dd>
<dt>label</dt>
<dd>
<p> a vector of vertex labels. By default, the rownames of the distance matrix (<code>rownames(p@d[[net]])</code>) are used. If <code>inter.labels==FALSE</code> only haplotype labels are displayed. </p>
</dd>
<dt>label.cex</dt>
<dd>
<p> character expansion factor for labels. Default is set to 0.75.</p>
</dd>
<dt>label.col</dt>
<dd>
<p> an integer or character vector for the label colors. By default, it is 1 (black). </p>
</dd>
<dt>label.pos</dt>
<dd>
<p> position at which labels should be placed relative to vertices. 0 and 6 results in labels which are placed away from the center of the plotting region; 1, 2, 3, and 4 result in labels being placed below, to the left of, above, and to the right of vertices, respectively; and label.pos 5 or greater than 6 results in labels which are plotted with no offset (i.e., at the vertex positions). Default is set to 0.</p>
</dd>
<dt>label.pad</dt>
<dd>
<p> amount to pad the labels. This setting is available only if the labels are plotted with offset relative to vertex positions. Default is set to 1.</p>
</dd>
<dt>vertex.cex</dt>
<dd>
<p> a numeric vector of expansion factor for intermediate vertices (only). By default it is <code>(0.5)*min(radius)</code>. Use 'radius' to specify size of pie charts. </p>
</dd>
<dt>col</dt>
<dd>
<p> the colors of the pie sectors (i.e., colors for populations), by default <code>rainbow</code>. </p>
</dd>
<dt>vertex.col</dt>
<dd>
<p> an integer or character vector for the intermediate vertex colors. By default, it is 1 (black). </p>
</dd>
<dt>edge.col</dt>
<dd>
<p> an integer or character vector for the edge colors. By default, it is 1 (black). </p>
</dd>
<dt>edge.lwd</dt>
<dd>
<p> a numeric vector, edges line width. By default, it is 1. </p>
</dd>
<dt>edge.lty</dt>
<dd>
<p> a numeric vector of length one, specifies the line type for the edges. By default it is 1. </p>
</dd>
<dt>edges</dt>
<dd>
<p> the number of lines forming a pie circle, By default, it is 200. </p>
</dd>
<dt>radius</dt>
<dd>
<p> a numeric vector of length <code>p@nhap[net]</code> for the radius of drawn pie charts. Useful for specifying the radius independent of the haplotype frequencies. Default is <code>(0.8*(haplotype frequencies)*rex)/max(haplotype frequencies)</code>. </p>
</dd>
<dt>vertex.sides</dt>
<dd>
<p> number of polygon sides for vertices. Default is set to 50. </p>
</dd>
<dt>xlab</dt>
<dd>
<p>x axis label. </p>
</dd>
<dt>xlab</dt>
<dd>
<p>y axis label. </p>
</dd>
</dl>
<h3>Value</h3>

<p>A two-column matrix containing the vertex positions as x,y coordinates.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "Parsimnet", y = "Haplotype")</code></dt>
<dd>
</dd>
</dl>
<h3>Note</h3>

 
<p>Some internal structures of <code>plot.network.default</code> is taken from package <span class="pkg">network</span> with modifications, author Carter T. Butts.
</p>


<h3>Author(s)</h3>

<p>Caner Aktas, <a href="mailto:caktas.aca@gmail.com">caktas.aca@gmail.com</a>. 
</p>


<h3>See Also</h3>

<p><code>plot,Parsimnet-method</code>,<code>floating.pie</code>, <code>plot.default</code> and <code>plot.network.default</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("dna.obj")
x&lt;-dna.obj
h&lt;-haplotypes::haplotype(x)

### Statistical parsimony with 95% connection limit 
p&lt;-parsimnet(x) 

#randomly generated populations
pop&lt;-c("pop1","pop2","pop3","pop4","pop5","pop6","pop7","pop8")
set.seed(5)
pops&lt;-sample(pop,nrow(x),replace=TRUE)

## Plotting with default parameters.
pieplot(p,h,1, pops)

## Change colors for the populations.
#8 colors for 8 populations 
cols&lt;-colors()[c(30,369,552,558,538,642,142,91)]
pieplot(p,h,1, pops,col=cols)

## Expanding pie charts and intermediate vertices.
pieplot(p,h,1, pops,rex=2)

## Adjusting intermediate vertex sizes.
pieplot(p,h,1, pops, vertex.cex=rep(0.2, nrow(p@d[[1]])-p@nhap))

## Expanding pie charts and intermediate vertices, adjusting intermediate vertex sizes.
pieplot(p,h,1, pops,rex=2, vertex.cex=rep(0.1, nrow(p@d[[1]])-p@nhap))

## Adjusting radius of pie charts.
pieplot(p,h,1, pops,radius=rep(1, p@nhap))

## Not run:  
## Interactively adjusting vertex positions.
pieplot(p,h,1, pops, interactive=TRUE)

## End(Not run)

### Multiple networks with 99% connection limit.
p&lt;-parsimnet(x,prob=.99) 

## Plotting first network with default parameters.
pieplot(p,h,1, pops)

## Change colors for the populations.
#8 colors for 8 populations
cols&lt;-colors()[c(30,369,552,558,538,642,142,91)]
pieplot(p,h,1, pops,col=cols)







</code></pre>


</div>