<div class="container">

<table style="width: 100%;"><tr>
<td>cpval_aSPU</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Permutation-And-Asymptotics-Based p-values of the SPU and aSPU Tests
</h2>

<h3>Description</h3>

<p>Calculates p-values of the sum-of-powers (SPU) and adaptive SPU (aSPU) tests based on the combination of permutation method and asymptotic distributions of the test statistics (Xu et al, 2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpval_aSPU(sam1, sam2, pow = c(1:6, Inf), n.iter = 1000, seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>

<p>a numeric vector indicating the candidate powers <code class="reqn">\gamma</code> in the SPU tests. It should contain <code>Inf</code> and both odd and even integers. The default is <code>c(1:6, Inf)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation iterations for calculating the means, variances, covariances of SPU test statistics' asymptotic distributions. The default is 1,000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeds</code></td>
<td>

<p>a vector of seeds for each permutation iteration; this is optional.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the covariances of the two sample populations are <code class="reqn">\Sigma_1 = (\sigma_{1, ij})</code> and <code class="reqn">\Sigma_2 = (\sigma_{2, ij})</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. For a vector <code class="reqn">v</code>, we denote <code class="reqn">v^{(i)}</code> as its <code class="reqn">i</code>th element.
</p>
<p>For any <code class="reqn">1 \le \gamma &lt; \infty</code>, the sum-of-powers (SPU) test statistic is defined as:
</p>
<p style="text-align: center;"><code class="reqn">L(\gamma) = \sum_{i = 1}^{p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^\gamma.</code>
</p>

<p>For <code class="reqn">\gamma = \infty</code>,
</p>
<p style="text-align: center;"><code class="reqn">L (\infty) = \max_{i = 1, \ldots, p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2/(\sigma_{1,ii}/n_1 + \sigma_{2,ii}/n_2).</code>
</p>

<p>The adaptive SPU (aSPU) test combines the SPU tests and improve the test power:
</p>
<p style="text-align: center;"><code class="reqn">T_{aSPU} = \min_{\gamma \in \Gamma} P_{SPU(\gamma)},</code>
</p>

<p>where <code class="reqn">P_{SPU(\gamma)}</code> is the p-value of SPU(<code class="reqn">\gamma</code>) test, and <code class="reqn">\Gamma</code> is a candidate set of <code class="reqn">\gamma</code>'s. Note that <code class="reqn">T_{aSPU}</code> is no longer a genuine p-value.
</p>
<p>The asymptotic properties of the SPU and aSPU tests are studied in Xu et al (2016). When using the theoretical means, variances, and covarainces of <code class="reqn">L (\gamma)</code> to calculate the p-values of SPU and aSPU tests (<code class="reqn">1 \le \gamma &lt; \infty</code>), the high-dimensional covariance matrix of the samples needs to be consistently estimated; such estimation is usually time-consuming.
</p>
<p>Alternatively, assuming that the two sample groups have same covariance, the permutation method can be applied to efficiently estimate the means, variances, and covarainces of <code class="reqn">L (\gamma)</code>'s asymptotic distributions, which then yield the p-values of SPU and aSPU tests based on the combination of permutation method and asymptotic distributions.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>

<p>the powers <code class="reqn">\gamma</code> used for the SPU tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spu.stat</code></td>
<td>

<p>the observed SPU test statistics.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spu.e</code></td>
<td>

<p>the asymptotic means of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spu.var</code></td>
<td>

<p>the asymptotic variances of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spu.corr.odd</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with odd <code class="reqn">\gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spu.corr.even</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with even <code class="reqn">\gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this reminders users that <code>cpval_aSPU()</code> assumes that the two sample groups have same covariance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>

<p>the p-values of the SPU tests and the aSPU test.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The permutation technique assumes that the distributions of the two sample populations are the same under the null hypothesis.
</p>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). "Regularized estimation of large covariance matrices." <em>The Annals of Statistics</em>, <b>36</b>(1), 199–227.
</p>
<p>Pan W, Kim J, Zhang Y, Shen X, and Wei P (2014). "A powerful and adaptive association test for rare variants." <em>Genetics</em>, <b>197</b>(4), 1081–1095.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Xu G, Lin L, Wei P, and Pan W (2016). "An adaptive two-sample test for high-dimensional means." <em>Biometrika</em>, <b>103</b>(3), 609–624.
</p>


<h3>See Also</h3>

<p><code>apval_aSPU</code>, <code>epval_aSPU</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
cpval_aSPU(sam1, sam2, n.iter = 100)
</code></pre>


</div>