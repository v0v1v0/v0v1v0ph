<div class="container">

<table style="width: 100%;"><tr>
<td>R.main.estimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimates the proportion of treatment effect explained by the surrogate marker as a function of a baseline covariate</h2>

<h3>Description</h3>

<p>Assesses heterogeneity in the utility of a surrogate marker with respect to a baseline covariate using censored (survival data) by estimates the proportion of treatment effect explained by the surrogate marker as a function of a baseline covariate, w </p>


<h3>Usage</h3>

<pre><code class="language-R">R.main.estimate(xone, xzero, deltaone, deltazero, sone, szero, wone, wzero, w.grd, myt, 
landmark, type = "cont", var = FALSE, test = FALSE, extrapolate = TRUE, h.0 = NULL, 
h.1 = NULL, h.w = NULL, h.s = NULL, h.w.1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xone</code></td>
<td>

<p>x1, observed event time in the treated group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xzero</code></td>
<td>

<p>x0, observed event time in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaone</code></td>
<td>

<p>delta1, event indicator in the treated group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltazero</code></td>
<td>

<p>delta0, event indicator in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sone</code></td>
<td>

<p>s1, surrogate marker in the treated group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>szero</code></td>
<td>

<p>s0, surrogate marker in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wone</code></td>
<td>

<p>w1, baseline covariate in the treated group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wzero</code></td>
<td>

<p>w0, baseline covariate in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.grd</code></td>
<td>

<p>grid for w where estimation will be provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myt</code></td>
<td>

<p>t of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>landmark</code></td>
<td>

<p>t0, landmark time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>options are "cont" or "discrete"; type of baseline covariate, default is "cont"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>

<p>TRUE or FALSE, if variance/standard error estimates are wanted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>TRUE or FALSE, if test for heterogeneity is wanted wanted
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolate</code></td>
<td>

<p>TRUE or FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.0</code></td>
<td>

<p>bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.1</code></td>
<td>

<p>bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.w</code></td>
<td>

<p>bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.s</code></td>
<td>

<p>bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.w.1</code></td>
<td>

<p>bandwidth</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>w.values</code></td>
<td>
<p>grid for w where estimation is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.s.w</code></td>
<td>
<p>The propoportion of treatment effect explained as a function of the baseline covariate, w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.w</code></td>
<td>
<p>The treatment effect as a function of the baseline covariate, w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.s.w</code></td>
<td>
<p>The residual treatment effect as a function of the baseline covariate, w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.R</code></td>
<td>
<p>Standard error estimate of R.s.w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.delta</code></td>
<td>
<p>Standard error estimate of delta.w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.delta.s</code></td>
<td>
<p>Standard error estimate of delta.s.w</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.omnibus</code></td>
<td>
<p>p-value from the omnibus test for heterogeneity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.con</code></td>
<td>
<p>p-value from the conservative omnibus test for heterogeneity</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, Cai, T. (2024) "Assessing Heterogeneity in Surrogacy Using Censored Data." Statistics in Medicine, 43(17): 3184-3209.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(example.data)
	names(example.data)
	R.main.estimate(xone=example.data$x1, xzero=example.data$x0, deltaone=example.data$d1, 
	deltazero=example.data$d0, sone=log(example.data$s1), szero=log(example.data$s0), 
	wone=log(example.data$w1), wzero=log(example.data$w0), 
	w.grd=log(seq(0.1,0.9, length=25)), myt=1, landmark=0.5)
	R.main.estimate(xone=example.data$x1, xzero=example.data$x0, deltaone=example.data$d1, 
	deltazero=example.data$d0, sone=log(example.data$s1), szero=log(example.data$s0), 
	wone=example.data$w1_cat, wzero=example.data$w0_cat, 
	myt=1, landmark=0.5,type = "discrete", w.grd = c(1,2,3,4))
	#computationally intensive
	
	R.main.estimate(xone=example.data$x1, xzero=example.data$x0, deltaone=example.data$d1,
	deltazero=example.data$d0, sone=log(example.data$s1), szero=log(example.data$s0), 
	wone=log(example.data$w1), wzero=log(example.data$w0), 
	w.grd=log(seq(0.1,0.9, length=25)), myt=1, landmark=0.5, test=TRUE)
	
</code></pre>


</div>