<div class="container">

<table style="width: 100%;"><tr>
<td>Hyperbolic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hyperbolic Distribution</h2>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and
random number generation for the hyperbolic distribution
with parameter vector <code>Theta</code>. Utility routines are included for
the derivative of the density function and to find suitable break
points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dhyperb(x, Theta, KNu = NULL, logPars = FALSE)
phyperb(q, Theta, small = 10^(-6), tiny = 10^(-10),
        deriv = 0.3, subdivisions = 100, accuracy = FALSE, ...)
qhyperb(p, Theta, small = 10^(-6), tiny = 10^(-10),
        deriv = 0.3, nInterpol = 100, subdivisions = 100, ...)
rhyperb(n, Theta)
ddhyperb(x, Theta, KNu = NULL, ...)
hyperbBreaks(Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>Parameter vector taking the form <code>c(pi,zeta,delta,mu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KNu</code></td>
<td>
<p>Sets the value of the Bessel function in the density or
derivative of the density. See <b>Details</b></p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>logPars</code></td>
<td>
<p>Logical; if <code>TRUE</code> the second and third components
of Theta are taken to be log(zeta) and log(delta) respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small</code></td>
<td>
<p>Size of a small difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tiny</code></td>
<td>
<p>Size of a tiny difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>Value between 0 and 1. Determines the point where the
derivative becomes substantial, compared to its maximum value. See
<b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>Uses accuracy calculated by <code>integrate</code>
to try and determine the accuracy of the distribution function
calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density returning the distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInterpol</code></td>
<td>
<p>The number of points used in qhyperb for cubic spline
interpolation (see <code>splinefun</code>) of the distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.  See <b>Details</b>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hyperbolic distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{2\delta\sqrt{1+\pi^2}K_1(\zeta)} %
    e^{-\zeta[\sqrt{1+\pi^2}\sqrt{1+(\frac{x-\mu}{\delta})^2}-%
    \pi\frac{x-\mu}{\delta}]}</code>
</p>

<p>where <code class="reqn">K_1()</code> is the modified Bessel function of the
third kind with order 1.
</p>
<p>A succinct description of the hyperbolic distribution is given in
Barndorff-Nielsen and Blæsild (1983). Three different
possible parameterisations are described in that paper. A fourth
parameterization is given in Prause (1999). All use location and scale
parameters <code class="reqn">\mu</code> and <code class="reqn">\delta</code>. There are two other
parameters in each case.
</p>
<p>Use <code>hyperbChangePars</code> to convert from the
<code class="reqn">(\alpha,\beta)</code> <code class="reqn">(\phi,\gamma)</code> or
<code class="reqn">(\xi,\chi)</code> parameterisations to the
<code class="reqn">(\pi,\zeta)</code> parameterisation used above.
</p>
<p><code>phyperb</code> breaks the real line into eight regions in order to
determine the integral of <code>dhyperb</code>. The break points determining
the regions are found by <code>hyperbBreaks</code>, based on the values of
<code>small</code>, <code>tiny</code>, and <code>deriv</code>. In the extreme tails of
the distribution where the probability is <code>tiny</code> according to
<code>hyperbCalcRange</code>, the probability is taken to be zero. In the
range between where the probability is <code>tiny</code> and <code>small</code>
according to <code>hyperbCalcRange</code>, an exponential approximation to
the hyperbolic distribution is used. In the inner part of the
distribution, the range is divided in 4 regions, 2 above the mode, and
2 below. On each side of the mode, the break point which forms the 2
regions is where the derivative of the density function is
<code>deriv</code> times the maximum value of the derivative on that side of
the mode. In each of the 4 inner regions the numerical integration routine
<code>safeIntegrate</code> (which is a wrapper for
<code>integrate</code>) is used to integrate the density <code>dhyperb</code>.
</p>
<p><code>qhyperb</code> uses the breakup of the real line into the same 8
regions as <code>phyperb</code>. For quantiles which fall in the 2 extreme
regions, the quantile is returned as <code>-Inf</code> or <code>Inf</code> as
appropriate. In the range between where the probability is <code>tiny</code>
and <code>small</code> according to <code>hyperbCalcRange</code>, an exponential
approximation to the hyperbolic distribution is used from which the
quantile may be found in closed form. In the 4 inner regions
<code>splinefun</code> is used to fit values of the distribution function
generated by <code>phyperb</code>.  The quantiles are then found
using the <code>uniroot</code> function.
</p>
<p><code>phyperb</code> and <code>qhyperb</code> may generally be expected to be
accurate to 5 decimal places.
</p>
<p>The hyperbolic distribution is a special case of the generalized
hyperbolic distribution (Barndorff-Nielsen and Blæsild
(1983)). The generalized hyperbolic distribution can be represented as
a particular mixture of the normal distribution where the mixing
distribution is the generalized inverse Gaussian.  <code>rhyperb</code> uses
this representation to generate observations from the hyperbolic
distribution. Generalized inverse Gaussian observations are obtained
via the algorithm of Dagpunar (1989).  </p>


<h3>Value</h3>

<p><code>dhyperb</code> gives the density, <code>phyperb</code> gives the distribution
function, <code>qhyperb</code> gives the quantile function and <code>rhyperb</code>
generates random variates. An estimate of the accuracy of the
approximation to the distribution function may be found by setting
<code>accuracy = TRUE</code> in the call to <code>phyperb</code> which then returns
a list with components <code>value</code> and <code>error</code>.
</p>
<p><code>ddhyperb</code> gives the derivative of <code>dhyperb</code>.
</p>
<p><code>hyperbBreaks</code> returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xTiny</code></td>
<td>
<p>Value such that probability to the left is less than
<code>tiny</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xSmall</code></td>
<td>
<p>Value such that probability to the left is less than
<code>small</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowBreak</code></td>
<td>
<p>Point to the left of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highBreak</code></td>
<td>
<p>Point to the right of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xLarge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>small</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xHuge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>tiny</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeDist</code></td>
<td>
<p>The mode of the given hyperbolic distribution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Ai-Wei Lee, Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700–707. New York: Wiley.
</p>
<p>Dagpunar, J.S. (1989).
An easily implemented generalized inverse Gaussian generator
<em>Commun. Statist. -Simula.</em>,
<b>18</b>, 703–710.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code>safeIntegrate</code>, <code>integrate</code> for its
shortfalls, <code>splinefun</code>, <code>uniroot</code> and
<code>hyperbChangePars</code> for changing parameters to the
<code class="reqn">(\pi,\zeta)</code> parameterisation, <code>dghyp</code> for
the generalized hyperbolic distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Theta &lt;- c(2,1,1,0)
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-3))
par(mfrow = c(1,2))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(phyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Distribution Function of the\n Hyperbolic Distribution")
dataVector &lt;- rhyperb(500, Theta)
curve(dhyperb(x, Theta), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram\n of the Hyperbolic Distribution")
logHist(dataVector, main =
        "Log-Density and Log-Histogram\n of the Hyperbolic Distribution")
curve(log(dhyperb(x, Theta)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2,1))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(ddhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Derivative of the Density\n of the Hyperbolic Distribution")
par(mfrow = c(1,1))
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-6))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
bks &lt;- hyperbBreaks(Theta)
abline(v = bks)
</code></pre>


</div>