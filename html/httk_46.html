<div class="container">

<table style="width: 100%;"><tr>
<td>calc_mc_tk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct multiple TK simulations using Monte Carlo</h2>

<h3>Description</h3>

<p>This function finds the analytical steady state plasma concentration(from
calc_analytic_css) using a monte carlo simulation (monte_carlo).
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_mc_tk(
  chem.cas = NULL,
  chem.name = NULL,
  dtxsid = NULL,
  parameters = NULL,
  samples = 1000,
  species = "Human",
  suppress.messages = FALSE,
  model = "pbtk",
  httkpop = TRUE,
  httkpop.dt = NULL,
  invitrouv = TRUE,
  calcrb2p = TRUE,
  censored.params = list(),
  vary.params = list(),
  return.samples = FALSE,
  tissue = NULL,
  output.units = "mg/L",
  solvemodel.arg.list = list(times = c(0, 0.25, 0.5, 0.75, 1, 1.5, 2, 2.5, 3, 4, 5)),
  Caco2.options = list(),
  invitro.mc.arg.list = NULL,
  httkpop.generate.arg.list = list(method = "direct resampling"),
  convert.httkpop.arg.list = NULL,
  parameterize.arg.list = NULL,
  return.all.sims = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chem.cas</code></td>
<td>
<p>Either the CAS number, parameters, or the chemical name must
be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chem.name</code></td>
<td>
<p>Either the chemical parameters, name, or the CAS number
must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtxsid</code></td>
<td>
<p>EPA's DSSTox Structure ID (<a href="https://comptox.epa.gov/dashboard">https://comptox.epa.gov/dashboard</a>)
the chemical must be identified by either CAS, name, or DTXSIDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Parameters from parameterize_steadystate. Not used with
httkpop model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Number of samples generated in calculating quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Species desired (either "Rat", "Rabbit", "Dog", "Mouse", or
default "Human").  Species must be set to "Human" to run httkpop model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.messages</code></td>
<td>
<p>Whether or not to suppress output message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model used in calculation: 'pbtk' for the multiple compartment
model,'3compartment' for the three compartment model, '3compartmentss' for
the three compartment steady state model, and '1compartment' for one
compartment model.  This only applies when httkpop=TRUE and species="Human",
otherwise '3compartmentss' is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>httkpop</code></td>
<td>
<p>Whether or not to use population generator and sampler from
httkpop.  This is overwrites censored.params and vary.params and is only for
human physiology.  Species must also be set to 'Human'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>httkpop.dt</code></td>
<td>
<p>A data table generated by <code>httkpop_generate</code>.
This defaults to NULL, in which case <code>httkpop_generate</code> is 
called to generate this table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invitrouv</code></td>
<td>
<p>Logical to indicate whether to include in vitro parameters
in uncertainty and variability analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcrb2p</code></td>
<td>
<p>Logical determining whether or not to recalculate the 
chemical ratio of blood to plasma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored.params</code></td>
<td>
<p>The parameters listed in censored.params are sampled
from a normal distribution that is censored for values less than the limit
of detection (specified separately for each parameter). This argument should
be a list of sub-lists. Each sublist is named for a parameter in
"parameters" and contains two elements: "CV" (coefficient of variation) and
"LOD" (limit of detection, below which parameter values are censored. New
values are sampled with mean equal to the value in "parameters" and standard
deviation equal to the mean times the CV.  Censored values are sampled on a
uniform distribution between 0 and the limit of detection. Not used with
httkpop model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vary.params</code></td>
<td>
<p>The parameters listed in vary.params are sampled from a
normal distribution that is truncated at zero. This argument should be a
list of coefficients of variation (CV) for the normal distribution. Each
entry in the list is named for a parameter in "parameters". New values are
sampled with mean equal to the value in "parameters" and standard deviation
equal to the mean times the CV. Not used with httkpop model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.samples</code></td>
<td>
<p>Whether or not to return the vector containing the
samples from the simulation instead of the selected quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tissue</code></td>
<td>
<p>Desired steady state tissue conentration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.units</code></td>
<td>
<p>Plasma concentration units, either uM or default mg/L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solvemodel.arg.list</code></td>
<td>
<p>Additional arguments ultimately passed to 
<code>solve_model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Caco2.options</code></td>
<td>
<p>A list of options to use when working with Caco2 apical to
basolateral data <code>Caco2.Pab</code>, default is Caco2.options = list(Caco2.default = 2,
Caco2.Fabs = TRUE, Caco2.Fgut = TRUE, overwrite.invivo = FALSE, keepit100 = FALSE). Caco2.default sets the default value for 
Caco2.Pab if Caco2.Pab is unavailable. Caco2.Fabs = TRUE uses Caco2.Pab to calculate
fabs.oral, otherwise fabs.oral = <code>Fabs</code>. Caco2.Fgut = TRUE uses Caco2.Pab to calculate 
fgut.oral, otherwise fgut.oral = <code>Fgut</code>. overwrite.invivo = TRUE overwrites Fabs and Fgut in vivo values from literature with 
Caco2 derived values if available. keepit100 = TRUE overwrites Fabs and Fgut with 1 (i.e. 100 percent) regardless of other settings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invitro.mc.arg.list</code></td>
<td>
<p>List of additional parameters passed to 
<code>invitro_mc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>httkpop.generate.arg.list</code></td>
<td>
<p>Additional parameters passed to 
<code>httkpop_generate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convert.httkpop.arg.list</code></td>
<td>
<p>Additional parameters passed to the 
convert_httkpop_* function for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterize.arg.list</code></td>
<td>
<p>Additional parameters passed to the 
parameterize_* function for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.all.sims</code></td>
<td>
<p>Logical indicating whether to return the results
of all simulations, in addition to the default toxicokinetic statistics</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Monte Carlo methods used here were recently updated and described by
Breen et al. (submitted).
</p>
<p>All arguments after httkpop only apply if httkpop is set to TRUE and species
to "Human".
</p>
<p>When species is specified as rabbit, dog, or mouse, the function uses the
appropriate physiological data(volumes and flows) but substitues human
fraction unbound, partition coefficients, and intrinsic hepatic clearance.
</p>
<p>Tissue concentrations are calculated for the pbtk model with oral infusion
dosing.  All tissues other than gut, liver, and lung are the product of the
steady state plasma concentration and the tissue to plasma partition
coefficient.
</p>
<p>The six sets of plausible <em>in vitro-in vivo</em> extrpolation (IVIVE)
assumptions identified by Honda et al. (2019) 
(<a href="https://doi.org/10.1371/journal.pone.0217564">doi:10.1371/journal.pone.0217564</a>) 
are: </p>

<table>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: right;"> <em>in vivo</em> Conc. </td>
<td style="text-align: right;"> Metabolic Clearance </td>
<td style="text-align: right;"> Bioactive Chemical
Conc. </td>
<td style="text-align: right;"> TK Statistic Used* </td>
</tr>
<tr>
<td style="text-align: left;"> Honda1 </td>
<td style="text-align: right;"> Veinous (Plasma) </td>
<td style="text-align: right;">
Restrictive </td>
<td style="text-align: right;"> Free </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda2 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Restrictive </td>
<td style="text-align: right;"> Free </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda3 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda4 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda5 </td>
<td style="text-align: right;"> Target Tissue </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda6 </td>
<td style="text-align: right;"> Target Tissue
</td>
<td style="text-align: right;"> Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
</tr>
</table>
<p> *Assumption is
currently ignored because analytical steady-state solutions are currently
used by this function.
</p>


<h3>Value</h3>

<p>If return.all.sims == FALSE (default) a list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>The mean concentration for each model compartment as a function
of time across the Monte Carlo simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sds</code></td>
<td>
<p>The standard deviation for each model compartment as a function
of time across the Monte Carlo simulation</p>
</td>
</tr>
</table>
<p>If return.all.sums == TRUE then a list is returned with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>The list of means and sds from return.all.sums=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>The concentration vs. time results for each compartment for 
every (samples) set of parameters in the Monte Carlo simulation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>John Wambaugh
</p>


<h3>See Also</h3>

<p><code>create_mc_samples</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

NSAMP &lt;- 50
chemname="Abamectin"
times&lt;- c(0,0.25,0.5,0.75,1,1.5,2,2.5,3,4,5)
age.ranges &lt;- seq(6,80,by=10)
forward &lt;- NULL
for (age.lower in age.ranges)
{
  label &lt;- paste("Ages ",age.lower,"-",age.lower+4,sep="")
  set.seed(1234)
  forward[[label]] &lt;- calc_mc_tk(
                        chem.name=chemname,
                        samples=NSAMP,
                        httkpop.generate.arg.list=list(
                          method="d",
                          agelim_years = c(age.lower, age.lower+9)),
                        solvemodel.arg.list = list(
                          times=times))
}


</code></pre>


</div>