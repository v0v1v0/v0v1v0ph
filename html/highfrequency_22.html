<div class="container">

<table style="width: 100%;"><tr>
<td>HEAVYmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HEAVY model estimation</h2>

<h3>Description</h3>

<p>This function calculates the High frEquency bAsed VolatilitY (HEAVY) model proposed in Shephard and Sheppard (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">HEAVYmodel(data, startingValues = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code>xts</code> object where the first column is a vector of returns 
and the second column is a vector of realized stock market variation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startingValues</code></td>
<td>
<p>a vector of alternative starting values: first three arguments for variance equation and last three arguments for measurement equation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">r_{t}</code> and <code class="reqn">RM_{t}</code> be series of demeaned returns and realized measures of
daily stock price variation. The HEAVY model is a two-component model.
We assume <code class="reqn">r_{t} = h_{t}^{1/2} Z_{t}</code> where <code class="reqn">Z_t</code> is an i.i.d. zero-mean 
and unit-variance innovation term. The dynamics of the HEAVY model are given by
</p>
<p style="text-align: center;"><code class="reqn">
   h_{t} = \omega + \alpha RM_{t-1} + \beta h_{t-1}
 </code>
</p>

<p>and 
</p>
<p style="text-align: center;"><code class="reqn">
   \mu_{t} = \omega_{R} + \alpha_{R} RM_{t-1} + \beta_{R} \mu_{t-1}.
 </code>
</p>

<p>The two equations are estimated separately as mentioned in Shephard and Sheppard (2010).
We report robust standard errors based on the matrix-product of inverted Hessians and
the outer product of gradients.
</p>
<p>Note that we always demean the returns in the data input as we don't include a constant in the mean equation.
</p>


<h3>Value</h3>

<p>The function outputs an object of class <code>HEAVYmodel</code>, a list containing
</p>

<ul>
<li>
<p> coefficients = estimated coefficients.
</p>
</li>
<li>
<p> se = robust standard errors based on inverted Hessian matrix.
</p>
</li>
<li>
<p> residuals = the residuals in the return equation.
</p>
</li>
<li>
<p> llh = the two-component log-likelihood values.
</p>
</li>
<li>
<p> varCondVariances = conditional variances in the variance equation.
</p>
</li>
<li>
<p> RMCondVariances = conditional variances in the RM equation.
</p>
</li>
<li>
<p> data = the input data.
</p>
</li>
</ul>
<p>The class HEAVYmodel has the following methods: plot.HEAVYmodel, predict.HEAVYmodel, 
print.HEAVYmodel, and summary.HEAVYmodel.
</p>


<h3>Author(s)</h3>

<p>Onno Kleen and Emil Sjorup.
</p>


<h3>References</h3>

<p>Shephard, N. and Sheppard, K. (2010). Realising the future: Forecasting with high frequency based volatility (HEAVY) models. Journal of Applied Econometrics 25, 197â€“231.
</p>


<h3>See Also</h3>

<p><code>predict.HEAVYmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Calculate returns in percentages
logReturns &lt;- 100 * makeReturns(SPYRM$CLOSE)[-1]

# Combine both returns and realized measures into one xts
# Due to return calculation, the first observation is missing
dataSPY &lt;- xts::xts(cbind(logReturns, SPYRM$BPV5[-1] * 10000), order.by = SPYRM$DT[-1])

# Fit the HEAVY model
fittedHEAVY &lt;- HEAVYmodel(dataSPY)

# Examine the estimated coefficients and robust standard errors
fittedHEAVY

# Calculate iterative multi-step-ahead forecasts
predict(fittedHEAVY, stepsAhead = 12)

</code></pre>


</div>