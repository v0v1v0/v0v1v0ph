<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap.n2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main heatmap function</h2>

<h3>Description</h3>

<p>This is the main function to be called be end users. It accepts a numeric matrix and draws a heatmap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap.n2(
  x,
  main = "Heatmap",
  ...,
  na.color = "gray80",
  sidebars = NULL,
  picketdata = NULL,
  r.cex = 1,
  c.cex = 1,
  titleheight = lcm(1.2),
  dendroheight = lcm(3),
  dendrowidth = lcm(3),
  labelheight = lcm(1),
  labelwidth = lcm(1),
  picketheight = 0.4,
  sidebarwidth = lcm(1),
  sidebar.cex = 1,
  colorkeylabels = FALSE,
  legendcorner = "bottomleft",
  plot = TRUE,
  factorpalettefn = "Pastel1",
  add.sig = FALSE,
  pv = NULL,
  order_list = TRUE,
  genes2highl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>numeric</code>). Numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>(<code>character</code>). Main plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>prepare_heatmap_data2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.color</code></td>
<td>
<p>(<code>character</code>). Colour code or name used for missing values. Defaults to <code>gray80</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sidebars</code></td>
<td>
<p>(<code>list</code>). List of data frames for each of the four sides of the heatmap ("bottom", "left", "top", "right").
Each column in the data frame represents some statistics or other numerical variable describing the rows or
columns of the data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>picketdata</code></td>
<td>
<p>(<code>data.frame</code> or <code>numeric</code>). Usually a data frame with columns consisting of 0 and 1.
The columns describe categories that the samples (rows in the picketdata) belong to, such as sex or a health stage.
The categories must be binary, so the data frame would for example have two rows, 'female' and 'male',
and the rows (=samples) are coded with 1 (=TRUE) and 0 (=FALSE). See <code>picketPlot</code> for a
description of the general purpose of a picket plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for row labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for column labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titleheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendroheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendrowidth</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute width (using <code>lcm</code>, see <code>layout</code>) of the dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelwidth</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute width (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>picketheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the picket plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sidebarwidth</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute width (using <code>lcm</code>, see <code>layout</code>) of the sidebars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sidebar.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for sidebar labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorkeylabels</code></td>
<td>
<p>(<code>logical</code>). Should colour key labels be added?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendcorner</code></td>
<td>
<p>(<code>character</code>). Position of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>(<code>logical</code>). Draw the plot? Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factorpalettefn</code></td>
<td>
<p>(<code>character</code>). Name of the colour palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.sig</code></td>
<td>
<p>(<code>logical</code>). Should significance asterixes be drawn?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv</code></td>
<td>
<p>(<code>numeric</code>). Matrix of the same dimensions as <code>x</code> with P-Values for correlation significance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_list</code></td>
<td>
<p>(<code>logical</code>). Should the order of the correlation matrix be reversed? Meaningful if the order
of input variables should be preserved because <code>image</code> turns the input matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes2highl</code></td>
<td>
<p>(<code>character</code>). Vector of gene symbols (or whatever labels are used) to be highlighted.
If not <code>NULL</code> will draw a semi-transparent rectangle around the labels and rows or columns in the heatmap
labels.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The result can be used for zooming. For simple basic cases, picketvar can be given directly. Factor
sidebars are supported, but legends are only shown for the first two.
Arguments that will be passed on the <code>prepare_heatmap_data2</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> labRow (<code>character</code>). Custom row labels</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> labCol (<code>character</code>). Custom column labels</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> Rowv (<code>dendrogram</code> or <code>integer</code>). Custom dendrogram object or integer vector giving the ordering index for rows</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> Colv (<code>dendrogram</code> or <code>integer</code>). Custom dendrogram object or integer vector giving the ordering index for columns</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> reorder (<code>logical</code>). Boolean of length 2 for rows and columns. Should rows and/or columns be reordered according to <code>Rowv</code>/<code>Colv</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> distfun (<code>function</code>). Distance function. Defaults to <code>dist</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> hclustfun (<code>function</code>). Hierarchical clustering function. Defaults to <code>hclust</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> rowMembers (<code>character</code>). Group vector to split rows by</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> colMembers (<code>character</code>). Group vector to split columns by</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> spacer (<code>integer</code>). Length 1 integer used as spacer to separate groups (see <code>rowMembers</code>/<code>colMembers</code>). Defaults to 1</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> scale (<code>character</code>). One of "row", "column" or "none": By which dimension should data be scaled? Defaults to "none"</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> trim (<code>numeric</code>). Value to "cut off" data distribution. Values and both ends of the distribution, larger or smaller, respectively, will be made equal to <code>+/-trim</code>. Defaults to <code>NULL</code>, no trimming</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> zlim (<code>numeric</code>). Value to set the ranges for plotting <code>x</code> and <code>y</code> values. Supports both symmetrical (with default <code>NULL</code>) and asymmetrical (<code>NA</code>) automatic <code>zlim.</code> Used for zooming</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> col (<code>character</code>) Name (acronym) of the colour palette to use. Can be one of "RdBkGn" (c("green", "black", "red")), "BuYl" (c("blue", "yellow")), "BuWtRd" (c("blue", "white", "red")) or a valid name used by <code>brewer.pal</code>. Defaults to NULL which will set "RdBkGn"</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> filter (<code>integer</code> or <code>logical</code>.) For filtering rows/columns: TRUE (=1.0) = remove rows/columns with only NAs, 0.5 = remove if &gt;= 50 per cent NAs, etc. Defaults to <code>c(TRUE, TRUE)</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>In addition to its side-effect of plotting the heatmap (if <code>plot</code> is <code>TRUE</code>, which is the default),
the function will invisibly returns the prepared "display list", a <code>list</code> of all parts of the heatmap used by
<code>hlayout()</code> to actually draw the final heatmap.
</p>


<h3>See Also</h3>

<p><code>layout</code>
</p>
<p><code>brewer.pal</code>
</p>
<p><code>colorRampPalette</code>
</p>
<p><code>dist</code>
</p>
<p><code>hclust</code>
</p>
<p><code>picketPlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random 10x10 matrix and plot it using default values
mat &lt;- matrix(rnorm(100), nrow = 10)
heatmap.n2(mat)

# Generate a random 10x10 matrix with two distinct sets, order it using
# default clustering methods, split it into each two groups along both rows
# and columns and adjust colour palette and dendrogram dimensions:
mat &lt;- matrix(c(rnorm(50, mean = 1), rnorm(50, mean = -1)), nrow = 10)
heatmap.n2(mat, col = "BuWtRd", rowMembers=rep(1:2, each=5),
    colMembers=rep(1:2, each=5), labRow=paste0("gene-", 1:10),
    labCol=paste0(c("A", "B"), rep(1:5, 2)), r.cex=0.8,
    dendroheight = lcm(2.2), dendrowidth = lcm(2.4))
</code></pre>


</div>