<div class="container">

<table style="width: 100%;"><tr>
<td>calc_mc_oral_equiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Monte Carlo Oral Equivalent Dose</h2>

<h3>Description</h3>

<p>This function converts a chemical plasma concentration to an oral adminstered
equivalent
dose (AED) using a concentration obtained from <code>calc_mc_css</code>.  
This function uses reverse dosimetry-based 
'<em>in vitro-in vivo</em> extrapolation (IVIVE) 
for high throughput risk screening.  The user can input the
chemical and <em>in vitro</em> bioactive concentration, select the TK
model, and then automatically predict the <em>in vivo</em> AED
which would produce a body concentration equal to
the <em>in vitro</em> bioactive concentration. This function relies on the
Monte Carlo method (via funcion <code>create_mc_samples</code> to simulate
both uncertainty and variability so that the result is a distribution of
equivalent doses, from which we provide specific quantiles
(specified by <code>which.quantile</code>), though the full set of predictions can
be obtained by setting <code>return.samples</code> to <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_mc_oral_equiv(
  conc,
  chem.name = NULL,
  chem.cas = NULL,
  dtxsid = NULL,
  parameters = NULL,
  which.quantile = 0.95,
  species = "Human",
  input.units = "uM",
  output.units = "mgpkgpday",
  suppress.messages = FALSE,
  return.samples = FALSE,
  restrictive.clearance = TRUE,
  bioactive.free.invivo = FALSE,
  tissue = NULL,
  concentration = "plasma",
  IVIVE = NULL,
  model = "3compartmentss",
  Caco2.options = list(),
  calc.analytic.css.arg.list = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Bioactive in vitro concentration in units of uM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chem.name</code></td>
<td>
<p>Either the chemical name or the CAS number must be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chem.cas</code></td>
<td>
<p>Either the CAS number or the chemical name must be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtxsid</code></td>
<td>
<p>EPA's 'DSSTox Structure ID (<a href="https://comptox.epa.gov/dashboard">https://comptox.epa.gov/dashboard</a>)
the chemical must be identified by either CAS, name, or DTXSIDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Parameters from the appropriate parameterization function
for the model indicated by argument model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.quantile</code></td>
<td>
<p>Which quantile from Monte Carlo steady-state
simulation (<code>calc_mc_css</code>) is requested. Can be a vector. Note that 95th
concentration quantile is the same population as the 5th dose quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Species desired (either "Rat", "Rabbit", "Dog", "Mouse", or
default "Human").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input.units</code></td>
<td>
<p>Units of given concentration, default of uM but can also
be mg/L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.units</code></td>
<td>
<p>Units of dose, default of 'mgpkgpday' for mg/kg BW/ day or
'umolpkgpday' for umol/ kg BW/ day.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.messages</code></td>
<td>
<p>Suppress text messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.samples</code></td>
<td>
<p>Whether or not to return the vector containing the
samples from the simulation instead of the selected quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrictive.clearance</code></td>
<td>
<p>Protein binding not taken into account (set to
1) in liver clearance if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bioactive.free.invivo</code></td>
<td>
<p>If FALSE (default), then the total concentration is treated
as bioactive in vivo. If TRUE, the the unbound (free) plasma concentration is treated as 
bioactive in vivo. Only works with tissue = NULL in current implementation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tissue</code></td>
<td>
<p>Desired steady state tissue concentration. Default is of NULL
typically gives whole body plasma concentration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concentration</code></td>
<td>
<p>Desired concentration type: 'blood','tissue', or default 
'plasma'. In the case that the concentration is for plasma, selecting "blood"
will use the blood:plasma ratio to estimate blood concentration. In the case
that the argument 'tissue' specifies a particular tissue of the body, 
concentration defaults to 'tissue' – that is, the concentration in the 
If cocentration is set to 'blood' or 'plasma' and 'tissue' specifies a
specific tissue then the value returned is for the plasma or blood in that
specific tissue.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IVIVE</code></td>
<td>
<p>Honda et al. (2019) identified six plausible sets of
assumptions for <em>in vitro-in vivo</em> extrapolation (IVIVE) assumptions.
Argument may be set to "Honda1" through "Honda6". If used, this function
overwrites the tissue, restrictive.clearance, and bioactive.free.invivo arguments.
See Details below for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model used in calculation,'gas_pbtk' for the gas pbtk model, 
'pbtk' for the multiple compartment model,
'3compartment' for the three compartment model, '3compartmentss' for 
the three compartment steady state model, and '1compartment' for one 
compartment model. This only applies when httkpop=TRUE and species="Human",
otherwise '3compartmentss' is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Caco2.options</code></td>
<td>
<p>A list of options to use when working with Caco2 apical to
basolateral data <code>Caco2.Pab</code>, default is Caco2.options = list(Caco2.Pab.default = 1.6,
Caco2.Fabs = TRUE, Caco2.Fgut = TRUE, overwrite.invivo = FALSE, keepit100 = FALSE). Caco2.Pab.default sets the default value for 
Caco2.Pab if Caco2.Pab is unavailable. Caco2.Fabs = TRUE uses Caco2.Pab to calculate
fabs.oral, otherwise fabs.oral = <code>Fabs</code>. Caco2.Fgut = TRUE uses Caco2.Pab to calculate 
fgut.oral, otherwise fgut.oral = <code>Fgut</code>. overwrite.invivo = TRUE overwrites Fabs and Fgut in vivo values from literature with 
Caco2 derived values if available. keepit100 = TRUE overwrites Fabs and Fgut with 1 (i.e. 100 percent) regardless of other settings.
See <code>get_fbio</code> for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc.analytic.css.arg.list</code></td>
<td>
<p>A list of options to pass to the analytic steady-state calculation function.
This includes 'restrictive.clearance', 'bioactive.free.invivo', 'IVIVE',
'wellstirred.correction', and 'adjusted.Funbound.plasma'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to <code>calc_mc_css</code> for httkpop and
variance of parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The chemical-specific steady-state concentration for a dose rate of 
1 mg/kg body weight/day can be used for in IVIVE of
a bioactive <em>in vitro</em> concentration by dividing the <em>in vitro</em>
concentration
by the steady-state concentration to predict a dose rate (mg/kg/day) that
would produce that concentration in plasma. Using quantiles of the 
distribution (such as the upper 95th percentile) allow incorporation of 
uncertainty and variability into IVIVE.
</p>
<p>This approach relies on thelinearity
of the models to calculate a scaling factor to relate in vitro
concentrations (uM) with AED. The scaling factor is the
inverse of the steady-state plasma concentration (Css) predicted
for a 1 mg/kg/day exposure dose rate
where <em>in vitro</em> concentration [X] and Css must be in the same
units. Note that it is typical for <em>in vitro</em> concentrations to be
reported in units of uM and Css in units of mg/L, in which case
one must be converted to the other. 
</p>
<p>Reverse Dosimetry Toxicodynamic IVIVE
</p>
<p><img src="../help/figures/ivive.png" width="60%" alt="Reverse Dosimetry Toxicodynamic IVIVE"></p>
<p>Figure from Breen et al. (2021) (<a href="https://doi.org/10.1080/17425255.2021.1935867">doi:10.1080/17425255.2021.1935867</a>) shows 
reverse dosimetry toxicodynamic IVIVE. Equivalent external dose is
determined by solving the TK model in reverse by deriving the external dose
(that is, TK model input) that produces a specified internal concentration 
(that is, TK model output). Reverse dosimetry and IVIVE using HTTK relies on 
the linearity of the models. We calculate a scaling factor to relate 
<em>in vitro</em> 
concentrations (uM) to AEDs. The scaling 
factor is the inverse of the Css 
predicted for a 1 mg/kg/day exposure dose rate. We use Monte Carlo to 
simulate variability and propagate uncertainty; for example, to calculate an 
upper 95th percentile Css,95 for individuals who get higher plasma 
concentrations from the same exposure.
</p>
<p>The Monte Carlo methods used here were recently updated and described by
Breen et al. (submitted).
</p>
<p>All arguments after httkpop only apply if httkpop is set to TRUE and species
to "Human".
</p>
<p>When species is specified as rabbit, dog, or mouse, the function uses the
appropriate physiological data(volumes and flows) but substitutes human
fraction unbound, partition coefficients, and intrinsic hepatic clearance.
</p>
<p>Tissue concentrations are calculated for the pbtk model with oral infusion
dosing.  All tissues other than gut, liver, and lung are the product of the
steady state plasma concentration and the tissue to plasma partition
coefficient.
</p>
<p>The six sets of plausible IVIVE
assumptions identified by Honda et al. (2019) 
(<a href="https://doi.org/10.1371/journal.pone.0217564">doi:10.1371/journal.pone.0217564</a>) 
are: </p>

<table>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: right;"> <em>in vivo</em> Conc. </td>
<td style="text-align: right;"> Metabolic Clearance </td>
<td style="text-align: right;"> Bioactive Chemical
Conc. </td>
<td style="text-align: right;"> TK Statistic Used* </td>
</tr>
<tr>
<td style="text-align: left;"> Honda1 </td>
<td style="text-align: right;"> Veinous (Plasma) </td>
<td style="text-align: right;">
Restrictive </td>
<td style="text-align: right;"> Free </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda2 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Restrictive </td>
<td style="text-align: right;"> Free </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda3 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda4 </td>
<td style="text-align: right;"> Veinous </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda5 </td>
<td style="text-align: right;"> Target Tissue </td>
<td style="text-align: right;">
Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Mean Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> Honda6 </td>
<td style="text-align: right;"> Target Tissue
</td>
<td style="text-align: right;"> Non-restrictive </td>
<td style="text-align: right;"> Total </td>
<td style="text-align: right;"> Max Conc. </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
</tr>
</table>
<p> *Assumption is
currently ignored because analytical steady-state solutions are currently
used by this function.
</p>


<h3>Value</h3>

<p>Equivalent dose in specified units, default of mg/kg BW/day.
</p>


<h3>Author(s)</h3>

<p>John Wambaugh
</p>


<h3>References</h3>

<p>Ring CL, Pearce RG, Setzer RW, Wetmore BA, Wambaugh JF (2017).
“Identifying populations sensitive to environmental chemicals by simulating toxicokinetic variability.”
<em>Environment International</em>, <b>106</b>, 105–118. 
</p>
<p>Wetmore BA, Wambaugh JF, Allen B, Ferguson SS, Sochaski MA, Setzer RW, Houck KA, Strope CL, Cantwell K, Judson RS, others (2015).
“Incorporating high-throughput exposure predictions with dosimetry-adjusted in vitro bioactivity to inform chemical toxicity testing.”
<em>Toxicological Sciences</em>, <b>148</b>(1), 121–136.
</p>
<p>Honda GS, Pearce RG, Pham LL, Setzer RW, Wetmore BA, Sipes NS, Gilbert J, Franz B, Thomas RS, Wambaugh JF (2019).
“Using the concordance of in vitro and in vivo data to evaluate extrapolation assumptions.”
<em>PloS one</em>, <b>14</b>(5), e0217564.
</p>
<p>Rowland M, Benet LZ, Graham GG (1973).
“Clearance concepts in pharmacokinetics.”
<em>Journal of pharmacokinetics and biopharmaceutics</em>, <b>1</b>(2), 123–136.
</p>


<h3>See Also</h3>

<p><code>calc_mc_css</code>
</p>
<p><code>create_mc_samples</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Set the number of samples (NSAMP) low for rapid testing, increase NSAMP 
# for more stable results. Default value is 1000:
NSAMP = 10

# Basic in vitro - in vivo extrapolation with httk, convert 0.5 uM in vitro
# concentration of chemical Surinabant to mg/kg/day:
set.seed(1234)
0.5/calc_mc_css(chem.name="Surinabant", samples=NSAMP, output.units="uM")

# The significant digits should give the same answer as:
set.seed(1234)
calc_mc_oral_equiv(chem.name="Surinabant",conc=0.5,samples=NSAMP)  

# Note that we use set.seed to get the same sequence of random numbers for
# the two different function calls (calc_mc_css and calc_mc_oral_equiv)

# The following example should result in an error since we do not 
# estimate tissue partitioning with '3compartmentss'. 
set.seed(1234)                        
try(calc_mc_oral_equiv(0.1, chem.cas="34256-82-1",
                       which.quantile=c(0.05,0.5,0.95),
                       samples=NSAMP,
                       tissue='brain'))
       
set.seed(1234)
calc_mc_oral_equiv(0.1,chem.cas="34256-82-1", model='pbtk',
                   samples=NSAMP,
                   which.quantile=c(0.05,0.5,0.95), tissue='brain')
 
# We can also use the Monte Carlo functions by passing a table
# where each row represents a different Monte Carlo draw of parameters:
p &lt;- create_mc_samples(chem.cas="80-05-7")
# Use data.table for steady-state plasma concentration (Css) Monte Carlo:
calc_mc_css(parameters=p)
# Using the same table gives the same answer:
calc_mc_css(parameters=p)
# Use Css for 1 mg/kg/day for simple reverse toxicokinetics 
# in Vitro-In Vivo Extrapolation to convert 15 uM to mg/kg/day:
15/calc_mc_css(parameters=p, output.units="uM")
# Can do the same with calc_mc_oral_equiv:
calc_mc_oral_equiv(15, parameters=p)


</code></pre>


</div>