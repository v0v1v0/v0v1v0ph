<div class="container">

<table style="width: 100%;"><tr>
<td>mcnemartestClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of Marginal Homogeneity for Clustered Data</h2>

<h3>Description</h3>

<p>Performs a test of marginal homogeneity of paired clustered data with potentially informative
cluster size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcnemartestClust(x, y, id, variance = c("MoM", "emp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>vector or factor objects of equal length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector or factor object which identifies the clusters. The length of <code>id</code> must be the same
as the length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>character string specifying the method of variance estimation. Must be one of "<code>MoM</code>"
or "<code>emp</code>".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null is that the marginal probabilities of being classified into cells <code>[i,j]</code> and
<code>[j,i]</code> are equal.
</p>
<p>Arguments <code>x</code>, <code>y</code>, and <code>id</code> must be vectors or factors of the same length.
Incomplete cases are removed.
</p>
<p>When <code>variance</code> is <code>MoM</code>, a method of moments variance estimate evaluated under the null is used.
This is equivalent to the test by Durkalski <em>et al.</em> (2003). When <code>variance</code> is <code>emp</code>,
an empirical variance estimate is used. See Gregg (2020) for details.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the degrees of freedom of the approximate chi-squared distribution of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the test performed and which variance estimation method was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Durkalski, V., Palesch, Y., Lipsitz, S., Rust, P. (2003). Analysis of clustered matched pair data.
<em>Statistics in Medicine</em>, <b>22</b>, 2417â€“2428.
</p>
<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(screen8)
## Is marginal proportion of students in lowest fitness category
## at the end of year equal to the beginning of year?
screen8$low.start &lt;- 1*(screen8$qfit.s=='Q1')
screen8$low.end &lt;- 1*(screen8$qfit=='Q1')
mcnemartestClust(screen8$low.start, screen8$low.end, screen8$sch.id)

</code></pre>


</div>