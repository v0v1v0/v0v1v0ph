<div class="container">

<table style="width: 100%;"><tr>
<td>fd_hvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate fractal Dimension using the height variation method</h2>

<h3>Description</h3>

<p>Calculate fractal Dimension using the height variation method
</p>


<h3>Usage</h3>

<pre><code class="language-R">fd_hvar(
  data,
  lvec,
  regmethod = "mean",
  keep_data = FALSE,
  plot = FALSE,
  parallel = FALSE,
  ncores = (parallel::detectCores() - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Digital elevation model of class RasterLayer or dataframe (output of hvar function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvec</code></td>
<td>
<p>Vector of scales to use for calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regmethod</code></td>
<td>
<p>Method to use for linear regression between scale (lvec) and height range. One of <code>raw</code> (all data), <code>mean</code> (default) <code>median</code> or <code>ends</code> (minimum and maximum scale only)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_data</code></td>
<td>
<p>Keep the data used for fd calculation? defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. Show plot of scales relative to data?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical. Use parallel processing? Note: parallel must be installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use when parallel = TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates fractal dimension using the height variation regression.
If <code>lvec</code> is not specified, a default based on resolution and extent will be used.
<code>data</code> can be a DEM or a <code>data.frame</code> with columns labeled <code>l</code> and <code>h</code> for
grid cell length and height range of that cell, respectively (output of <code>hvar()</code>).
A rule of thumb is that <code>l</code> should range an order of magnitude.
However, large ranges also
average-out fractal dimension of a surface that might have
phase transitions, and therefore a thorough exploration of height ranges is suggested using the <code>plot</code>.
<code>regmethod</code> specifies whether data is summarized by taking the mean or median of height ranges across scales or all data is used.
<code>regmethod</code> "raw" is not recommended because the regression will give much more weight to the lower scales that include more points and likely underestimate D.
</p>


<h3>Value</h3>

<p>A value for fractal dimension, typically between 2 and 3 or a list if keep_data = TRUE.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

dem &lt;- habtools::dem_crop(horseshoe, x0 = -469, y0 = 1267, L = 2, plot = TRUE)
fd_hvar(dem, lvec = c(0.125, 0.25, 0.5, 1, 2))
fd_hvar(dem, regmethod = "mean", plot = TRUE, keep_data = TRUE)
fd_hvar(dem, regmethod = "median", plot = TRUE, keep_data = TRUE)
fd_hvar(dem)

</code></pre>


</div>