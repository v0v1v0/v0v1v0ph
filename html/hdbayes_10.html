<div class="container">

<table style="width: 100%;"><tr>
<td>glm.leap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior of latent exchangeability prior (LEAP)</h2>

<h3>Description</h3>

<p>Sample from the posterior distribution of a GLM using the latent exchangeability prior (LEAP) by Alt et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.leap(
  formula,
  family,
  data.list,
  K = 2,
  prob.conc = NULL,
  offset.list = NULL,
  beta.mean = NULL,
  beta.sd = NULL,
  disp.mean = NULL,
  disp.sd = NULL,
  iter_warmup = 1000,
  iter_sampling = 1000,
  chains = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a two-sided formula giving the relationship between the response variable and covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an object of class <code>family</code>. See <code>?stats::family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.list</code></td>
<td>
<p>a list of <code>data.frame</code>s. The first element in the list is the current data, and the rest
are the historical data sets. For LEAP implementation, all historical data sets will be
stacked into one historical data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the desired number of classes to identify. Defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.conc</code></td>
<td>
<p>a scalar or a vector of length <code>K</code> giving the concentration parameters for Dirichlet prior.
If length == 2, a <code>Beta(prob.conc[1], prob.conc[2])</code> prior is used. If a scalar is provided,
<code>prob.conc</code> will be a vector of repeated elements of the given scalar. Defaults to a vector of 1s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset.list</code></td>
<td>
<p>a list of matrices giving the offset for current data followed by historical data. For each
matrix, the number of rows corresponds to observations and columns correspond to classes.
Defaults to a list of matrices of 0s. Note that the first element of <code>offset.list</code> (corresponding
to the offset for current data) should be a matrix of repeated columns if <code>offset.list</code> is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.mean</code></td>
<td>
<p>a scalar or a <code style="white-space: pre;">⁠p x K⁠</code> matrix of mean parameters for initial prior on regression coefficients,
where <code>p</code> is the number of regression coefficients (including intercept). If a scalar is provided,
<code>beta.mean</code> will be a matrix of repeated elements of the given scalar. Defaults to a matrix of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.sd</code></td>
<td>
<p>a scalar or a <code style="white-space: pre;">⁠p x K⁠</code> matrix of sd parameters for the initial prior on regression coefficients,
where <code>p</code> is the number of regression coefficients (including intercept). If a scalar is provided,
same as for <code>beta.mean</code>. Defaults to a matrix of 10s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.mean</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of classes (<code>K</code>) giving the location
parameters for the half-normal priors on the dispersion parameters. If a scalar is provided,
<code>disp.mean</code> will be a vector of repeated elements of the given scalar. Defaults to a vector of 0s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.sd</code></td>
<td>
<p>a scalar or a vector whose dimension is equal to the number of classes (<code>K</code>) giving the scale
parameters for the half-normal priors on the dispersion parameters. If a scalar is provided, same
as for <code>disp.mean</code>. Defaults to a vector of 10s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_warmup</code></td>
<td>
<p>number of warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_warmup</code> in
<code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_sampling</code></td>
<td>
<p>number of post-warmup iterations to run per chain. Defaults to 1000. See the argument <code>iter_sampling</code>
in <code>sample()</code> method in cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>number of Markov chains to run. Defaults to 4. See the argument <code>chains</code> in <code>sample()</code> method in
cmdstanr package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>sample()</code> method in cmdstanr package (e.g., <code>seed</code>, <code>refresh</code>, <code>init</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The latent exchangeability prior (LEAP) discounts the historical data by identifying the most relevant individuals
from the historical data. It is equivalent to a prior induced by the posterior of a finite mixture model for the
historical data set.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>draws_df</code> giving posterior samples, with an attribute called 'data' which includes
the list of variables specified in the data block of the Stan program.
</p>


<h3>References</h3>

<p>Alt, E. M., Chang, X., Jiang, X., Liu, Q., Mo, M., Xia, H. M., and Ibrahim, J. G. (2023). LEAP: The latent exchangeability prior for borrowing information from historical data. arXiv preprint.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(actg019)
data(actg036)
# take subset for speed purposes
actg019 = actg019[1:100, ]
actg036 = actg036[1:50, ]
if (instantiate::stan_cmdstan_exists()) {
  glm.leap(
    formula = outcome ~ scale(age) + race + treatment + scale(cd4),
    family = binomial('logit'),
    data.list = list(actg019, actg036),
    K = 2,
    chains = 1, iter_warmup = 500, iter_sampling = 1000
  )
}
</code></pre>


</div>