<div class="container">

<table style="width: 100%;"><tr>
<td>hima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>High-dimensional Mediation Analysis</h2>

<h3>Description</h3>

<p><code>hima</code> is used to estimate and test high-dimensional mediation effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hima(
  X,
  Y,
  M,
  COV.XM = NULL,
  COV.MY = COV.XM,
  Y.family = c("gaussian", "binomial"),
  M.family = c("gaussian", "negbin"),
  penalty = c("MCP", "SCAD", "lasso"),
  topN = NULL,
  parallel = FALSE,
  ncore = 1,
  scale = TRUE,
  Bonfcut = 0.05,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a vector of exposure. Do not use data.frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector of outcome. Can be either continuous or binary (0-1). Do not use data.frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a <code>data.frame</code> or <code>matrix</code> of high-dimensional mediators. Rows represent samples, columns 
represent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COV.XM</code></td>
<td>
<p>a <code>data.frame</code> or <code>matrix</code> of covariates dataset for testing the association <code>M ~ X</code>. 
Covariates specified here will not participate penalization. Default = <code>NULL</code>. If the covariates 
contain mixed data types, please make sure all categorical variables are properly formatted as <code>factor</code> type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COV.MY</code></td>
<td>
<p>a <code>data.frame</code> or <code>matrix</code> of covariates dataset for testing the association <code>Y ~ M</code>. 
Covariates specified here will not participate penalization. If not specified, the same set of covariates for 
<code>M ~ X</code> will be applied. Using different sets of covariates is allowed but this needs to be handled carefully.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.family</code></td>
<td>
<p>either 'gaussian' (default) or 'binomial', depending on the data type of outcome (<code>Y</code>). See 
<code>ncvreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M.family</code></td>
<td>
<p>either 'gaussian' (default) or 'negbin' (i.e., negative binomial), depending on the data type of
mediator (<code>M</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>the penalty to be applied to the model. Either 'MCP' (the default), 'SCAD', or 
'lasso'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topN</code></td>
<td>
<p>an integer specifying the number of top markers from sure independent screening. 
Default = <code>NULL</code>. If <code>NULL</code>, <code>topN</code> will be either <code>ceiling(n/log(n))</code> if 
<code>Y.family = 'gaussian'</code>, or <code>ceiling(n/(2*log(n)))</code> if <code>Y.family = 'binomial'</code>, 
where <code>n</code> is the sample size. If the sample size is greater than topN (pre-specified or calculated), all 
mediators will be included in the test (i.e. low-dimensional scenario).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. Enable parallel computing feature? Default = <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p>number of cores to run parallel computing Valid when <code>parallel == TRUE</code>. 
By default max number of cores available in the machine will be utilized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical. Should the function scale the data? Default = <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bonfcut</code></td>
<td>
<p>Bonferroni-corrected p value cutoff applied to select significant mediators. Default = <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should the function be verbose? Default = <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>ncvreg</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame containing mediation testing results of selected mediators. 
</p>

<dl>
<dt>Index: </dt>
<dd>
<p>mediation name of selected significant mediator.</p>
</dd>
<dt>alpha_hat: </dt>
<dd>
<p>coefficient estimates of exposure (X) –&gt; mediators (M) (adjusted for covariates).</p>
</dd>
<dt>beta_hat: </dt>
<dd>
<p>coefficient estimates of mediators (M) –&gt; outcome (Y) (adjusted for covariates and exposure).</p>
</dd>
<dt>IDE: </dt>
<dd>
<p>mediation (indirect) effect, i.e., alpha*beta.</p>
</dd>
<dt>rimp: </dt>
<dd>
<p>relative importance of the mediator.</p>
</dd>
<dt>pmax: </dt>
<dd>
<p>joint raw p-value of selected significant mediator (based on Bonferroni method).</p>
</dd>
</dl>
<h3>References</h3>

<p>Zhang H, Zheng Y, Zhang Z, Gao T, Joyce B, Yoon G, Zhang W, Schwartz J, Just A, Colicino E, Vokonas P, Zhao L, 
Lv J, Baccarelli A, Hou L, Liu L. Estimating and Testing High-dimensional Mediation Effects in Epigenetic Studies. 
Bioinformatics. 2016. DOI: 10.1093/bioinformatics/btw351. PMID: 27357171; PMCID: PMC5048064
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Note: In the following examples, M1, M2, and M3 are true mediators.
data(himaDat)

# When Y is continuous and normally distributed
# Example 1 (continuous outcome): 
head(himaDat$Example1$PhenoData)

hima.fit &lt;- hima(X = himaDat$Example1$PhenoData$Treatment, 
                 Y = himaDat$Example1$PhenoData$Outcome, 
                 M = himaDat$Example1$Mediator,
                 COV.XM = himaDat$Example1$PhenoData[, c("Sex", "Age")],
                 Y.family = 'gaussian',
                 scale = FALSE, # Disabled only for simulation data
                 verbose = TRUE) 
hima.fit

# When Y is binary (should specify Y.family)
# Example 2 (binary outcome): 
head(himaDat$Example2$PhenoData)

hima.logistic.fit &lt;- hima(X = himaDat$Example2$PhenoData$Treatment,
                          Y = himaDat$Example2$PhenoData$Disease,
                          M = himaDat$Example2$Mediator,
                          COV.XM = himaDat$Example2$PhenoData[, c("Sex", "Age")],
                          Y.family = 'binomial',
                          scale = FALSE, # Disabled only for simulation data
                          verbose = TRUE)
hima.logistic.fit

## End(Not run)

</code></pre>


</div>