<div class="container">

<table style="width: 100%;"><tr>
<td>regr1.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot x and y,
with optional straight line fit and display of squared residuals</h2>

<h3>Description</h3>

<p>Plot <code>x</code> and <code>y</code>,
with optional fitted line and display of squared residuals.
By default the least squares line is calculated and used.
Any other straight line
can be specified by placing its coefficients in <code>coef.model</code>.
Any other fitted model can be calculated by specifying the <code>model</code>
argument.
Any other function of one variable can be specified in the
<code>alt.function</code> argument.  At most one of the arguments
<code>model</code>, <code>coef.model</code>, <code>alt.function</code> can be specified.</p>


<h3>Usage</h3>

<pre><code class="language-R">regr1.plot(x, y,
           model=lm(y~x),
           coef.model,
           alt.function,
           main="put a useful title here",
           xlab=deparse(substitute(x)),
           ylab=deparse(substitute(y)),
           jitter.x=FALSE,
           resid.plot=FALSE,
           points.yhat=TRUE,
           pch=16,
           ..., length.x.set=51,
           x.name,
           pch.yhat=16,
           cex.yhat=par()$cex*.7,
           err=-1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Defaults to the simple linear model <code>lm(y ~ x)</code>.
Any model object with one <code>x</code>
variable, such as the quadratic <code>lm(y ~ x + I(x^2))</code> can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.model</code></td>
<td>
<p>Defaults to the coefficients of the <code>model</code>
argument.  Other intercept and slope coefficients for a straight
line (for example, <code>c(3,5)</code>) can be entered to illustrate
the sense in which they are not "least squares".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt.function</code></td>
<td>
<p>Any function of a single argument can be placed
here.<br>
For example, <code>alt.function=function(x) {3 + 2*x + 3*x^2}</code>.<br>
All coefficients must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>arguments to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.x</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the x is jittered before
plotting.  Jittering is often helpful when there are multiple
y-values at the same level of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.plot</code></td>
<td>
<p>If <code>FALSE</code>, then do not plot the residuals.
If <code>"square"</code>, then call <code>resid.squares</code> to plot the
squared residuals.   If <code>TRUE</code> (or anything else),
then call <code>resid.squares</code> to plot
straight lines for the  residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.yhat</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the predicted values
are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.x.set</code></td>
<td>
<p>number of points used to plot the predicted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.name</code></td>
<td>
<p>If the <code>model</code> argument used a different name for
the independent variable, you might need to specify it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting character for the observed points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.yhat</code></td>
<td>
<p>Plotting character for the fitted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.yhat</code></td>
<td>
<p><code>cex</code> for the fitted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>The default <code>-1</code> suppresses warnings about out of bound
points.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This plot is designed as a pedagogical example for introductory courses.
When <code>resid.plot=="square"</code>, then we actually see the set of squares
for which the sum of their areas is minimized by the method of "least squares".
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>References</h3>

<p>Heiberger, Richard M. and Holland, Burt (2015).
<em>Statistical Analysis and Data Display: An Intermediate Course with Examples in R</em>.
Second Edition.
Springer-Verlag, New York.
<a href="https://link.springer.com/book/10.1007/978-1-4939-2122-5">https://link.springer.com/book/10.1007/978-1-4939-2122-5</a>
</p>
<p>Smith, W. and Gonick, L. (1993).
<em>The Cartoon Guide to Statistics</em>.
HarperCollins.
</p>


<h3>See Also</h3>

<p><code>resid.squares</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(hardness)

## linear and quadratic regressions
hardness.lin.lm  &lt;- lm(hardness ~ density,                data=hardness)
hardness.quad.lm &lt;- lm(hardness ~ density + I(density^2), data=hardness)

anova(hardness.quad.lm)  ## quadratic term has very low p-value

par(mfrow=c(1,2))

regr1.plot(hardness$density, hardness$hardness,
           resid.plot="square",
           main="squared residuals for linear fit",
           xlab="density", ylab="hardness",
           points.yhat=FALSE,
           xlim=c(20,95), ylim=c(0,3400))

regr1.plot(hardness$density, hardness$hardness,
           model=hardness.quad.lm,
           resid.plot="square",
           main="squared residuals for quadratic fit",
           xlab="density", ylab="hardness",
           points.yhat=FALSE,
           xlim=c(20,95), ylim=c(0,3400))

par(mfrow=c(1,1))
</code></pre>


</div>