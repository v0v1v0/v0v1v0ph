<div class="container">

<table style="width: 100%;"><tr>
<td>simplex.createTransform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Transform points on an (n-1)-simplex to n-dimensional space
</h2>

<h3>Description</h3>

<p>This function generates a matrix to transform points in an (n-1) dimensional homogeneous coordinate representation of the (n-1) simplex to n-dimensional Cartesian coordinates.
</p>
<p>The inverse transform can also be generated, and conversion can be to homogeneous coordinates instead of Cartesion ones.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simplex.createTransform(n, inverse=FALSE, keepHomogeneous=inverse)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Dimension of the space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>TRUE to convert from n-space coordinates to (n-1)-simplex coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepHomogeneous</code></td>
<td>
<p>TRUE to convert to homogeneous coordinates rather than Cartesian</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiply a coordinate vector in homogeneous coordinates by pre-multiplying by the generated matrix (see examples).
</p>


<h3>Value</h3>

<p>A transformation matrix.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef
</p>


<h3>See Also</h3>

<p><code>simplex.createConstraints</code>
<code>har</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">E &lt;- 1E-12 # Allowed numerical error

# The origin in (n-1)-dimensional space should be the centroid of the simplex
# when transformed to n-dimensional space
transform &lt;- simplex.createTransform(3)
x &lt;- transform %*% c(0, 0, 1)
x
stopifnot(abs(x - c(1/3, 1/3, 1/3)) &lt; E)

# The same should hold for the inverse transformation
invTransform &lt;- simplex.createTransform(3, inverse=TRUE)
y &lt;- invTransform %*% c(1/3, 1/3, 1/3, 1)
y
stopifnot(abs(y - c(0, 0, 1)) &lt; E)

# Of course, an arbitrary weight vector should transform back to itself
transform &lt;- simplex.createTransform(3, keepHomogeneous=TRUE)
x &lt;- c(0.2, 0.5, 0.3, 1.0)
y &lt;- transform %*% invTransform %*% x
y
stopifnot(abs(y - x) &lt; E)

# And we can apply the tranform to a matrix:
a &lt;- cbind(x, x, x)
b &lt;- transform %*% invTransform %*% a
b
stopifnot(abs(b - a) &lt; E)
</code></pre>


</div>