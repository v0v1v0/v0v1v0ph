<div class="container">

<table style="width: 100%;"><tr>
<td>map_routes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map a set of routes</h2>

<h3>Description</h3>

<p><code>map_routes</code> plots routes, with many options
</p>


<h3>Usage</h3>

<pre><code class="language-R">map_routes(
  thin_map,
  routes = NA,
  crs = himach::crs_Atlantic,
  show_route = c("speed", "aircraft", "time", "circuity", "acceleration", "traffic"),
  fat_map = NA,
  avoid_map = NA,
  ap_loc = NA,
  ap_col = "darkblue",
  ap_size = 0.4,
  forecast = NA,
  fc_var = NA_character_,
  fc_text = NA_character_,
  crow = FALSE,
  crow_col = "grey70",
  crow_size = 0.2,
  route_envelope = FALSE,
  bound = TRUE,
  bound_margin_km = 200,
  simplify_km = 8,
  land_f = "grey90",
  buffer_f = "grey60",
  land_c = "grey85",
  land_s = 0.2,
  avoid_f = "grey80",
  avoid_c = "grey95",
  avoid_s = 0.3,
  l_alpha = 0.8,
  l_size = 0.5,
  e_alpha = 0.4,
  e_size = 0.6,
  e_col = "grey70",
  refuel_airports = ap_loc,
  rap_col = "red",
  rap_size = 0.4,
  scale_direction = -1,
  title = "",
  subtitle = "",
  warn = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>thin_map</code></td>
<td>
<p>The minimum is a <code>MULTIPOLYGON</code> map, 'thin' in that it
is without buffer, so a normal coastline map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>routes</code></td>
<td>
<p>as generated by <code>find_route</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>Coordinate reference system, default <code>crs_Atlantic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_route</code></td>
<td>
<p>one of "speed", "aircraft", "time", "circuity", "accel",
"traffic" to indicate what goes in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fat_map</code></td>
<td>
<p>optional coast + buffer map, default NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avoid_map</code></td>
<td>
<p>optional map of no-fly zones, default NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ap_loc</code></td>
<td>
<p>Show used origin and destination airports if this is a set of
airports from <code>make_airports</code>, or not if NA (default). This
dataset can be all airports, and is filtered to those used by
<code>routes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ap_col, ap_size</code></td>
<td>
<p>Colour and size of used airport markers (dark blue,
0.4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecast, fc_var, fc_text</code></td>
<td>
<p>Forecast set and two strings. See details,
default NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crow, crow_col, crow_size</code></td>
<td>
<p>If TRUE, show the 'crow-flies' direct great
circle, in colour <code>crow_col</code> and thickness <code>crow_size</code>. Default
FALSE, "grey70", 0.2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>route_envelope</code></td>
<td>
<p>show the route envelope (default FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound, bound_margin_km</code></td>
<td>
<p>If bound=TRUE (default) crop to bounding box of
the <code>routes</code>, with additional <code>bound_margin_km</code> in km (default
200)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify_km</code></td>
<td>
<p>Simplify the two maps to this scale before plotting
(default 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>land_f, buffer_f, avoid_f</code></td>
<td>
<p>fill colours for thin, fat and no-fly maps,
default grey 90, 70 and 80, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>land_c, land_s</code></td>
<td>
<p>boundary colour and size for land areas (countries),
default grey 85 and 0.2, respectively (use NA to turn off)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avoid_c, avoid_s</code></td>
<td>
<p>boundary colour and size for avoid areas, default grey
95 and 0.3, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l_alpha, l_size</code></td>
<td>
<p>line (route) settings for alpha (transparency) and
width, defaults 0.6 and 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_col, e_alpha, e_size</code></td>
<td>
<p>colour, alpha and width for the range envelope.
Default "grey70", 0.4, 0.6</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refuel_airports</code></td>
<td>
<p>Show the used refuel airports using these locations,
or nothing if NA. (Defaults to same as <code>ap_loc</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rap_col, rap_size</code></td>
<td>
<p>Colour and size of refuel airport markers (red, 0.4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_direction</code></td>
<td>
<p>Passed to scale_colour_viridis, either -1 (default) or
or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title, subtitle</code></td>
<td>
<p>Passed to ggplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>if TRUE show some warnings (when defaults loaded) (default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to <code>scale_colour_viridis_b</code> (or _c,
_d), such as <code>breaks = </code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots the routes, with options for additional layers. Multiple
routes are expected, and they can be coloured by time advantage, by speed
along each segment, or by aircraft type.
</p>
<p>The option <code>show_route</code> "time" requires 'advantage_h' to have been added
to the routes set, from the route summary. If it hasn't then this is done in
a local version, then discarded. Running <code>summarise_routes</code> to do this
requires an airport dataset; if <code>is.na(ap_loc)</code> then this is not
available, so a default set is used. You can turn on <code>warn</code> to see if
this is happening, but by default it is silent.
</p>
<p>For <code>show_route = </code> "speed", "aircraft", "time", "circuity" or "accel",
the information is already available in the <code>routes</code> dataset. For
<code>show_route = "traffic"</code> you need to provide a forecast dataset that
contains at least the <code>fullRouteID and acID</code> fields which are normal in
the <code>routes</code> dataset, and a field giving the volume of the forecast
<code>fc_var</code>. This could be flights, seats, or something else: use
<code>fc_text</code> for the legend title to show the units of <code>fc_var</code>.
Combinations of <code>fullRouteID and acID</code> must be unique, which probably
means you must filter by forecast year and forecast scenario before passing
to <code>map_routes</code>.
</p>
<p>The time to compute the map may not be very different with <code>simplify_km</code>
varying between 2km and 20km, but the time to plot on the screen, or
<code>ggsave</code> to a file, is longer than the compute time. It is this latter
time that's reduced by simplifying the maps. For single, or short routes, you
can probably see the difference between 2km and 10km, so it's your choice to
prefer speed or beauty.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#see introductory vignette

</code></pre>


</div>