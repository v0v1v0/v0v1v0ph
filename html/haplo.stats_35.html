<div class="container">

<table style="width: 100%;"><tr>
<td>haplo.power.qt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute either power or sample size for haplotype associations with a
quantitative trait.
</h2>

<h3>Description</h3>

<p>For a given set of haplotypes, their population frequencies, and assumed
linear regression coefficients (additive model of haplotype effects on
a quantitative trait), determine either
the sample size  to achieve a stated
power or the power for a stated sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">haplo.power.qt(haplo, haplo.freq, base.index, haplo.beta, y.mu, y.var,
alpha, sample.size = NULL, power = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>haplo</code></td>
<td>

<p>matrix of haplotypes, with rows the different haplotypes and
columns the alleles of the haplotypes. For H haplotypes of L loci,
haplo has dimension H x L.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haplo.freq </code></td>
<td>

<p>vector of length H for the population haplotype frequencies
(corresponding to the rows of haplo)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.index </code></td>
<td>

<p>integer index of the haplotype considered to be the base-line for
logistic regression (index between 1 and H); often, the most common
haplotype is chosen for the base-line.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haplo.beta </code></td>
<td>

<p>vector of length H for the haplotype effects: each beta is the 
amount of expected change per haplotype from the base-line average,
and the beta for the base-line (indexed by base.index) is the 
beta for the intercept.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.mu </code></td>
<td>

<p>population mean of quantitative trait, y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.var </code></td>
<td>

<p>popultaion variance of quantitative trait, y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>type-I error rate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size </code></td>
<td>

<p>sample size (if power is to be calcualted). Either sample.size or power must be specified, but not both.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>desired power (if sample.size is to be calculated). Either sample.size or power must be specified, but not both.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Asympotic power calcuations are based on the non-centrality parameter
of a non-central F distribution. This non-centrality
parameter is determined by the specified regression coefficients
( values in haplo.beta), as well as the distribution of haplotypes
(determined by haplo.freq). To account for haplotypes with unknown
phase, all possible haplotype pairs are enumerated, and the EM
algorithm is used to determine the posterior probabilities of pairs of
haplotypes, conditional on unphased genotype data. Because this
function uses the function haplo.em, the  number of possible
haplotypes can be large when there is a large number of loci (i.e.,
large number of columns in the haplo matrix). If too large, the
function haplo.em will run out of memory, making this function
(haplo.power.qt) fail. If this occurs, then consider reducing the
"size" of the haplotypes, by reducing the number of columns of haplo,
and adjusting the corresponding vectors (e.g., haplo.freq, haplo.beta).
</p>


<h3>Value</h3>

<p>list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ss.phased.haplo</code></td>
<td>

<p>sample size for phased haplotypes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss.unphased.haplo</code></td>
<td>

<p>sample size for unphased haplotypes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power.phased.haplo</code></td>
<td>

<p>power for phased haplotypes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power.unphased.haplo</code></td>
<td>

<p>power for unphased haplotypes
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Schaid, DJ. Power and sample size for testing associations of
haplotypes with complex traits. Ann Hum Genet (2005) 70:116-130.
</p>


<h3>See Also</h3>

<p><code>find.haplo.beta.qt</code>,
<code>haplo.em</code>,
<code>haplo.power.cc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">haplo &lt;- rbind(
               c(     1,    2,    2,    1,    2),
               c(     1,    2,    2,    1,    1),
               c(     1,    1,    2,    1,    1),
               c(     1,    2,    1,    1,    2),
               c(     1,    2,    2,    2,    1),
               c(     1,    2,    1,    1,    1),
               c(     1,    1,    2,    2,    1),
               c(     1,    1,    1,    1,    2),
               c(     1,    2,    1,    2,    1),
               c(     1,    1,    1,    2,    1),
               c(     2,    2,    1,    1,    2),
               c(     1,    1,    2,    1,    2),
               c(     1,    1,    2,    2,    2),
               c(     1,    2,    2,    2,    2),
               c(     2,    2,    2,    1,    2),
               c(     1,    1,    1,    1,    1),
               c(     2,    1,    1,    1,    1),
               c(     2,    1,    2,    1,    1),
               c(     2,    2,    1,    1,    1),
               c(     2,    2,    1,    2,    1),
               c(     2,    2,    2,    1,    1))
dimnames(haplo)[[2]] &lt;- paste("loc", 1:ncol(haplo), sep=".")
haplo &lt;- data.frame(haplo)

haplo.freq &lt;- c(0.170020121, 0.162977867, 0.123742455, 0.117706237,
0.097585513, 0.084507042, 0.045271630, 0.039235412, 0.032193159,
0.019114688, 0.019114688, 0.013078471, 0.013078471, 0.013078471,
0.013078471, 0.006036217, 0.006036217, 0.006036217,
0.006036217, 0.006036217, 0.006036217)

# define index for risk haplotypes (having alleles 1-1 at loci 2 and 3)
haplo.risk &lt;- (1:nrow(haplo))[haplo$loc.2==1 &amp; haplo$loc.3==1]

# define index for baseline haplotype
base.index &lt;-  1

# Because it can be easier to speficy genetic effect size in terms of
# a regression model R-squared value (r2), we use an
# auxiliary function to set up haplo.beta based on a specifed r2 value:

tmp &lt;- find.haplo.beta.qt(haplo,haplo.freq,base.index,haplo.risk,
r2=0.01, y.mu=0, y.var=1)

haplo.beta &lt;- tmp$beta  

# Compute sample size for given power

haplo.power.qt(haplo, haplo.freq, base.index, haplo.beta, y.mu=0,
y.var=1, alpha=.05, power=.80) 

# Compute power for given sample size

haplo.power.qt(haplo, haplo.freq, base.index, haplo.beta, y.mu=0,
y.var=1, alpha=.05, sample.size = 2091)  
</code></pre>


</div>