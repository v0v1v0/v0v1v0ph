<div class="container">

<table style="width: 100%;"><tr>
<td>MC.Xdc.statistics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Size and Power for the Several-Sample DM Parameter Test Comparison</h2>

<h3>Description</h3>

<p>This Monte-Carlo simulation procedure provides the power and size of the several sample Dirichlet-Multinomial parameter test comparison, 
using the likelihood-ratio-test statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	MC.Xdc.statistics(group.Nrs, numMC = 10, alphap, type = "ha", 
		siglev = 0.05, est = "mom")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>group.Nrs</code></td>
<td>
<p>A list specifying the number of reads/sequence depth for each sample in a group with one group per list entry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numMC</code></td>
<td>
<p>Number of Monte-Carlo experiments.  In practice this should be at least 1,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphap</code></td>
<td>

<p>If <code>"hnull"</code>: A matrix where rows are vectors of alpha parameters for the reference group. <br>
If <code>"ha"</code>: A matrix consisting of vectors of alpha parameters for each taxa in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>If <code>"hnull"</code>: Computes the size of the test.<br>
If <code>"ha"</code>: Computes the power of the test. (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglev</code></td>
<td>
<p>Significance level for size of the test / power calculation. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>

<p>The type of parameter estimator to be used with the Likelihood-ratio-test statistics, 'mle' or 'mom'. Default value is 'mom'.  (See Note 2 in details)</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ol>
<li>
<p> Note 1: Though the test statistic supports an unequal number of reads across samples, the performance has not yet been fully tested.
</p>
</li>
<li>
<p> Note 2: 'mle' will take significantly longer time and may not be optimal for small sample sizes; 'mom' will provide a more conservative result in such a case.
</p>
</li>
<li>
<p> Note 3: All components of <code>alphap</code> should be non-zero or it may result in errors and/or invalid results.
</p>
</li>
</ol>
<h3>Value</h3>

<p>Size of the test statistics (under <code>"hnull"</code>) or power (under <code>"ha"</code>) of the test.</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(saliva)
	data(throat)
	data(tonsils)
	
	### Get a list of dirichlet-multinomial parameters for the data
	fit.saliva &lt;- DM.MoM(saliva) 
	fit.throat &lt;- DM.MoM(throat)
	fit.tonsils &lt;- DM.MoM(tonsils)
	
	### Set up the number of Monte-Carlo experiments
	### We use 1 for speed, should be at least 1,000
	numMC &lt;- 1
	
	### Generate the number of reads per sample
	### The first number is the number of reads and the second is the number of subjects
	nrsGrp1 &lt;- rep(12000, 9)
	nrsGrp2 &lt;- rep(12000, 11)
	nrsGrp3 &lt;- rep(12000, 12)
	group.Nrs &lt;- list(nrsGrp1, nrsGrp2, nrsGrp3)
	
	### Computing size of the test statistics (Type I error)
	alphap &lt;- fit.saliva$gamma
	pval1 &lt;- MC.Xdc.statistics(group.Nrs, numMC, alphap, "hnull")
	pval1
	
	### Computing Power of the test statistics (Type II error)
	alphap &lt;- rbind(fit.saliva$gamma, fit.throat$gamma, fit.tonsils$gamma)
	pval2 &lt;- MC.Xdc.statistics(group.Nrs, numMC, alphap)
	pval2
</code></pre>


</div>