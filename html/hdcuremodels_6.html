<div class="container">

<table style="width: 100%;"><tr>
<td>cureem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit penalized mixture cure model using the E-M algorithm</h2>

<h3>Description</h3>

<p>Fits a penalized parametric and semi-parametric mixture cure model (MCM) using the E-M algorithm with user-specified penalty parameters. The lasso (L1), MCP, and SCAD penalty is supported for the Cox MCM while only lasso is currently supported for parametric MCMs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cureem(
  formula,
  data,
  subset,
  x.latency = NULL,
  model = "cox",
  penalty = "lasso",
  penalty.factor.inc = NULL,
  penalty.factor.lat = NULL,
  thresh = 0.001,
  scale = TRUE,
  maxit = NULL,
  inits = NULL,
  lambda.inc = 0.1,
  lambda.lat = 0.1,
  gamma.inc = 3,
  gamma.lat = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model to be fitted. The response must be a survival object as returned by the <code>Surv</code> function while the variables on the right side of the formula are the covariates that are included in the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the <code>formula</code> or in the <code>subset</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of observations to be used in the fitting process, either a numeric or factor variable should be used in subset, not a character variable. All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.latency</code></td>
<td>
<p>specifies the variables to be included in the latency portion of the model and can be either a matrix of predictors, a model formula with the right hand side specifying the latency variables, or the same data.frame passed to the <code>data</code> parameter. Note that when using the model formula syntax for <code>x.latency</code> it cannot handle <code>x.latency = ~ .</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>type of regression model to use for the latency portion of mixture cure model. Can be "cox", "weibull", or "exponential" (default is "cox").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>type of penalty function. Can be "lasso", "MCP", or "SCAD" (default is "lasso").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor.inc</code></td>
<td>
<p>vector of binary indicators representing the penalty to apply to each incidence coefficient: 0 implies no shrinkage and 1 implies shrinkage. If not supplied, 1 is applied to all incidence variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor.lat</code></td>
<td>
<p>vector of binary indicators representing the penalty to apply to each latency coefficient: 0 implies no shrinkage and 1 implies shrinkage. If not supplied, 1 is applied to all latency variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>small numeric value. The iterative process stops when the differences between successive expected penalized complete-data log-likelihoods for both incidence and latency components are less than this specified level of tolerance (default is 10^-3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical, if TRUE the predictors are centered and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer specifying the maximum number of passes over the data for each lambda. If not specified, 100 is applied when <code>penalty = "lasso"</code> and 1000 is applied when <code>penalty = "MCP"</code> or <code>penalty = "SCAD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>an optional list specifiying the initial value for the incidence intercept (<code>itct</code>), a numeric vector for the unpenalized incidence coefficients (<code>b_u</code>), and a numeric vector for unpenalized latency coefficients (<code>beta_u</code>).  For parametric models, it should also include a numeric value for the rate parameter (<code>lambda</code>) when <code>model = "weibull"</code> or <code>model = "exponential"</code>, and a numeric value for the shape parameter (<code>alpha</code>) when <code>model = "weibull"</code>. When <code>model = "cox"</code>, it should also include a numeric vector for the latency survival probabilities <code class="reqn">S_u(t_i|w_i)</code> for i=1,...,N (<code>survprob</code>). Penalized coefficients are initialized to zero. If <code>inits</code> is not specified or improperly specified, initialization is automatically provided by the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.inc</code></td>
<td>
<p>numeric value for the penalization parameter <code class="reqn">\lambda</code> for variables in the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.lat</code></td>
<td>
<p>numeric value for the penalization parameter <code class="reqn">\lambda</code> for variables in the latency portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.inc</code></td>
<td>
<p>numeric value for the penalization parameter <code class="reqn">\gamma</code> for variables in the incidence portion of the model when <code>penalty = "MCP"</code> or <code>penalty = "SCAD"</code> (default is 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.lat</code></td>
<td>
<p>numeric value for the penalization parameter <code class="reqn">\gamma</code> for variables in the latency portion of the model when <code>penalty = "MCP"</code> or <code>penalty = "SCAD"</code> (default is 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b_path</code></td>
<td>
<p>Matrix representing the solution path of the coefficients in the incidence portion of the model. Row is step and column is variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_path</code></td>
<td>
<p>Matrix representing the solution path of lthe coefficients in the latency portion of the model. Row is step and column is variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0_path </code></td>
<td>
<p>Vector representing the solution path of the intercept in the incidence portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik.inc </code></td>
<td>
<p>Vector representing the expected penalized complete-data log-likelihood for the incidence portion of the model for each step in the solution path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik.lat </code></td>
<td>
<p>Vector representing the expected penalized complete-data log-likelihood for the latency portion of the model for each step in the solution path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.incidence</code></td>
<td>
<p>Matrix representing the design matrix of the incidence predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.latency</code></td>
<td>
<p>Matrix representing the design matrix of the latency predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector representing the survival object response as returned by the <code>Surv</code> function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Character string indicating the type of regression model used for the latency portion of mixture cure model ("weibull" or "exponential").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical value indicating whether the predictors were centered and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string indicating the EM alogoritm was used in fitting the mixture cure model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate_path</code></td>
<td>
<p>Vector representing the solution path of the rate parameter for the Weibull or exponential density in the latency portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_path</code></td>
<td>
<p>Vector representing the solution path of the shape parameter for the Weibull density in the latency portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Archer, K. J., Fu, H., Mrozek, K., Nicolet, D., Mims, A. S., Uy, G. L., Stock, W., Byrd, J. C., Hiddemann, W., Braess, J., Spiekermann, K., Metzeler, K. H., Herold, T., Eisfeld, A.-K. (2024) Identifying long-term survivors and those at higher or lower risk of relapse among patients with cytogenetically normal acute myeloid leukemia using a high-dimensional mixture cure model. <em>Journal of Hematology &amp; Oncology</em>, <b>17</b>:28.
</p>


<h3>See Also</h3>

<p><code>cv_cureem</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
set.seed(1234)
temp &lt;- generate_cure_data(N = 80, J = 100, nTrue = 10, A = 1.8)
training &lt;- temp$Training
fit &lt;- cureem(Surv(Time, Censor) ~ ., data = training, x.latency = training,
                 model = "cox", penalty = "lasso",
                 lambda.inc = 0.1, lambda.lat = 0.1, gamma.inc = 6, gamma.lat = 10)
</code></pre>


</div>