<div class="container">

<table style="width: 100%;"><tr>
<td>update.homGP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast <code>homGP</code>-update</h2>

<h3>Description</h3>

<p>Update existing <code>homGP</code> model with new observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'homGP'
update(
  object,
  Xnew,
  Znew = NULL,
  lower = NULL,
  upper = NULL,
  noiseControl = NULL,
  known = NULL,
  maxit = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>initial model of class <code>homGP</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xnew</code></td>
<td>
<p>matrix of new design locations; <code>ncol(Xnew)</code> must match the input dimension encoded in object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Znew</code></td>
<td>
<p>vector new observations at those new design locations, of length <code>nrow(X)</code>. <code>NA</code>s can be passed, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper, noiseControl, known</code></td>
<td>
<p>optional bounds for MLE optimization, see <code>mleHomGP</code>.
If not provided, they are extracted from the existing model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations for the internal L-BFGS-B optimization method; see <code>optim</code> for more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>no other argument for this method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In case hyperparameters need not be updated, <code>maxit</code> can be set to <code>0</code>. 
In this case it is possible to pass <code>NA</code>s in <code>Znew</code>, then the model can still be used to provide updated variance predictions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##------------------------------------------------------------
## Example : Sequential Homoskedastic GP modeling 
##------------------------------------------------------------
set.seed(42)

## Spatially varying noise function
noisefun &lt;- function(x, coef = 1){
  return(coef * (0.05 + sqrt(abs(x)*20/(2*pi))/10))
}

nvar &lt;- 1
n &lt;- 10
X &lt;- matrix(seq(0, 2 * pi, length=n), ncol = 1)
mult &lt;- sample(1:10, n)
X &lt;- rep(X, mult)
Z &lt;- sin(X) + rnorm(length(X), sd = noisefun(X))

testpts &lt;- matrix(seq(0, 2*pi, length = 10*n), ncol = 1)
model &lt;- model_init &lt;- mleHomGP(X = X, Z = Z,
                                lower = rep(0.1, nvar), upper = rep(50, nvar))
preds &lt;- predict(x = testpts, object = model_init) 
plot(X, Z)
lines(testpts, preds$mean, col = "red")


nsteps &lt;- 10
for(i in 1:nsteps){
  newIds &lt;- sort(sample(1:(10*n), 10))
  
  newX &lt;- testpts[newIds, drop = FALSE] 
  newZ &lt;- sin(newX) + rnorm(length(newX), sd = noisefun(newX))
  points(newX, newZ, col = "blue", pch = 20)
  model &lt;- update(object = model, newX, newZ)
  X &lt;- c(X, newX)
  Z &lt;- c(Z, newZ)
  plot(X, Z)
  print(model$nit_opt)
}
p_fin &lt;- predict(x = testpts, object = model) 
lines(testpts, p_fin$mean, col = "blue")
lines(testpts, qnorm(0.05, p_fin$mean, sqrt(p_fin$sd2)), col = "blue", lty = 2)
lines(testpts, qnorm(0.95, p_fin$mean, sqrt(p_fin$sd2)), col = "blue", lty = 2)
lines(testpts, qnorm(0.05, p_fin$mean, sqrt(p_fin$sd2 + p_fin$nugs)),
      col = "blue", lty = 3)
lines(testpts, qnorm(0.95, p_fin$mean, sqrt(p_fin$sd2 + p_fin$nugs)),
      col = "blue", lty = 3)

model_direct &lt;-  mleHomGP(X = X, Z = Z, lower = rep(0.1, nvar), upper = rep(50, nvar))
p_dir &lt;- predict(x = testpts, object = model_direct)
print(model_direct$nit_opt)
lines(testpts, p_dir$mean, col = "green")
lines(testpts, qnorm(0.05, p_dir$mean, sqrt(p_dir$sd2)), col = "green", lty = 2)
lines(testpts, qnorm(0.95, p_dir$mean, sqrt(p_dir$sd2)), col = "green", lty = 2)
lines(testpts, qnorm(0.05, p_dir$mean, sqrt(p_dir$sd2 + p_dir$nugs)),
      col = "green", lty = 3)
lines(testpts, qnorm(0.95, p_dir$mean, sqrt(p_dir$sd2 + p_dir$nugs)),
      col = "green", lty = 3)

lines(testpts, sin(testpts), col = "red", lty = 2)

## Compare outputs
summary(model_init)
summary(model)
summary(model_direct)



## End(Not run)
</code></pre>


</div>