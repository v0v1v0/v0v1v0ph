<div class="container">

<table style="width: 100%;"><tr>
<td>update.hmm.discnp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Update a fitted <code>hmm.discnp</code> model.
</h2>

<h3>Description</h3>

<p>An <code>update()</code> method for objects of class <code>hmm.discnp</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'hmm.discnp'
update(object,..., data, Kplus1=FALSE,
        tpm2=NULL, verbose=FALSE, method=NULL, optimiser=NULL,
        stationary=NULL, mixture=NULL, cis=NULL, tolerance=NULL,
        itmax=NULL, crit=NULL, X=NULL, addIntercept=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object of class <code>hmm.discnp</code> as returned by <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>The data set to which the (updated) model is to be fitted.  See the
description of the <code>y</code> argument of <code>hmm()</code> for more
detail.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kplus1</code></td>
<td>

<p>Logical scalar.  Should the number of states be incremented by 1?
If so then <code>tpm</code> (the transition probability matrix) is re-formed
by <code>rbind()</code>-ing on a row all of whose entries are <code>1/K</code>
(where <code>K</code> is the “old” number of states) and then
<code>cbind()</code>-ing on a column of zeroes.  The emission probability
matrix <code>Rho</code> is reformed by <code>cbind()</code>-ing on a column all
of whose entries are <code>1/m</code> where <code>m</code> is the number of discrete
values of the emissions.
</p>
<p>Note that the intial likelihood of the “new” model with
<code>K+1</code> states will (should?) be exactly the same as that of
of the “old” fitted <code>K</code>-state model.
</p>
<p>The <code>Kplus1</code> argument is provided mainly so as to provide a
set of starting values for the fitting process which will guarantee
the log likelihood of a <code>K+1</code>-state model will be at least as
large as that of a <code>K</code>-state model fitted to the same data set.
</p>
<p>Experience indicates that when <code>Kplus1=TRUE</code> is used, the
fitting process does not “move very far” from the maximum
log likelihood found for the <code>K</code>-state model.  It is then
advisable to try (many) random starting values so as to (try to)
find the “true” maximum for the <code>K+1</code>-state model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpm2</code></td>
<td>

<p>The transtion probability matrix to use when updating a model
fitted with <code>K=1</code> and <code>Kplus1=TRUE</code>. This argument
is ignored otherwise.  The default value of this argument is
<code>matrix(0.5,2,2)</code>.  The value of <code>tpm2</code> makes no
difference to the <em>initial</em> value of the likelihood
of the <code>K=2</code> model (which will be identical to the
likelihood of the fitted <code>K=1</code> model that is being
updated).  Any two-by-two transition probability matrix
“will do”.  However the value of <code>tpm2</code> could
conceivably have an impact on the final likelihood of the
<code>K=2</code> model to which the fitting procedure converges.
This is particularly true if the <code>method</code> is (or is
switched to) <code>"LM"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimiser</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cis</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addIntercept</code></td>
<td>

<p>See the help for <code>hmm()</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Except for argument <code>X</code>, any arguments that are left <code>NULL</code>
have their values supplied from the <code>args</code> component of <code>object</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>hmm.discnp</code> with an additional component
<code>init.log.like</code> which is the initial log likelihood
calculated at the starting values of the parameters (which may
be modified from the parameters returned in the object being
updated, if <code>Kplus1</code> is <code>TRUE</code>).  The calculation is
done by the function <code>logLikHmm()</code>.  Barring the strange and
unforeseen, <code>init.log.like</code> should be (reassuringly) equal
to <code>object$log.like</code>.  See <code>hmm()</code> for details of
the other components of the returned value.
</p>


<h3>Author(s)</h3>

<p>Rolf Turner
<a href="mailto:r.turner@auckland.ac.nz">r.turner@auckland.ac.nz</a><br></p>


<h3>See Also</h3>

<p><code>hmm()</code> <code>rhmm.hmm.discnp()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(294)
fit  &lt;- hmm(WoodPeweeSong,K=2,rand.start=list(tpm=TRUE,Rho=TRUE),itmax=10)
xxx  &lt;- rhmm(fit,nsim=1)
sfit &lt;- update(fit,data=xxx,itmax=10)
yyy  &lt;- with(SydColDisc,split(y,f=list(locn,depth)))
f1   &lt;- hmm(yyy,K=1)
f2   &lt;- update(f1,data=yyy,Kplus1=TRUE) # Big improvement, but ...
## Not run: 
g2   &lt;- hmm(yyy,K=2) # Substantially better than f2. 

## End(Not run)
</code></pre>


</div>