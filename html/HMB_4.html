<div class="container">

<table style="width: 100%;"><tr>
<td>gtsmb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Two-Staged Model-Based estmation</h2>

<h3>Description</h3>

<p>Generalized Two-Staged Model-Based estmation
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtsmb(y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Phis_Sa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y_S</code></td>
<td>
<p>Response object that can be coersed into a column vector. The
<code>_S</code> denotes that <code>y</code> is part of the sample <em>S</em>, with
<code class="reqn">N_S \le N_{Sa} \le N_U</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_S</code></td>
<td>
<p>Object of predictors variables that can be coersed into a matrix.
The rows of <code>X_S</code> correspond to the rows of <code>y_S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_Sa</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>Sa</em> is the intermediate sample, and the Z-variables often some
sort of auxilairy, inexpensive data. The rows of <code>Z_Sa</code> correspond to
the rows of <code>X_Sa</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_U</code></td>
<td>
<p>Object of predictor variables that can be coresed into a matrix.
The set <em>U</em> is the universal population sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega_S</code></td>
<td>
<p>The covariance structure of <code class="reqn">\boldsymbol{\epsilon}_{S}</code>, up to a constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phis_Sa</code></td>
<td>
<p>A 3D array, where the third dimension corresponds to the
covariance structure of
<code class="reqn">E(\boldsymbol{\xi}_{k,Sa} \boldsymbol{\xi}_{j,Sa}^T)</code>,
in the order <code class="reqn">k=1, \ldots, p, j=1, \ldots k</code>.
For p = 3, the order (k,j) will thus be (1,1), (2,1), (2,2), (3,1), (3,2),
(3,3).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The GTSMB assumes the superpopulations
</p>
<p style="text-align: center;"><code class="reqn">y = \boldsymbol{x} \boldsymbol{\beta} + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">x_k = \boldsymbol{z} \boldsymbol{\gamma}_k + \xi_k</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \perp \xi_k</code>
</p>

<p>For a sample from the superpopulation, the GTSMB assumes
</p>
<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\epsilon}) = \mathbf{0},
      E(\boldsymbol{\epsilon} \boldsymbol{\epsilon}^T) = \omega^2 \boldsymbol{\Omega}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(\boldsymbol{\xi}_k) = \mathbf{0},
      E(\boldsymbol{\xi}_k \boldsymbol{\xi}_j^T) = \theta_{\Phi,k,j}^2 \boldsymbol{\Phi}_{k,j},
      \theta_{\Phi,k,j}^2 \boldsymbol{\Phi}_{k,j} = \theta_{\Phi,j,k}^2 \boldsymbol{\Phi}_{j,k}</code>
</p>



<h3>Value</h3>

<p>A fitted object of class HMB.
</p>


<h3>References</h3>

<p>Holm, S., Nelson, R. &amp; Ståhl, G. (2017) Hybrid three-phase estimators for large-area forest inventory using ground plots, 
airborne lidar, and space lidar. <em>Remote Sensing of Environment, 197,</em> 85–97.
</p>
<p>Saarela, S., Holm, S., Healey, S.P., Andersen, H.-E., Petersson, H., Prentius, W., Patterson, P.L., Næsset, E., Gregoire, T.G. &amp; Ståhl, G. (2018). 
Generalized Hierarchical Model-Based Estimation for Aboveground Biomass Assessment Using GEDI and Landsat Data, <em>Remote Sensing, 10(11),</em> 1832.
</p>


<h3>See Also</h3>

<p><code>summary</code>,
<code>getSpec</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pop_U   = sample(nrow(HMB_data), 20000)
pop_Sa  = sample(pop_U, 500)
pop_S   = sample(pop_U, 100)

y_S     = HMB_data[pop_S, "GSV"]
X_S     = HMB_data[pop_S, c("hMAX", "h80", "CRR")]
X_Sa    = HMB_data[pop_Sa, c("hMAX", "h80", "CRR")]
Z_Sa    = HMB_data[pop_Sa, c("B20", "B30", "B50")]
Z_U     = HMB_data[pop_U, c("B20", "B30", "B50")]

Omega_S = diag(1, nrow(X_S))
Phis_Sa = array(0, c(nrow(X_Sa), nrow(X_Sa), ncol(X_Sa) * (ncol(X_Sa) + 1) / 2))
Phis_Sa[, , 1] = diag(1, nrow(X_Sa)) # Phi(1,1)
Phis_Sa[, , 2] = diag(1, nrow(X_Sa)) # Phi(2,1)
Phis_Sa[, , 3] = diag(1, nrow(X_Sa)) # Phi(2,2)
Phis_Sa[, , 4] = diag(1, nrow(X_Sa)) # Phi(3,1)
Phis_Sa[, , 5] = diag(1, nrow(X_Sa)) # Phi(3,2)
Phis_Sa[, , 6] = diag(1, nrow(X_Sa)) # Phi(3,3)

gtsmb_model = gtsmb(y_S, X_S, X_Sa, Z_Sa, Z_U, Omega_S, Phis_Sa)
gtsmb_model
</code></pre>


</div>