<div class="container">

<table style="width: 100%;"><tr>
<td>lmhs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Horseshoe shrinkage prior in Bayesian linear regression</h2>

<h3>Description</h3>

<p>This function employs the algorithm provided by van der Pas et. al. (2016) for 
linear model to fit Bayesian regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmhs(
  y,
  X,
  method.tau = c("fixed", "truncatedCauchy", "halfCauchy"),
  tau = 1,
  method.sigma = c("fixed", "Jeffreys"),
  Sigma2 = 1,
  burn = 1000,
  nmc = 5000,
  thin = 1,
  alpha = 0.05,
  Xtest = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of covariates, dimension <code class="reqn">n*p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.tau</code></td>
<td>
<p>Method for handling <code class="reqn">\tau</code>. Select "truncatedCauchy" for full
Bayes with the Cauchy prior truncated to [1/p, 1], "halfCauchy" for full Bayes with
the half-Cauchy prior, or "fixed" to use a fixed value (an empirical Bayes estimate,
for example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Use this argument to pass the (estimated) value of <code class="reqn">\tau</code> in case "fixed"
is selected for method.tau. Not necessary when method.tau is equal to "halfCauchy" or
"truncatedCauchy". The default (tau = 1) is not suitable for most purposes and should be replaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.sigma</code></td>
<td>
<p>Select "Jeffreys" for full Bayes with Jeffrey's prior on the error
variance <code class="reqn">\sigma^2</code>, or "fixed" to use a fixed value (an empirical Bayes
estimate, for example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2</code></td>
<td>
<p>A fixed value for the error variance <code class="reqn">\sigma^2</code>. Not necessary
when method.sigma is equal to "Jeffreys". Use this argument to pass the (estimated)
value of Sigma2 in case "fixed" is selected for method.sigma. The default (Sigma2 = 1)
is not suitable for most purposes and should be replaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Number of burn-in MCMC samples. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmc</code></td>
<td>
<p>Number of posterior draws to be saved. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning parameter of the chain. Default is 1 (no thinning).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Level for the credible intervals. For example, alpha = 0.05 results in
95% credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtest</code></td>
<td>
<p>test design matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is:
<code class="reqn">y_i</code> is response,
<code class="reqn">y_i=X\beta+\epsilon, \epsilon \sim N(0,\sigma^2)</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yHat</code></td>
<td>
<p>Predictive response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaHat</code></td>
<td>
<p>Posterior mean of Beta, a <code class="reqn">p</code> by 1 vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LeftCI</code></td>
<td>
<p>The left bounds of the credible intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RightCI</code></td>
<td>
<p>The right bounds of the credible intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaMedian</code></td>
<td>
<p>Posterior median of Beta, a <code class="reqn">p</code> by 1 vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaHat</code></td>
<td>
<p>Posterior samples of <code class="reqn">\lambda</code>, a <code class="reqn">p*1</code> vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Hat</code></td>
<td>
<p>Posterior mean of error variance <code class="reqn">\sigma^2</code>. If method.sigma =
"fixed" is used, this value will be equal to the user-selected value of Sigma2
passed to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauHat</code></td>
<td>
<p>Posterior mean of global scale parameter tau, a positive scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaSamples</code></td>
<td>
<p>Posterior samples of <code class="reqn">\beta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauSamples</code></td>
<td>
<p>Posterior samples of <code class="reqn">\tau</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Samples</code></td>
<td>
<p>Posterior samples of Sigma2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LikelihoodSamples</code></td>
<td>
<p>Posterior samples of likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>
<p>Devainace Information Criterion of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WAIC</code></td>
<td>
<p>Widely Applicable Information Criterion</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Maity, A. K., Carroll, R. J., and Mallick, B. K. (2019) 
"Integration of Survival and Binary Data for Variable Selection and Prediction: 
A Bayesian Approach", 
Journal of the Royal Statistical Society: Series C (Applied Statistics).
</p>
<p>Maity, A. K., Bhattacharya, A., Mallick, B. K., &amp; Baladandayuthapani, V. (2020). 
Bayesian data integration and variable selection for pan cancer survival prediction
using protein expression data. Biometrics, 76(1), 316-325.
</p>
<p>Stephanie van der Pas, James Scott, Antik Chakraborty and Anirban Bhattacharya (2016). horseshoe:
Implementation of the Horseshoe Prior. R package version 0.1.0.
https://CRAN.R-project.org/package=horseshoe
</p>
<p>Enes Makalic and Daniel Schmidt (2016). High-Dimensional Bayesian Regularised Regression with the
BayesReg Package arXiv:1611.06649
</p>


<h3>Examples</h3>

<pre><code class="language-R">
burnin &lt;- 500
nmc    &lt;- 1000
thin &lt;- 1
y.sd   &lt;- 1  # standard deviation of the response

p &lt;- 100  # number of predictors
ntrain &lt;- 100  # training size
ntest  &lt;- 50   # test size
n &lt;- ntest + ntrain  # sample size
q &lt;- 10   # number of true predictos

beta.t &lt;- c(sample(x = c(1, -1), size = q, replace = TRUE), rep(0, p - q))  
x &lt;- mvtnorm::rmvnorm(n, mean = rep(0, p), sigma = diag(p))    

tmean &lt;- x %*% beta.t
y &lt;- rnorm(n, mean = tmean, sd = y.sd)
X &lt;- scale(as.matrix(x))  # standarization

# Training set
ytrain &lt;- y[1:ntrain]
Xtrain &lt;- X[1:ntrain, ]

# Test set
ytest &lt;- y[(ntrain + 1):n]
Xtest &lt;- X[(ntrain + 1):n, ]

posterior.fit &lt;- lmhs(y = ytrain, X = Xtrain, method.tau = "halfCauchy",
                       method.sigma = "Jeffreys", burn = burnin, nmc = nmc, thin = 1,
                       Xtest = Xtest)
                             
posterior.fit$BetaHat

# Posterior processing to recover the true predictors
cluster &lt;- kmeans(abs(posterior.fit$BetaHat), centers = 2)$cluster
cluster1 &lt;- which(cluster == 1)
cluster2 &lt;- which(cluster == 2)
min.cluster &lt;- ifelse(length(cluster1) &lt; length(cluster2), 1, 2)
which(cluster == min.cluster)  # this matches with the true variables


</code></pre>


</div>