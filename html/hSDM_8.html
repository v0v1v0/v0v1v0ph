<div class="container">

<table style="width: 100%;"><tr>
<td>hSDM.binomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial logistic regression model</h2>

<h3>Description</h3>

<p>The <code>hSDM.binomial</code> function performs a Binomial
logistic regression in a Bayesian framework. The function calls
a Gibbs sampler written in C code which uses an adaptive Metropolis
algorithm to estimate the conditional posterior distribution of
model's parameters.</p>


<h3>Usage</h3>

<pre><code class="language-R">hSDM.binomial(presences, trials, suitability, data,
suitability.pred = NULL, burnin = 5000, mcmc = 10000, thin = 10,
beta.start, mubeta = 0, Vbeta = 1e+06, seed = 1234, verbose = 1, save.p
= 0)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>presences</code></td>
<td>
<p>A vector indicating the number of successes (or
presences) for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>A vector indicating the number of trials for each
observation. <code class="reqn">t_n</code> should be superior or equal to <code class="reqn">y_n</code>, the
number of successes for observation <code class="reqn">n</code>. If <code class="reqn">t_n=0</code>, then
<code class="reqn">y_n=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suitability</code></td>
<td>
<p>A one-sided formula of the form '~x1+...+xp' with p
terms specifying the explicative variables for the suitability process
of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the model's explicative
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suitability.pred</code></td>
<td>
<p>An optional data frame in which to look for
variables with which to predict. If NULL, the observations are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burnin iterations for the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>The number of Gibbs iterations for the sampler. Total
number of Gibbs iterations is equal to
<code>burnin+mcmc</code>. <code>burnin+mcmc</code> must be divisible by 10 and
superior or equal to 100 so that the progress bar can be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning interval used in the simulation. The number
of mcmc iterations must be divisible by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.start</code></td>
<td>
<p>Starting values for beta parameters of the
suitability process. If <code>beta.start</code> takes a scalar value, then
that value will serve for all of the betas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mubeta</code></td>
<td>
<p>Means of the priors for the <code class="reqn">\beta</code> parameters
of the suitability process. <code>mubeta</code> must be either a scalar or a
p-length vector. If <code>mubeta</code> takes a scalar value, then that value will
serve as the prior mean for all of the betas. The default value is set
to 0 for an uninformative prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vbeta</code></td>
<td>
<p>Variances of the Normal priors for the <code class="reqn">\beta</code>
parameters of the suitability process. <code>Vbeta</code> must be either a
scalar or a p-length vector. If <code>Vbeta</code> takes a scalar value,
then that value will serve as the prior variance for all of the
betas. The default variance is large and set to 1.0E6 for an
uninformative flat prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the random number generator. Default to 1234.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A switch (0,1) which determines whether or not the
progress of the sampler is printed to the screen. Default is 1: a
progress bar is printed, indicating the step (in %) reached by the
Gibbs sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.p</code></td>
<td>
<p>A switch (0,1) which determines whether or not the
sampled values for predictions are saved. Default is 0: the
posterior mean is computed and returned in the <code>theta.pred</code>
vector. Be careful, setting <code>save.p</code> to 1 might require a large
amount of memory.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We model an ecological process where the presence or absence
of the species is explained by habitat suitability.
</p>
<p><b>Ecological process:</b>
</p>
<p style="text-align: center;"><code class="reqn">y_i \sim \mathcal{B}inomial(\theta_i,t_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(\theta_i) = X_i \beta</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>An mcmc object that contains the posterior sample. This
object can be summarized by functions provided by the coda
package. The posterior sample of the deviance <code class="reqn">D</code>, with
<code class="reqn">D=-2\log(\prod_i P(y_i|\beta,t_i))</code>, is also provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.pred</code></td>
<td>
<p>If <code>save.p</code> is set to 0 (default),
<code>theta.pred</code> is the predictive posterior mean of the
probability associated to the suitability process for each
prediction. If <code>save.p</code> is set to 1, <code>theta.pred</code> is an
<code>mcmc</code> object with sampled values of the probability associated
to the suitability process for each prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.latent</code></td>
<td>
<p>Predictive posterior mean of the probability
associated to the suitability process for each observation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ghislain Vieilledent <a href="mailto:ghislain.vieilledent@cirad.fr">ghislain.vieilledent@cirad.fr</a>
</p>


<h3>References</h3>

<p>Gelfand, A. E.; Schmidt, A. M.; Wu, S.; Silander, J. A.; Latimer, A. and
Rebelo, A. G. (2005) Modelling species diversity through species level
hierarchical modelling. <em>Applied Statistics</em>, 54, 1-20.
</p>
<p>Latimer, A. M.; Wu, S. S.; Gelfand, A. E. and Silander, J. A. (2006) Building
statistical models to analyze species distributions. <em>Ecological
Applications</em>, 16, 33-50.
</p>


<h3>See Also</h3>

<p><code>plot.mcmc</code>, <code>summary.mcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

#==============================================
# hSDM.binomial()
# Example with simulated data
#==============================================

#=================
#== Load libraries
library(hSDM)

#==================
#== Data simulation

#= Number of sites
nsite &lt;- 200

#= Set seed for repeatability
seed &lt;- 1234

#= Number of visits associated to each site
set.seed(seed)
visits&lt;- rpois(nsite,3)
visits[visits==0] &lt;- 1

#= Ecological process (suitability)
set.seed(seed)
x1 &lt;- rnorm(nsite,0,1)
set.seed(2*seed)
x2 &lt;- rnorm(nsite,0,1)
X &lt;- cbind(rep(1,nsite),x1,x2)
beta.target &lt;- c(-1,1,-1)
logit.theta &lt;- X %*% beta.target
theta &lt;- inv.logit(logit.theta)
set.seed(seed)
Y &lt;- rbinom(nsite,visits,theta)

#= Data-sets
data.obs &lt;- data.frame(Y,visits,x1,x2)

#==================================
#== Site-occupancy model

mod.hSDM.binomial &lt;- hSDM.binomial(presences=data.obs$Y,
                                   trials=data.obs$visits,
                                   suitability=~x1+x2,
                                   data=data.obs,
                                   suitability.pred=NULL,
                                   burnin=1000, mcmc=1000, thin=1,
                                   beta.start=0,
                                   mubeta=0, Vbeta=1.0E6,
                                   seed=1234, verbose=1,
                                   save.p=0)

#==========
#== Outputs

#= Parameter estimates
summary(mod.hSDM.binomial$mcmc)
pdf(file="Posteriors_hSDM.binomial.pdf")
plot(mod.hSDM.binomial$mcmc)
dev.off()

#== glm resolution to compare
mod.glm &lt;- glm(cbind(Y,visits-Y)~x1+x2,family="binomial",data=data.obs)
summary(mod.glm)

#= Predictions
summary(mod.hSDM.binomial$theta.latent)
summary(mod.hSDM.binomial$theta.pred)
pdf(file="Pred-Init.pdf")
plot(theta,mod.hSDM.binomial$theta.pred)
abline(a=0,b=1,col="red")
dev.off()


## End(Not run)

</code></pre>


</div>