<div class="container">

<table style="width: 100%;"><tr>
<td>mediate_bslmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Sparse Linear Mixed Model</h2>

<h3>Description</h3>

<p><code>mediate_bslmm</code> fits the Bayesian sparse linear mixed model proposed by
Song et al. (2020) for high-dimensional mediation analysis, estimating the
mediation contributions of potential mediators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mediate_bslmm(
  A,
  M,
  Y,
  C1 = NULL,
  C2 = C1,
  burnin = 30000,
  ndraws = 5000,
  ci_level = 0.95,
  weights = NULL,
  k = 2,
  lm0 = 1e-04,
  lm1 = 1,
  lma1 = 1,
  l = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>length <code>n</code> numeric vector containing exposure variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p><code>n x p</code> numeric matrix of high-dimensional mediators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>length <code>n</code> numeric vector containing continuous outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p>optional numeric matrix of covariates to include in the outcome model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C2</code></td>
<td>
<p>optional numeric matrix of covariates to include in the mediator
model. Default is <code>C1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of MCMC draws prior to sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>number of MCMC draws after burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_level</code></td>
<td>
<p>the desired credible interval level. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional numeric vector of observation weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>shape parameter for the inverse gamma priors. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm0</code></td>
<td>
<p>scale parameter for the inverse gamma prior on the variance of the
smaller-variance normal components. Default is <code>1e-4</code>. If <code>k=2</code>,
this parameter equals the prior mean on the smaller normal variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm1</code></td>
<td>
<p>scale parameter for the inverse gamma prior on the variance of the
larger-variance components of <code>beta_m</code>. Default is 1. If <code>k=2</code>,
this parameter equals the prior mean on the larger normal variance of the
mediator-outcome associations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lma1</code></td>
<td>
<p>scale parameter for the inverse gamma prior on the variance of the
larger-variance components of <code>alpha_a</code>. Default is 1. If <code>k=2</code>,
this parameter equals the prior mean on the larger normal variance of the
exposure-mediator associations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>scale parameter for the other inverse gamma priors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mediate_bslmm</code> is a wrapper function for the "BSLMM" option from <code>bama::bama()</code>,
which fits a Bayesian sparse linear mixed model for performing mediation
analysis with high-dimensional mediators. The model assumes that
the mediator-outcome associations (<code class="reqn">\beta_m</code>) and the exposure-mediator
associations (<code class="reqn">\alpha_a</code>) independently follow a mixture of small-variance
and high-variance normal distributions, and that if a mediator <code class="reqn">M_j</code> has both
<code class="reqn">(\beta_m)_j</code> and <code class="reqn">(\alpha_a)_j</code> belonging to the larger-variance distribution,
it has a notably large mediation contribution compared to the others. The
posterior inclusion probability (PIP) of belonging to both larger-variance
distributions is reported for each mediator as <code>ab_pip</code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>contributions</code>: a data frame containing the estimates, Bayesian credible
intervals, and posterior inclusion probabilities of the mediation contributions
</p>
</li>
<li> <p><code>effects</code>: a data frame containing the estimated direct, global mediation,
and total effects.
</p>
</li>
</ul>
<h3>References</h3>

<p>Song, Y. et al. Bayesian shrinkage estimation of high dimensional
causal mediation effects in omics studies. Biometrics 76, 700-710 (2020).
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- med_dat$A
M &lt;- med_dat$M
Y &lt;- med_dat$Y

# Toy example with small burnin and ndraws
out &lt;- mediate_bslmm(A, M, Y, burnin = 100, ndraws = 10)
out$effects
head(out$contributions)


</code></pre>


</div>