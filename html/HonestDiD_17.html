<div class="container">

<table style="width: 100%;"><tr>
<td>createSensitivityResults_relativeMagnitudes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Constructs robust confidence intervals for <code class="reqn">\Delta = \Delta^{RM}(Mbar)</code>, <code class="reqn">\Delta^{SDRM}(Mbar)</code> and their variants that incorporate shape or sign restrictions for a vector of possible Mbar values.
</h2>

<h3>Description</h3>

<p>Constructs robust confidence intervals for <code class="reqn">\Delta = \Delta^{RM}(Mbar)</code>, <code class="reqn">\Delta^{SDRM}(Mbar)</code> and their variants that incorporate shape or sign restrictions for a vector of possible Mbar values. By default, the function constructs sensitivity results for <code class="reqn">\Delta^{RM}(Mbar)</code> and its variants. The confidence sets are constructed through test inversion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">createSensitivityResults_relativeMagnitudes(betahat, sigma,
                                            numPrePeriods, numPostPeriods,
                                            bound = "deviation from parallel trends",
                                            method = "C-LF",
                                            Mbarvec = NULL,
                                            l_vec = .basisVector(index = 1,
                                                                 size = numPostPeriods),
                                            monotonicityDirection = NULL,
                                            biasDirection = NULL,
                                            alpha = 0.05,
                                            gridPoints = 10^3,
                                            grid.ub = NA,
                                            grid.lb = NA,
                                            parallel = FALSE,
                                            seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>betahat</code></td>
<td>

<p>Vector of estimated event study coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Covariance matrix of event study coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numPrePeriods</code></td>
<td>

<p>Number of pre-periods. If user selects bound = "deviation from linear trends" (<code class="reqn">Delta^{SDRM}</code> as base choice of Delta), then numPrePeriods must be greater than one. See details for further explanation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numPostPeriods</code></td>
<td>

<p>Number of post-periods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>

<p>String that specifies the base choice of Delta (to which additional sign and shape restrictions will be incorporated if specified by the user). This must be either "deviation from parallel trends" or "deviation from linear trend". If bound equals "deviation from parallel trends", then the function will select <code class="reqn">\Delta^{RM}(Mbar)</code> as the base choice of <code class="reqn">\Delta</code>. If bound equals "deviation from linear trends", then the function will select <code class="reqn">\Delta^{SDRM}</code> as the base choice of <code class="reqn">\Delta</code>. By default, this is set to "deviation from parallel trends". See Section 2.3.1 and 2.3.2 of Rambachan &amp; Roth (2021) for a discussion of these choices of <code class="reqn">\Delta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>String that specifies the choice of method for constructing robust confidence intervals. This must be either "Conditional", or "C-LF" (conditional least-favorable hybrid). Default equals "C-LF" and the function automatically sets method to be "C-LF" based on the recommendations in Rambachan &amp; Roth (2021).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mbarvec</code></td>
<td>

<p>Vector of Mbar values for which the user wishes to construct robust confidence intervals. If NULL, the function constructs a grid of length 10 that starts at Mbar = 0 and ends at Mbar = 2. Default equals null.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l_vec</code></td>
<td>

<p>Vector of length numPostPeriods that describes the scalar parameter of interest, theta = l_vec'tau. Default equals to first basis vector, (1, 0, ..., 0)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biasDirection</code></td>
<td>

<p>This must be specified if the user wishes to add an additional bias restriction to base choice of Delta. If "positive", bias is restricted to be positive, delta &gt;= 0. If "negative", bias is restricted to be negative, delta &lt;= 0. Default equals NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monotonicityDirection</code></td>
<td>

<p>This must be specified if the user wishes to add an additional monotonicity restriction to base choice of Delta. If "increasing", underlying trend specified to be increasing, <code class="reqn">\delta_t \ge \delta_{t-1}</code>. If "decreasing", underlying trend specified to be decreasing <code class="reqn">\delta_t \le \delta_{t-1}</code>. Default equals NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Desired size of the robust confidence sets. Default equals 0.05 (corresponding to 95% confidence interval)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>Logical to indicate whether the user would like to construct the robust confidence intervals in parallel. This uses the Foreach package and doParallel package. Default equals FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridPoints</code></td>
<td>

<p>Number of grid points used for the underlying test inversion. Default equals 1000. User may wish to change the number of grid points for computational reasons.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.ub</code></td>
<td>

<p>Upper bound of grid used for underlying test inversion. Default sets grid.ub to be equal to twenty times the standard deviation of the estimated target parameter, l_vec * betahat. User may wish to change the upper bound of the grid to suit their application.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.lb</code></td>
<td>

<p>Lower bound of grid used for underlying test inversion. Default sets grid.lb to be equal to negative twenty times the standard deviation of the estimated target parameter, l_vec * betahat. User may wish to change the lower bound of the grid to suit their application.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Random seed for internal computations; included for reproducibility.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: If the user specifies bound = "deviation from linear trends", then numPrePeriods must be greater than one. By specifying bound = "deviation from linear trends", then the function selects <code class="reqn">\Delta^{SDRM}</code> as the base choice of <code class="reqn">\Delta</code>. As discussed in Section 2.3.2 of Rambachan &amp; Roth (2021), <code class="reqn">\Delta^{SDRM}</code> uses observed non-linearities in the pre-treatment difference in trends to bound the possible non-linearities in the post-treatment difference in trends. This is only possible if there are multiple pre-treatment periods (i.e., numPrePeriods &gt; 1).
</p>


<h3>Value</h3>

<p>Returns a dataframe with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>Lower bound of robust confidence sets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>

<p>Upper bound of robust confidence sets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method for constructing robust confidence sets
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>

<p>The set Delta that was specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Values of M associated with each robust confidence set.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ashesh Rambachan
</p>


<h3>References</h3>

<p>Rambachan, Ashesh and Jonathan Roth. "An Honest Approach to Parallel Trends." 2021.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Simple use case. For more detailed examples,
  # see &lt;https://github.com/asheshrambachan/HonestDiD#honestdid&gt;
  kwargs &lt;- list(betahat        = BCdata_EventStudy$betahat,
                 sigma          = BCdata_EventStudy$sigma,
                 numPrePeriods  = length(BCdata_EventStudy$prePeriodIndices),
                 numPostPeriods = length(BCdata_EventStudy$postPeriodIndices),
                 alpha          = 0.05)
  do.call(createSensitivityResults_relativeMagnitudes, kwargs)

</code></pre>


</div>