<div class="container">

<table style="width: 100%;"><tr>
<td>det_hrz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determination of the high-risk zone.</h2>

<h3>Description</h3>

<p><code>det_hrz</code> determines the high-risk zone through the method of fixed radius 
(type = "dist" and criterion = "direct"), the quantile-based method (type = "dist" and 
criterion = "area"/"indirect") and the intensity-based method (type =  "intens").
</p>


<h3>Usage</h3>

<pre><code class="language-R">det_hrz(
  ppdata,
  type,
  criterion,
  cutoff,
  distancemap = NULL,
  intens = NULL,
  nxprob = 0.1,
  covmatrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code> (method of fixed radius or quantile-based method), or
<code>"intens"</code> (intensity-based method)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of 
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold). 
Depending on criterion and type: 
If criterion = "direct" and type = "intens", cutoff is the maximum intensity of unexploded bombs
outside the risk zone. If type = "dist" instead, cutoff is the radius of the circle around each exploded bomb.
"If criterion = "indirect", cutoff is the quantile for the quantile-based method and the failure 
probability alpha for the intensity-base method. If criterion = "area", cutoff is the area the high-risk zone should
have.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation 
of the point pattern; only needed for <code>type="dist"</code>. If not given, 
it will be computed by <code>distmap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class "im"), 
only needed for type="intens". If not given,
it will be estimated using <code>density.ppp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for 
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated
using <code>Hscv</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are different methods implemented to determine a high-risk zone.
</p>

<dl>
<dt> Method of fixed radius </dt>
<dd>
<p>In this method, the high-risk zone is determined by drawing a circle around each
observed event with a fixed radius. This method will be used when <code>type = "dist"</code>
and <code>criterion = "direct"</code>. <code>cutoff</code> then is the radius.
</p>
</dd>
<dt> Quantile-based method </dt>
<dd>
<p>This method is a development of the above. Here the radius is not fixed. It uses
the distance of every observed event to the nearest other event, which is calculated by the
nearest-neighbour distance. The radius is assessed by the p-quantile of the empirical
distribution function of the nearest-neighbour distance. This method will be used when
<code>type = "dist"</code> and <code>criterion = "indirect"</code> or <code>"area"</code>. If 
<code>criterion = "indirect"</code>, then <code>cutoff</code> is the quantile that should be used.
If <code>criterion = "area"</code> then <code>cutoff</code> is the area that the  high-risk zone 
has to have at the end and from that the quantile/the radii are determined. When the
calculation is done via the area, it can not really be classified to the quantile-based
method. It is rather a third "distance-based" method.
</p>
</dd>
<dt> Intensity-based method </dt>
<dd>
<p>The first step of this method is to estimate the intensity of the observed events.
Based on the estimated intensity and the specified probability of unobserved bombs <code>nxprob</code> 
it is possible to estimate the intensity of unobserved/unexploded bombs.
The high-risk zone is then the area in which the estimated intensity of unexploded bombs exceeds a 
certain  value. This value is called threshold c.
The method will be used when <code>type = "intens"</code>. There are three different ways to
construct a high-risk zone: 
</p>

<ol>
<li>
<p> Fixing the threshold c: <code>criterion = "direct"</code> 
</p>
</li>
<li>
<p> Fixing the area of the high-risk zone: <code>criterion = "area"</code>
</p>
</li>
<li>
<p> Fixing the failure probability alpha, which is the probability of having 
unobserved events outside the high-risk zone: <code>criterion = "indirect"</code>
Here, the point process is assumed to be an inhomogeneous Poisson process.
</p>
</li>
</ol>
<p>For further information see Mahling et al. (2013) (References).
</p>
</dd>
</dl>
<p>If there are restriction areas in the observation window, use <code>det_hrz_restr</code>
instead. For estimation of intensity based highrikszones with a bigger observation area than area of interest
(evaluation area) use <code>det_hrz_eval_ar</code>.
</p>


<h3>Value</h3>

<p>An object of class "<code>highriskzone</code>", which is a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code> typehrz, criterion, cutoff, nxprob </code></td>
<td>
<p> see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> zone </code></td>
<td>
<p> Determined high-risk zone: Object of class "owin" based on a binary mask. 
See <code>owin</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> threshold </code></td>
<td>
<p> determined threshold. If type = "dist" and criterion = "direct" it is the specified radius.
If criterion = "indirect" or "area" the determined radius used to construct a risk zone fulfilling the specified criterion 
and cutoff. If type = "dist" it is the specified or calculated threshold c, the maximum intensitiy of unexploded bombs 
outside the risk zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> calccutoff </code></td>
<td>
<p> determined cutoff-value. For type="dist" and criterion="area", this is the
quantile of the nearest-neighbour distance. For type="intens" and criterion="area" or "direct", it is the failure
probability alpha. For all other criterions it is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> covmatrix </code></td>
<td>
<p> If not given (and <code>type="intens"</code>), it is estimated. See <code>Hscv</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Monia Mahling, Michael Hoehle &amp; Helmut Kuechenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag Goettingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
</p>


<h3>See Also</h3>

<p><code>distmap</code>, <code>eval.im</code>, <code>owin</code>,
<code>eval_method</code>, <code>det_hrz_restr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(craterA)
## change npixel to 1000 to obtain nicer plots
spatstat.geom::spatstat.options(npixel=100)
## type: dist
hrzd1 &lt;- det_hrz(craterA, type = "dist", criterion = "area", cutoff = 1000000, nxprob = 0.1)
hrzd2 &lt;- det_hrz(craterA, type = "dist", criterion = "indirect", cutoff = 0.9, nxprob = 0.1)
hrzd3 &lt;- det_hrz(craterA, type = "dist", criterion = "direct", cutoff = 100, nxprob = 0.1)

op &lt;- par(mfrow = c(2, 2))
plot(craterA)
plot(hrzd1, zonecol = 2, win = craterA$window, plotwindow = TRUE)
plot(hrzd2, zonecol = 3,  win = craterA$window, plotwindow = TRUE)
plot(hrzd3, zonecol = 4,  win = craterA$window, plotwindow = TRUE)
par(op)

## Not run: 
# or first calculate the distancemap and use it:
distm &lt;- distmap(craterA)
hrzd &lt;- det_hrz(craterA, type = "dist", criterion = "direct", cutoff = 100,
                distancemap = distm, nxprob = 0.1)

## End(Not run)                
## type: intens 
# reduce number of observations for faster computation
thin.craterA &lt;- craterA[1:10]
hrzi1 &lt;- det_hrz(thin.craterA, type = "intens", criterion = "area", cutoff = 100000, nxprob = 0.1)
plot(hrzi1)
plot(thin.craterA, add = TRUE)
plot(thin.craterA$window, add = TRUE)
## Not run: 
hrzi2 &lt;- det_hrz(craterA, type = "intens", criterion = "indirect", cutoff = 0.1, nxprob = 0.1)
hrzi3 &lt;- det_hrz(craterA, type = "intens", criterion = "direct", cutoff = 0.0001, nxprob = 0.1)
plot(hrzi2)
plot(hrzi3)

## End(Not run)
                 
## More detailed examples on http://highriskzone.r-forge.r-project.org/
</code></pre>


</div>