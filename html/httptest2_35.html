<div class="container">

<table style="width: 100%;"><tr>
<td>with_mock_dir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use or create mock files depending on their existence</h2>

<h3>Description</h3>

<p>This context will switch the <code>.mockPaths()</code> to <code>tests/testthat/dir</code>
(and then resets it to what it was before).
If the <code>tests/testthat/dir</code> folder doesn't exist, <code>capture_requests()</code> will
be run to create mocks.
If it exists, <code>with_mock_api()</code> will be run.
To re-record mock files, simply delete <code>tests/testthat/dir</code> and run the test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">with_mock_dir(dir, expr, simplify = TRUE, replace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>character string, unique folder name that will be used or created
under <code style="white-space: pre;">⁠tests/testthat/⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>Code to run inside the context</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), plain-text responses with status 200
will be written as just the text of the response body. In all other cases,
and when <code>simplify</code> is <code>FALSE</code>, the <code>httr2_response</code> object will be written out to
a .R file using <code>base::dput()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>Logical: should <code>dir</code> replace the contents of <code>.mockPaths()</code>
(default) or be added in front of the existing paths? The default behavior
here is the opposite of <code>.mockPaths()</code> so that the tests inside of
<code>with_mock_dir()</code> are fully isolated.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>vignette("httptest2")</code> for usage examples.
</p>


</div>