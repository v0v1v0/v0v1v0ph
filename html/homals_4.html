<div class="container">

<table style="width: 100%;"><tr>
<td>homals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Homogeneity Analysis</h2>

<h3>Description</h3>

<p>This function performs a homogeneity analysis, aka a multiple correspondence
analysis, but with many additional options. Variables can be grouped into
sets, in order to emulate regression analysis and canonical analysis. For
each variable there are, in addition, rank constraints on the category
quantifications (or transformations) and level constraints (which allows
one to treat a variable as nominal, ordinal, or numerical). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">homals(data, ndim = 2, rank = ndim, level = "nominal", sets = 0, active = TRUE, 
       eps = 1e-06, itermax = 1000, verbose = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data in data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Number of dimensions to be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>Which quantification ranks. Default is number of dimensions <code>ndim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Which quantification levels. Possible values are <code>"nominal"</code>,  
<code>"ordinal"</code>, <code>"numerical"</code>, and <code>"polynomial"</code> which can be defined as single 
character (if all variable are of the same level) or as vector which length corresponds to the
number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sets</code></td>
<td>
<p>List of vectors of indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>active</code></td>
<td>
<p>Which variables are active for computation (<code>TRUE</code> means all)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Iteration precision eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>
<p>Maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>0 for no iteration output, 1 prints outer iterations, 2 prints outer and inner iterations, 3 prints outer and inner and innermost iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The general idea of homogeneity analysis is to make a joint plot in p-space of all
objects (or individuals) and the categories of all variables. The technique, in
its most simple form, makes the graph plot in such a way that the sum of squares
of the length of the nm lines is a small as possible, subject to a normalization
of the object scores (their n x p coordinate matrix must be orthonormal).
</p>
<p>Rank constraints require the category quantifications of the categories of
a variable to lie in a subspace of p-space. Requiring rank equal to one for all
variables reduces homogeneity analysis to principal component analysis
(with optimal scaling of the variables). 
</p>
<p>Sets of variables are incorporated by using additivity restrictions on the
category quantifications (i.e. we code the variables within a set interactively,
but then use quantifications based on main effects only). 
</p>
<p>By combining the various types of restrictions we obtain far-reaching
generalizations of principal component analysis, canonical analysis,
discriminant analysis and regression analysis.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"homals"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>datname</code></td>
<td>
<p>Name of the data file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catscores</code></td>
<td>
<p>List of category scores for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoremat</code></td>
<td>
<p>Array containing the reproduced data matrix based on category scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objscores</code></td>
<td>
<p>Matrix with object scores on each dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat.centroids</code></td>
<td>
<p>List of category centroids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.mat</code></td>
<td>
<p>Dummy coded indicator matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>List of loadings of the variables on each dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low.rank</code></td>
<td>
<p>List of lower rank quantifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrim</code></td>
<td>
<p>Matrix with discrimination measures for each variable on each dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>Final eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Value of the loss function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.vec</code></td>
<td>
<p>Vector with ranks for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>active</code></td>
<td>
<p>Vector with active/inactive variables.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jan de Leeuw, Patrick Mair</p>


<h3>References</h3>

<p>de Leeuw, J., &amp; Mair, P. (2009). Gifi methods for optimal scaling in R: The package homals. 
Journal of Statistical Software, 31(4), 1-20, <a href="https://www.jstatsoft.org/v31/i04/">https://www.jstatsoft.org/v31/i04/</a>. 
</p>
<p>Gifi, A. (1990). Nonlinear Multivariate Analysis. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code>plot.homals</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  data(galo)
  
  ##simple homals 2D-homals solution (School not active)
  res &lt;- homals(galo, active = c(rep(TRUE, 4), FALSE))
  
  ##predict IQ 
  res &lt;- homals(galo, active = c(rep(TRUE, 4), FALSE), sets = list(c(1,3,4),2,5))
  
  ##Single ranks for each variable (non-linear PCA)
  res &lt;- homals(galo, active = c(rep(TRUE, 4), FALSE), sets = list(c(1,3,4),2,5))
  
  ##Nonlinear canonical correlation (2 sets of variables)
  res &lt;- homals(galo, active = c(rep(TRUE, 4), FALSE), sets = list(c(1,2),c(3,4),5))
  
  ##regression (linear)
  data(neumann)
  res &lt;- homals(neumann, sets = list(3, 1:2), level = "numerical", rank = 1)
  
  ##regression (monotone)
  res &lt;- homals(neumann, sets = list(3, 1:2), level = "ordinal", rank = 1)
  
  ##3-dimensional senate solution
  data(senate)
  res &lt;- homals(senate, active = c(FALSE, rep(TRUE, 20)), ndim = 3)
  
  ##Predicting Species in iris dataset (polynomial level constraints for predictors)
  data(iris)
  res &lt;- homals(iris, sets = list(1:4,5), level = c(rep("polynomial",4),"nominal"), 
  rank = 2, itermax = 1000)

</code></pre>


</div>