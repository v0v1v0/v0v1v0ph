<div class="container">

<table style="width: 100%;"><tr>
<td>Metropolis_OAAT_adaptive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive One-At-A-Time Metropolis sampler</h2>

<h3>Description</h3>

<p>Performs nsim iterations of the Adaptive version of the OAAT Metropolis sampler
(see ?Metropolis_OAAT).
Adaptation is performed by monitoring move rates every batch.length iterations, and 
increasing / decreasing the jump standard deviation if the move rate is not within specified bounds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Metropolis_OAAT_adaptive(
  f,
  x0,
  sdjump,
  ...,
  batch.length = 100,
  batch.n = 100,
  moverate.min = 0.1,
  moverate.max = 0.5,
  mult.down = 0.9,
  mult.up = 1.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function, log-pdf of the target distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>numeric vector, starting point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdjump</code></td>
<td>
<p>numeric vector, initial standard deviation of the Gaussian jump for each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to f</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch.length</code></td>
<td>
<p>integer, length of each non-adaptive batch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch.n</code></td>
<td>
<p>integer, number of batches (= adaptation period). Total number of simulations is nsim=batch.n*batch.length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moverate.min</code></td>
<td>
<p>numeric in (0;1), lower bound for the desired move rate interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moverate.max</code></td>
<td>
<p>numeric in (0;1), upper bound for the desired move rate interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.down</code></td>
<td>
<p>numeric in (0;1), multiplication factor used to decrease jump size when move rate is too low.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.up</code></td>
<td>
<p>numeric (&gt;1, avoid 1/mult.down) multiplication factor used to increase jump size when move rate is too high.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix nsim*length(x0), MCMC simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>numeric vector, corresponding values f(x)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Bivariate target distribution: beta(0.8,0.4) X exp(1)
f=function(x){stats::dbeta(x[1],0.8,0.4,log=TRUE)+stats::dexp(x[2],log=TRUE)}
x0=c(0.5,2)
sdjump=c(0.5,1)
mcmc=Metropolis_OAAT_adaptive(f,x0,sdjump)
graphicalpar=par(mfrow=c(1,3))
plot(mcmc$x);hist(mcmc$x[,1]); hist(mcmc$x[,2])
par(graphicalpar)
</code></pre>


</div>