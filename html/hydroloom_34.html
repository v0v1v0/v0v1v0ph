<div class="container">

<table style="width: 100%;"><tr>
<td>fix_flowdir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fix Flow Direction</h2>

<h3>Description</h3>

<p>If flowlines aren't digitized in the expected direction,
this will reorder the nodes so they are.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fix_flowdir(id, network = NULL, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>integer The id of the flowline to check</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>data.frame network compatible with hydroloom_names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn_list</code></td>
<td>
<p>list containing named elements <code>flowline</code>, <code>network</code>, and <code>check_end</code>,
where <code>flowline</code> is the flowline to be checked and <code>network</code> the feature up or downstream
of the flowline to be checked, and <code>check_end</code> is <code>"start"</code> or <code>"end"</code> depending if the
<code>network</code> input is upstream (<code>"start"</code>) or downstream (<code>"end"</code>) of the flowline to be checked.
This option allows pre-compilation of pairs of features which may be useful for very large
numbers of flow direction checks.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a geometry for the feature that has been reversed if needed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- sf::read_sf(system.file("extdata/new_hope.gpkg", package = "hydroloom"))

# We add a tocomid with prepare_nhdplus
x &lt;- add_toids(hy(x))

# Look at the end node of the 10th line.
(n1 &lt;- get_node(x[10, ], position = "end"))

# Break the geometry by reversing it.
sf::st_geometry(x)[10] &lt;- sf::st_reverse(sf::st_geometry(x)[10])

# Note that the end node is different now.
(n2 &lt;- get_node(x[10, ], position = "end"))

# Pass the broken geometry to fix_flowdir with the network for toCOMID
sf::st_geometry(x)[10] &lt;- fix_flowdir(x$id[10], x)

# Note that the geometry is now in the right order.
(n3 &lt;- get_node(x[10, ], position = "end"))

plot(sf::st_geometry(x)[10])
plot(n1, add = TRUE)
plot(n2, add = TRUE, col = "blue")
plot(n3, add = TRUE, cex = 2, col = "red")

</code></pre>


</div>