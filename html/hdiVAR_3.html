<div class="container">

<table style="width: 100%;"><tr>
<td>hdVARtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>statistical inference for transition matrix in high-dimensional vector autoregression with measurement error</h2>

<h3>Description</h3>

<p>Conduct global and simultaneous testing on the transition matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdVARtest(
  Y,
  A_est,
  sig2_eta,
  sig2_epsilon,
  global_H0 = NULL,
  global_idx = NULL,
  simul_H0 = NULL,
  simul_idx = NULL,
  FDR_levels = 0.05,
  grid_num = 2000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>observations of time series, a p by T matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A_est</code></td>
<td>
<p>a p by p matrix of transition matrix <code class="reqn">A</code> estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2_eta</code></td>
<td>
<p>scalar; estimate of propagation error variance <code class="reqn">\sigma_\eta^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2_epsilon</code></td>
<td>
<p>scalar;  estimate of measurement error variance <code class="reqn">\sigma_\epsilon^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global_H0</code></td>
<td>
<p>a p by p matrix of global null hypothesis for transition matrix <code class="reqn">A</code>.
If <code>global_H0=NULL</code>, global testing will not be conducted, and <code>global_idx</code> will not be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global_idx</code></td>
<td>
<p>a p by p boolean matrix. The TRUE/nonzero entry indicates the entry of interest
in global hypothesis testing. If <code>global_idx=NULL</code>, all p*p entries are included in global testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simul_H0</code></td>
<td>
<p>a p by p matrix of simultaneous null hypothesis for transition matrix <code class="reqn">A</code>.
If <code>simul_H0=NULL</code>, simultaneous testing will not be conducted, and (<code>simul_idx</code>, <code>FDR_levels</code>, <code>grid_num</code>) will not be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simul_idx</code></td>
<td>
<p>a p by p boolean matrix. The TRUE/nonzero entry indicates the entry of interest
in simultaneous hypothesis testing. If <code>simul_idx=NULL</code>, all p*p entries are included in simultaneous testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR_levels</code></td>
<td>
<p>a vector of FDR control levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_num</code></td>
<td>
<p>scalar; the number of grids for cutoff search in FDR control.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of testing results and gaussian test statistic matrices.
</p>

<table>
<tr>
<td style="text-align: left;">
<code>pvalue</code>  </td>
<td style="text-align: left;">  scalar; p-value of global testing. Exist if <code>global_H0</code> is not NULL. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>global_test_stat</code> </td>
<td style="text-align: left;"> a p by p matrix of gaussian test statistic for global null hypothesis.
Exist if <code>global_H0</code> is not NULL. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>simul_test_stat</code>  </td>
<td style="text-align: left;">  a p by p matrix of gaussian test statistic for simultaneous null hypothesis.
Exist if <code>simul_H0</code> is not NULL. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>FDR_levels</code>  </td>
<td style="text-align: left;"> a vector of FDR control levels. The same as input argument <code>FDR_levels</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>crt</code> </td>
<td style="text-align: left;"> a vector of critical values for rejecting entries in simultaneous hypothesis
under corresponding FDR control levels.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>selected</code> </td>
<td style="text-align: left;"> a three-way tensor. The first two modes are p by p, and the third mode is for FDR control levels.
Nonzero elements indicate rejected entries (the first two modes) in simultanous hypothesis at correspoding FDR control levels (the third mode).
The entries outside of <code>simul_idx</code> is set at zero.

</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Xiang Lyu, Jian Kang, Lexin Li
</p>


<h3>Examples</h3>

<pre><code class="language-R">
p= 3; Ti=200  # dimension and time
A=diag(1,p) # transition matrix
sig_eta=sig_epsilon=0.2 # error std
Y=array(0,dim=c(p,Ti)) #observation t=1, ...., Ti
X=array(0,dim=c(p,Ti)) #latent t=1, ...., T
Ti_burnin=300 # time for burn-in to stationarity
for (t in 1:(Ti+Ti_burnin)) {
  if (t==1){
    x1=rnorm(p)
  } else if (t&lt;=Ti_burnin) { # burn in
    x1=A%*%x1+rnorm(p,mean=0,sd=sig_eta)
  } else if (t==(Ti_burnin+1)){ # time series used for learning
    X[,t-Ti_burnin]=x1
    Y[,t-Ti_burnin]=X[,t-Ti_burnin]+rnorm(p,mean=0,sd=sig_epsilon)
  } else {
    X[,t- Ti_burnin]=A%*%X[,t-1- Ti_burnin]+rnorm(p,mean=0,sd=sig_eta)
    Y[,t- Ti_burnin]=X[,t- Ti_burnin]+rnorm(p,mean=0,sd=sig_epsilon)
  }
}

# null hypotheses are true
hdVARtest(Y,A,sig_eta^2,sig_epsilon^2,global_H0=A,global_idx=NULL,
         simul_H0=A,simul_idx=NULL,FDR_levels=c(0.05,0.1))


# null hypotheses are false
hdVARtest(Y,A,sig_eta^2,sig_epsilon^2,global_H0=matrix(0,p,p),global_idx=NULL,
          simul_H0=matrix(0,p,p),simul_idx=NULL,FDR_levels=c(0.05,0.1))

</code></pre>


</div>