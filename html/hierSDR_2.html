<div class="container">

<table style="width: 100%;"><tr>
<td>hier.phd.nt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main hierarchical SDR fitting function</h2>

<h3>Description</h3>

<p>fits hierarchical SDR models
</p>


<h3>Usage</h3>

<pre><code class="language-R">hier.phd.nt(
  x,
  y,
  z,
  z.combinations,
  d,
  weights = rep(1L, NROW(y)),
  constrain.none.subpop = TRUE,
  pooled = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an n x p matrix of covariates, where each row is an observation and each column is a predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of responses of length n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>an n x C matrix of binary indicators, where each column is a binary variable indicating the presence
of a binary variable which acts as a stratifying variable. Each combination of all columns of <code>z</code> pertains
to a different subpopulation. WARNING: do not use too many binary variables in <code>z</code> or else it will quickly
result in subpopulations with no observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.combinations</code></td>
<td>
<p>a matrix of dimensions 2^C x C with each row indicating a different combination of the possible
values in <code>z</code>. Each combination represents a subpopulation. This is necessary because we need to specify a
different structural dimension for each subpopulation, so we need to know the ordering of the subpopulations so we
can assign each one a structural dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>an integer vector of length 2^C of structural dimensions. Specified in the same order as the rows in
<code>z.combinations</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of observation weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrain.none.subpop</code></td>
<td>
<p>should the "none" subpopulation be constrained to be contained in every other subpopulation's
dimension reduction subspace? Recommended to set to <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pooled</code></td>
<td>
<p>should the estimator be a pooled estimator?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements
</p>

<ul>
<li>
<p> beta a list of estimated sufficient dimension reduction matrices, one for each subpopulation
</p>
</li>
<li>
<p> directions a list of estimated sufficient dimension reduction directions (i.e. the reduced dimension predictors/variables), one for each subpopulation.
These have number of rows equal to the sample size for the subpopulation and number of columns equal to the specified dimensions of the reduced dimension spaces.
</p>
</li>
<li>
<p> y.list a list of vectors of responses for each subpopulation
</p>
</li>
<li>
<p> z.combinations the <code>z.combinations</code> specified as an input
</p>
</li>
<li>
<p> cov list of variance covariance matrices for the covariates for each subpopulation
</p>
</li>
<li>
<p> sqrt.inv.cov list of inverse square roots of the variance covariance matrices for the covariates for each subpopulation. These are used for scaling
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
library(hierSDR)

</code></pre>


</div>