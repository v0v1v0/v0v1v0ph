<div class="container">

<table style="width: 100%;"><tr>
<td>regimes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of regimes models</h2>

<h3>Description</h3>

<p>The function <code>regimes</code> deals with
the estimation of regime models.
Most of the times the variable identifying the regimes
reveals some spatial aspects of the data (e.g., administrative boundaries).
</p>


<h3>Usage</h3>

<pre><code class="language-R">regimes(formula, data, rgv = NULL, vc = c("homoskedastic", "groupwise"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x_f | x_v</code> where <code>y</code> is the dependent variable, <code>x_f</code> are the regressors that do not vary by regimes and  <code>x_v</code> are the regressors that vary by regimes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rgv</code></td>
<td>
<p>an object of class <code>formula</code> to identify the regime variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc</code></td>
<td>
<p>one of <code>c("homoskedastic", "groupwise")</code>. If <code>groupwise</code>, the model VC matrix is estimated by weighted least square.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For convenience and without loss of generality,
we assume the presence of only two regimes.
In this case,
the basic (non-spatial) is:
</p>
<p style="text-align: center;"><code class="reqn">
y
=
\begin{bmatrix}
X_1&amp; 0 \\
0 &amp; X_2 \\
\end{bmatrix}
\begin{bmatrix}
\beta_1 \\
\beta_2 \\
\end{bmatrix}
+ X\beta +
\varepsilon
</code>
</p>

<p>where  <code class="reqn">y = [y_1^\prime,y_2^\prime]^\prime</code>,
and the <code class="reqn">n_1 \times 1</code> vector <code class="reqn">y_1</code> contains the observations
on the dependent variable for the first regime,
and the <code class="reqn">n_2 \times 1</code> vector <code class="reqn">y_2</code> (with <code class="reqn">n_1 + n_2 = n</code>)
contains the observations on the dependent variable for the second regime.
The <code class="reqn">n_1 \times k</code> matrix <code class="reqn">X_1</code> and the <code class="reqn">n_2 \times k</code>
matrix <code class="reqn">X_2</code> are blocks of a block diagonal matrix,
the vectors of parameters  <code class="reqn">\beta_1</code> and <code class="reqn">\beta_2</code> have
dimension <code class="reqn">k_1 \times 1</code> and <code class="reqn">k_2 \times 1</code>, respectively,
<code class="reqn">X</code> is the <code class="reqn">n \times p</code> matrix of regressors that do not vary by regime,
<code class="reqn">\beta</code>  is a <code class="reqn">p\times 1</code> vector of parameters
and <code class="reqn">\varepsilon = [\varepsilon_1^\prime,\varepsilon_2^\prime]^\prime</code>
is the <code class="reqn">n\times 1</code> vector of innovations.
</p>

<ul>
<li>
<p> If <code>vc = "homoskedastic"</code>, the model is estimated by OLS.
</p>
</li>
<li>
<p> If <code>vc = "groupwise"</code>, the model is estimated in two steps.
In the first step, the model is estimated by OLS. In the second step, the
inverse of the (groupwise) residuals from the first step are employed
as weights in a  weighted least square procedure.</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of class <code>lm</code> and <code>spregimes</code>.
</p>


<h3>Author(s)</h3>

<p>Gianfranco Piras and Mauricio Sarrias
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("baltim")
form   &lt;- PRICE  ~ NROOM + NBATH + PATIO + FIREPL + AC + GAR + AGE + LOTSZ + SQFT
split  &lt;- ~ CITCOU
mod &lt;- regimes(formula = form, data = baltim, rgv = split, vc = "groupwise")
summary(mod)
form &lt;- PRICE  ~ AC + AGE + NROOM + PATIO + FIREPL + SQFT | NBATH + GAR + LOTSZ - 1
mod &lt;- regimes(form, baltim, split, vc = "homoskedastic")
summary(mod)


</code></pre>


</div>