<div class="container">

<table style="width: 100%;"><tr>
<td>SimulateGeoHiSSE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate under a GeoHiSSE model</h2>

<h3>Description</h3>

<p>Simulation function for the GeoHiSSE model</p>


<h3>Usage</h3>

<pre><code class="language-R">SimulateGeoHiSSE(pars, hidden.traits=1, x0="0A", max.taxa=Inf,
max.time=Inf, add.jumps=FALSE, add.extinction=FALSE, 
include.extinct=FALSE, return.GeoHiSSE_pars=FALSE, 
override.safeties=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>an object of class "GeoHiSSE_pars" generated by
<code>SimulateGeoHiSSE</code>. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden.traits</code></td>
<td>
<p>number of hidden areas in the model. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a character value for the starting state. Default is "01A".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.taxa</code></td>
<td>
<p>have the simulation stop at <code>max.taxa</code> surviving taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.time</code></td>
<td>
<p>have the simulation stop at <code>max.time</code> height
(including stem).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.GeoHiSSE_pars</code></td>
<td>
<p>whether to (only) return a "GeoHiSSE_pars" object
in the correct format to use in this function. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.jumps</code></td>
<td>
<p>whether to include jump dispersals in the model. Both
for returning the parameters of the model and model
estimation. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.extinction</code></td>
<td>
<p>whether to separate extirpation and extinction of
endemic lineages. Both for returning the parameters of the model and model
estimation. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.extinct</code></td>
<td>
<p>whether the simulation should keep extinct
lineages. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>override.safeties</code></td>
<td>
<p>simulate even if there is no limit on number of
taxa or depth of tree.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses <code>diversitree::tree.classe</code> function to simulate
the tree under the GeoSSE model with hidden states. The parameter
<code>pars</code> is a list of class "GeoHiSSE_pars" that can be generated
using this same function. The best way is to first run
<code>SimulateGeoHiSSE</code> with empty parameters and
<code>return.GeoHiSSE_pars=TRUE</code> and with <code>hidden.areas</code> equal to
the number of desired hidden states in the model. This will return an
object in list format with a set of four matrices. Each matrix controls
a different set of parameters of the model. All parameters are set to 0
and parameters not used by the model are set to NA. To prepare the
simulation, edit these matrices and change the desired parameter
values. Leaving a parameter equal to 0 is the same as reducing the model
by eliminating this parameter of the model.
</p>


<h3>Value</h3>

<p>This returns a list, with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$phy</code></td>
<td>
<p>a phylogeny of class phylo.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$data</code></td>
<td>
<p>a data matrix with the species names as the first
column and the ranges (in 0, 1, and 2 format) as the second column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$hidden.states</code></td>
<td>
<p>a named vector with the 'true' simulated ranges
(include the hidden state information).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$sim.attempts</code></td>
<td>
<p>number of times that the simulation tried
before reaching desired termination condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$pars</code></td>
<td>
<p>the parameters used for the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$classe.pars</code></td>
<td>
<p>the parameters in 'make.classe' format for 
the 'diversitree' package.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel Caetano</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Get the a list with the correct parameters to run the simulation:
pars &lt;- SimulateGeoHiSSE(hidden.areas=1, return.GeoHiSSE_pars=TRUE)
## Edit the parameter values:
pars$model.pars[1:3,] &lt;- 0.1
pars$model.pars[4:5,] &lt;- 0.05
pars$model.pars[6:7,] &lt;- 0.01
pars$q.01[1,2] &lt;- pars$q.01[2,1] &lt;- 0.01
pars$q.1[1,2] &lt;- pars$q.1[2,1] &lt;- 0.02
pars$q.2[1,2] &lt;- pars$q.2[2,1] &lt;- 0.02
## Run the simulation:
sim &lt;- SimulateGeoHiSSE(pars=pars, hidden.areas=1, x0="01A", max.taxa=100)

## End(Not run)
</code></pre>


</div>