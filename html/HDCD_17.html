<div class="container">

<table style="width: 100%;"><tr>
<td>single_CUSUM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CUSUM transformation of matrix at a specific position</h2>

<h3>Description</h3>

<p>R wrapper for C function computing the CUSUM transformation of matrix over an interval <code class="reqn">(s,e]</code> evaluated at a specific position. For compatibility with C indexing, the user should subtract <code class="reqn">1</code> from <code class="reqn">s</code>, <code class="reqn">e</code> and <code class="reqn">v</code> when supplying the arguments to the function. If start and stop are not supplied, the CUSUM is computed over the full data, so <code class="reqn">(s,e] = (0,n]</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">single_CUSUM(X, start = NULL, stop = NULL, pos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of observations, where each row contains a time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Starting point of interval over which the CUSUM should be computed, subtracted by one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>Ending point of interval over which the CUSUM should be computed, subtracted by one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>Position at which the CUSUM should be evaluated, subtracted by one</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of CUSUM values, each corresponding to a row of the input matrix. The <code class="reqn">i</code>-th element corresponds to the CUSUM transformation of the <code class="reqn">i</code>-th row of <code class="reqn">X</code>, computed over the interval <code class="reqn">(\code{start}+1,\code{end}+1]</code> and evaluated at position <code class="reqn">\code{pos}</code>, i.e. 
<code class="reqn">\sqrt{\frac{e-v}{(e-s)(v-s)}}\sum_{t=s+1}^v X_{i,t} - \sqrt{\frac{v-s}{(e-s)(e-v)}}\sum_{t=v+1}^e X_{i,t}</code>, 
where <code class="reqn">s = (\code{start}+1)</code>, <code class="reqn">e = (\code{stop}+1)</code> and <code class="reqn">v = \code{pos}+1</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 10
p = 10
set.seed(101)
X = matrix(rnorm(n*p), ncol = n, nrow=p)
# CUSUM over the full data (s,e] = (0,n] evaluated at position v=4
position = 4
X_cusum_single = single_CUSUM(X,pos = position-1)
X_cusum_single

# verifying that this corresponds to the 4-th row of output of CUSUM():
X_cusum = CUSUM(X)
X_cusum[,4]
</code></pre>


</div>