<div class="container">

<table style="width: 100%;"><tr>
<td>LOO_preds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Leave one out predictions</h2>

<h3>Description</h3>

<p>Provide leave one out predictions, e.g., for model testing and diagnostics. 
This is used in the method plot available on GP and TP models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LOO_preds(model, ids = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>homGP</code> or <code>hetGP</code> model, TP version is not considered at this point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>vector of indices of the unique design point considered (default to all)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with mean and variance predictions at x_i assuming this point has not been evaluated
</p>


<h3>Note</h3>

<p>For TP models, <code>psi</code> is considered fixed.
</p>


<h3>References</h3>

<p>O. Dubrule (1983), Cross validation of Kriging in a unique neighborhood, Mathematical Geology 15, 687–699. <br><br></p>
<p>F. Bachoc (2013), Cross Validation and Maximum Likelihood estimations of hyper-parameters of Gaussian processes 
with model misspecification, Computational Statistics &amp; Data Analysis, 55–69.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(32)
## motorcycle data
library(MASS)
X &lt;- matrix(mcycle$times, ncol = 1)
Z &lt;- mcycle$accel
nvar &lt;- 1

## Model fitting
model &lt;- mleHomGP(X = X, Z = Z, lower = rep(0.1, nvar), upper = rep(10, nvar),
                  covtype = "Matern5_2", known = list(beta0 = 0))
LOO_p &lt;- LOO_preds(model)
 
# model minus observation(s) at x_i
d_mot &lt;- find_reps(X, Z)

LOO_ref &lt;- matrix(NA, nrow(d_mot$X0), 2)
for(i in 1:nrow(d_mot$X0)){
 model_i &lt;- mleHomGP(X = list(X0 = d_mot$X0[-i,, drop = FALSE], Z0 = d_mot$Z0[-i],
                     mult = d_mot$mult[-i]), Z = unlist(d_mot$Zlist[-i]),
                     lower = rep(0.1, nvar), upper = rep(50, nvar), covtype = "Matern5_2",
                     known = list(theta = model$theta, k_theta_g = model$k_theta_g, g = model$g,
                                  beta0 = 0))
 model_i$nu_hat &lt;- model$nu_hat
 p_i &lt;- predict(model_i, d_mot$X0[i,,drop = FALSE])
 LOO_ref[i,] &lt;- c(p_i$mean, p_i$sd2)
}

# Compare results

range(LOO_ref[,1] - LOO_p$mean)
range(LOO_ref[,2] - LOO_p$sd2)

# Use of LOO for diagnostics
plot(model)
</code></pre>


</div>