<div class="container">

<table style="width: 100%;"><tr>
<td>FTGramImage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display Fourier spectrogram</h2>

<h3>Description</h3>

<p>This function displays a Fourier spectrogram using the same plot structure and options as <code>HHGramImage</code>.
It uses the function <code>EvolutiveFFT</code> to generate a spectrogram, then wraps it in the same plotting format as <code>HHGramImage</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FTGramImage(sig, dt, ft, time.span = NULL, freq.span = NULL, 
     amp.span = NULL, taper=0.05, scaling = "none", grid=TRUE, 
    colorbar=TRUE, backcol=c(0, 0, 0), colormap=NULL, pretty=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>The signal to process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>sample rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft</code></td>
<td>
<p>Fourier spectrogram options</p>
</td>
</tr>
</table>
<ul>
<li>
<p><code>ft$nfft</code> is the fft length
</p>
</li>
<li>
<p><code>ft$ns</code> is the number of samples in a window
</p>
</li>
<li>
<p><code>ft$nov</code> is the number of samples to overlap</p>
</li>
</ul>
<table>
<tr style="vertical-align: top;">
<td><code>time.span</code></td>
<td>
<p>Time span to render spectrogram over.  <code>NULL</code> will draw the spectrogram over the entire signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.span</code></td>
<td>
<p>Frequency span to render spectrogram over.  <code>NULL</code> plots everything up to the Nyquist frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp.span</code></td>
<td>
<p>Amplitude range to plot.  <code>NULL</code> plots everything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>Taper value to use for spectrogram (default is 0.05), see <code>spec.taper</code> in the <code>base</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>determines whether to apply logarithmic (log), or square root (sqrt) scaling to the amplitude data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Boolean - whether to display grid lines or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorbar</code></td>
<td>
<p>Boolean - whether to display amplitude colorbar or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backcol</code></td>
<td>
<p>What background color to use behind the spectrogram, in a 3 element vector: <code>c(red, green, blue)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colormap</code></td>
<td>
<p>What palette object to use for the spectrogram, defaults to <code>rainbow</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pretty</code></td>
<td>
<p>Boolean - choose nice axes values, some adjustment may result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>This function supports some optional parameters as well:
</p>

<ul>
<li>
<p>trace.format - the format of the trace minima and maxima in sprintf format
</p>
</li>
<li>
<p>img.x.format - the format of the X axis labels of the image in sprintf format
</p>
</li>
<li>
<p>img.y.format - the format of the Y axis labels of the image in sprintf format
</p>
</li>
<li>
<p>colorbar.format - the format of the colorbar labels in sprintf format
</p>
</li>
<li>
<p>cex.lab - the font size of the image axis labels
</p>
</li>
<li>
<p>cex.colorbar - the font size of the colorbar
</p>
</li>
<li>
<p>cex.trace - the font size of the trace axis labels
</p>
</li>
<li>
<p>img.x.lab - the X - axis label of the image, it defaults to "time"
</p>
</li>
<li>
<p>img.y.lab- the Y - axis label of the image, it defaults to "frequency"
</p>
</li>
<li>
<p>main - figure title</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a simple Fourier spectrogram plotter.
It's useful to compare this image with images generated by <code>HHGramImage</code> to see how the Fourier and Hilbert spectrograms differ.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>img</code></td>
<td>
<p>The spectrogram image, suitable for plotting with the generic <code>image</code> function</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Daniel Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a></p>


<h3>References</h3>

<p>Jonathan M. Lees (2012). RSEIS: Seismic Time Series Analysis Tools. R
package version 3.0-6. http://CRAN.R-project.org/package=RSEIS</p>


<h3>See Also</h3>

<p><code>HHGramImage</code>, <code>EvolutiveFFT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PortFosterEvent)

dt &lt;- mean(diff(tt))

ft &lt;- list()
ft$nfft &lt;- 4096
ft$ns &lt;- 30
ft$nov &lt;- 29

time.span &lt;- c(5, 10)
freq.span &lt;- c(0, 25)
amp.span &lt;- c(1e-5, 0.0003)
FTGramImage(sig, dt, ft, time.span = time.span, freq.span = freq.span, 
    amp.span = amp.span, pretty = TRUE, img.x.format = "%.1f",
    img.y.format = "%.0f",
    main = "Port Foster Event - Fourier Spectrogram")
</code></pre>


</div>