<div class="container">

<table style="width: 100%;"><tr>
<td>haplo.ccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Haplotype Relative Risks in Case-Control Data</h2>

<h3>Description</h3>

<p>'haplo.ccs' estimates haplotype and covariate relative risks in
case-control data by weighted logistic regression. Diplotype
probabilities, which are estimated by EM computation with progressive
insertion of loci, are utilized as weights. The model is specified by
a symbolic description of the linear predictor, which includes
specification of an allele matrix, inheritance mode, and preferences
for rare haplotypes using 'haplo'. Note that use of this function
requires installation of the 'haplo.stats' and 'survival'
packages. See 'haplo.em' for a description of EM computation of
diplotype probabilities. Currently missing genotype information is not
allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
haplo.ccs(formula, data=NULL, ...)

haplo.ccs.fit(y, x, int, geno, inherit.mode, group.rare, rare.freq, 
              referent, names.x, names.int, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit, which
requires specification of an allele matrix and inheritance mode
using 'haplo'. Note that 'additive' is the default inheritance mode
for 'haplo'. Preferences for grouping rare haplotypes are also
specified using 'haplo'. Note that by default 'haplo' groups
haplotypes with an estimated population frequency less than
0.02. More details on model formulae are given below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list, or environment (or object
coercible by 'as.data.frame' to a data frame) containing the
variables in the model. If not found in 'data', the variables are
taken from 'environment(formula)', typically the environment from
which 'haplo.ccs' is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>referent</code></td>
<td>
<p>a character string representing the haplotype to be used
as the referent. The haplotype with the highest estimated population
frequency is the default referent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional model-fitting arguments to be passed to 'glm'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the design matrix for environmental covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>the design matrix for haplotype-environment interaction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno</code></td>
<td>
<p>the allele matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inherit.mode</code></td>
<td>
<p>the inheritance mode specified by 'haplo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.rare</code></td>
<td>
<p>a logical value indicating whether rare haplotypes
should be grouped, specified by 'haplo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rare.freq</code></td>
<td>
<p>the population haplotype frequency used to define the
rare haplotypes, specified by 'haplo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.x</code></td>
<td>
<p>the column names of the design matrix for covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.int</code></td>
<td>
<p>the column names of the design matrix for
haplotype-environment interaction.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A formula has the form 'y ~ terms' where 'y' is a numeric vector
indicating case-control status and 'terms' is a series of terms which
specifies a linear predictor for 'y'. A terms specification of the
form 'first + second' indicates all the terms in 'first' together with
all the terms in 'second' with duplicates removed. The terms in the
formula will be re-ordered so that main effects come first, followed
by the interactions, all second-order, all third-order and so on. The
specification 'first*second' indicates the cross of 'first' and
'second'.
</p>
<p>Note that 'haplo.ccs.fit' is the workhorse function. The inputs 'y',
'x', 'geno', and 'int' represent case-control status, the matrix of
covariates, the matrix of alleles, and the matrix of terms that have
interaction with the haplotypes to be estimated from the alleles. The
argument 'inherit.mode' corresponds to the inheritance mode specified
by 'haplo', and the arguments 'group.rare' and 'rare.freq' correspond
to the preferences for grouping rare haplotypes specified by
'haplo'. 'names.x' and 'names.int' correspond to the column names of
'x' and 'int', respectively. The background functions 'one',
'count.haps', and 'return.haps' are used in specifying the model terms
and neatly packaging the results.
</p>


<h3>Value</h3>

<p>'haplo.ccs' returns an object of class inheriting from
'"haplo.ccs"'. More details appear later in this section. The function
'summary' (i.e., 'summary.haplo.ccs') obtains or prints a summary of
the results, which include haplotype and covariate relative risks,
robust standard error estimates, and estimated haplotype
frequencies. The generic accessory functions 'coefficients',
'fitted.values', and 'residuals' extract corresponding features of the
object returned by 'haplo.ccs'. The function 'vcov' (i.e.,
'vcov.haplo.ccs') returns sandwich variance-covariance estimates. The
function 'haplo.freq' extracts information returned by the EM
computation of haplotype frequencies. Note that if rare haplotypes are
grouped, then their individual estimated frequencies are summed. An
object of class '"haplo.ccs"' is a list containing at least the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>a named matrix of sandwich variance-covariance
estimates, computed using 'sandcov'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the working residuals, i.e., the residuals from the
final iteration of the IWLS fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming
the linear predictors by the expit function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>the linear fit on the logit scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the model degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family object, in this case, quasibinomial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations of IWLS used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the working weights, i.e., the weights from the final
iteration of the IWLS fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.weights</code></td>
<td>
<p>the weights initially supplied, in this case, the
diplotype probabilities estimated by the EM computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector indicating case-control status, expanded for each
subject by the number of plausible diplotypes for that subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>the numeric vector used to identify subjects, expanded for
each subject by the number of plausible diplotypes for that
subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>a logical indicating whether the IWLS fit converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>a logical indicating whether the fitted values are on
the boundary of the attainable values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>the offset vector used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>the contrasts used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>a record of the levels of the factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inheritance.mode</code></td>
<td>
<p>the method of inheritance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rare.freq</code></td>
<td>
<p>the value used to define the rare haplotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.lnlike</code></td>
<td>
<p>the value of the log likelihood at the last EM
iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.lr</code></td>
<td>
<p>the likelihood ratio statistic used to test the assumed
model against the model that assumes complete linkage equilibrium
among all loci.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.df.lr</code></td>
<td>
<p>the degrees of freedom for the likelihood ratio
statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.nreps</code></td>
<td>
<p>the count of haplotype pairs that map to
each subject's marker genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hap1</code></td>
<td>
<p>character strings representing the possible first
haplotype for each subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hap2</code></td>
<td>
<p>character strings representing the possible second
haplotype for each subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hap.names</code></td>
<td>
<p>character strings representing the unique
haplotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hap.probs</code></td>
<td>
<p>the estimated frequency of each unique
haplotype. Note that if rare haplotypes are grouped, then their
individual estimated frequencies are summed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.converged</code></td>
<td>
<p>a logical indicating whether the EM computation
converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.nreps</code></td>
<td>
<p>the number of haplotype pairs that map to the marker
genotypes for each subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.max.pairs</code></td>
<td>
<p>the maximum number of pairs of haplotypes per
subject that are consistent with their marker data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.control</code></td>
<td>
<p>a list of control parameters for the EM computation.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The functions 'anova', 'logLik', and 'AIC' are not appropriate for
models of class '"haplo.ccs"', because 'haplo.ccs' does not fit by maximum
likelihood. Accordingly, model and null deviance are not reported.
</p>


<h3>Author(s)</h3>

<p>Benjamin French and Thomas Lumley, University of Washington
</p>


<h3>References</h3>

<p>French B, Lumley T, Monks SA, Rice KM, Hindorff LA, Reiner AP, Psaty
BM. Simple estimates of haplotype relative risks in case-control
data. Genetic Epidemiology 2006; 30(6):485-494.
</p>
<p>The help files for 'glm', 'haplo.em', and 'haplo.glm' were
instrumental in creating this help file.
</p>


<h3>See Also</h3>

<p><code>glm</code>,
<code>haplo</code>,
<code>haplo.em</code>,
<code>haplo.glm</code>,
<code>sandcov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(renin)

## Fit a model for haplotype effects.

haplo.ccs(case ~ haplo(geno))

## Fit a model for haplotype and covariate effects.

haplo.ccs(case ~ gender + age + factor(race) + haplo(geno))

## Fit a model for haplotype interaction with gender.

haplo.ccs(case ~ age + factor(race) + gender*haplo(geno))

</code></pre>


</div>