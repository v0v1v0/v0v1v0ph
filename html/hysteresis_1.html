<div class="container">

<table style="width: 100%;"><tr>
<td>hysteresis-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Modeling Rate-Dependent Hysteretic Processes
</h2>

<h3>Description</h3>

<p>Fit, summarize and plot sinusoidal hysteretic processes using two step harmonic least squares. If the process is elliptical, other methods such as a geometric method, Halir and Flusser's direct specific least squares, ordinary least squares,
and ellipse-specific non-linear least squares are also available.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> hysteresis</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 2.7.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-02-26</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> gpl (&gt;= 2)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Fits input and output variables x and y that form a hysteresis loop based on the generalized transcendental equation </p>
<p style="text-align: center;"><code class="reqn">x_t=b.x*cos(2pi*t/period+phase.angle)+cx+e_{x,t}</code>
</p>
 <p style="text-align: center;"><code class="reqn">y_t=b.y*cos(2pi*t/period+phase.angle)^n+retention*sin(2pi*t/period+phase.angle)^m+cy+e_{y,t}</code>
</p>
<p>  where </p>
<p style="text-align: center;"><code class="reqn">t=0,...,n.points-1 if times='equal'</code>
</p>
 
<p>The functions <code>mloop</code> and <code>floop</code> can be used to simulate, fit, and obtain derived parameter estimates (see <code>loop.parameters</code> or <code>ellipse.parameters</code> ) along with delta method standard errors for hysteresis loops.. Additionally <code>summary.fittedloop</code> can be used to bootstrap results in order to produce less biased standard errors for derived parameters and obtain a model fit that is not dependent on the assumption of independent and normally distributed errors.
If m=1 and n=1 then the hysteresis loop will form an ellipse which can be simulated with <code>mel</code>, fitted using 5 different available methods with <code>fel</code>, and bootstrapped using the function method <code>summary.ellipsefit</code>.
If the upper and lower halves of the loop are structered differently, then the functions <code>mloop2r</code>, <code>floop2r</code> and <code>summary.loop2r</code> should be used. These functions fit a model with two values of retention for when the curve is above and below the split line.
Studentized residuals are also available ((see <code>residuals.ellipsesummary</code>).
</p>


<h3>Author(s)</h3>

<p>Spencer Maynes, Fan Yang, and Anne Parkhurst.
</p>
<p>Maintainer: Spencer Maynes &lt;smaynes89@gmail.com&gt;
</p>


<h3>References</h3>

<p>Yang, F and A. Parkhurst, "Efficient Estimation of Elliptical Hysteresis with 
Application to the Characterization of Heat Stress" DOI:10.1007/s13253-015-0213-6
</p>


<h3>See Also</h3>

<p>Check out the vignette browseURL(system.file('doc/index.html',package='hysteresis')) <br>
For simulating hysteresis loops, <code>mloop</code> and <code>mel</code>. <br>
For fitting hysteresis loops, <code>floop</code> and <code>fel</code>. <br>
For summarizing hysteresis loops, <code>summary.fittedloop</code> and <code>summary.ellipsefit</code>. <br>
For bootstrapping ellipses, <code>summary.ellipsefit</code>.
For fitting multiple hysteresis loops at once, can use <code>fel</code> and <code>floop</code> or <code>fel.repeated</code> and <code>floop.repeated</code> which can be easier to use for studies involving repeated measures. <br>
Miscellaneous <code>plot.ellipsefit</code>, <code>plot.ellipsefitlist</code>, <code>plot.ellipsesummary</code>, <code>residuals.ellipsesummary</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###Take a look at the vignette.
#browseURL(system.file('doc/index.html',package='hysteresis'))

### Simulate and fit a hysteresis loop with m=3 and n=5.
 loop1 &lt;- mloop(sd.x=0.05,sd.y=0.05,n=5,m=3)
 model &lt;- floop(loop1$x,loop1$y,n=5,m=3)
 model                #Gives estimate with delta standard errors
 model$Estimates      #Gives estimates  
 model$Std.Errors     #Lists delta standard errors  
 
### Plot hysteresis loop.
 plot(model,main="Simulated Hysteresis Loop n=5 m=3")

### Bootstrap estimates and standard errors (Seed is necessary if want to reproduce results)
 booted.loop &lt;- floop(loop1$x,loop1$y,,n=5,m=3,boot=TRUE, seed=1523)
 booted.loop                   #Gives boot estimates, boot bias, boot SE and boot quartiles
 booted.loop$Boot.Estimates    #Gives boot estimates 
 booted.loop$Boot.Std.Errors   #Gives boot standard errors 
plot(booted.loop,main="Simulated Bootstrapped Loop n=5, m=3",putNumber=TRUE)


### Simulate and fit an ellipse.
ellipse1 &lt;- mel(sd.x=0.2,sd.y=0.04)
ellipse1.fit &lt;- fel(ellipse1$x,ellipse1$y)
ellipse1.fit             #Gives estimates with delta standard errors and 95%CI
ellipse1.fit$Estimates      #Gives all estimates 
ellipse1.fit$Std.Errors     #Lists delta standard errors  

### Plot ellipse
plot(ellipse1.fit,xlab="Input",ylab="Output",main="Simulated Ellipse")

### Bootstrap estimates and standard errors (Seed is necessary if want to reproduce results)
booted.ellipse &lt;- fel(ellipse1$x,ellipse1$y,boot=TRUE, seed=123)
booted.ellipse                 #Gives boot estimates, boot bias, boot SE and boot quartiles
booted.ellipse$Boot.Estimates  #Gives boot estimates   
booted.ellipse$Boot.Std.Errors #Gives boot standard errors

</code></pre>


</div>