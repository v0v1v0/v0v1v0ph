<div class="container">

<table style="width: 100%;"><tr>
<td>detect_idiosyncratic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>detect_idiosyncratic</h2>

<h3>Description</h3>

<p>Test for systematic treatment effect heterogeneity using Fisherian
permutation inference methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_idiosyncratic(formula, data, interaction.formula,
  control.formula, plugin, tau.hat, test.stat, te.vec, B, gamma, grid.gamma,
  grid.size, return.matrix, na.rm, n.cores, verbose, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class formula, as in lm(), such as Y ~ Z with
only the treatment variable on the right-hand side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, tbl_df, or data.table with the input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction.formula</code></td>
<td>
<p>A right-sided formula with pre-treatment
covariates to model treatment effects for on the right hand side, such as ~
x1 + x2 + x3. Defaultis NULL (no interactions modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.formula</code></td>
<td>
<p>A right-sided formula with pre-treatment covariates to
adjust for on the right hand side, such as ~ x1 + x2 + x3. Default is NULL
(no variables adjusted for)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plugin</code></td>
<td>
<p>Whether to calculate the plug-in p-value without sweeping over
range of possible treatment effect magnitudes. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.hat</code></td>
<td>
<p>The value of the plug-in treatment effect. Default is sample
average treatment effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.stat</code></td>
<td>
<p>Test statistic function to use on the data. Default is
shifted Kolmogorov-Smirnov statistic, potentially with covariate adjustment
depending on passed arguments.  test.stat can be a string name for a test statistic function, or the function itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>te.vec</code></td>
<td>
<p>Vector of taus to examine if you want to override generating
ones automatically. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of permutations to take. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>How wide of a CI to make around tau-hat for search. Default is
0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.gamma</code></td>
<td>
<p>Parameter to govern where the grid points are sampled.
Bigger values means more samples towards the estimated tau-hat. Default is
100*gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.size</code></td>
<td>
<p>Number of points in the grid. Default is 151.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.matrix</code></td>
<td>
<p>Whether to return the matrix of all the imputed
statistics.  Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A logical flag indicating whether to list-wise delete missing
data. The function will report an error if missing data exist. Default is
FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>Number of cores to use to parallelize permutation step.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to print out progress bar when fitting and other
diagnostics. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments passed to the generate.permutations function and
test.stat functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If plug-in, the value of the test and the associated p-value. If not,
a list with the value of the test statistic on the observed data, the value
of the CI-adjusted p-value, the plug-in p-value, and other information on
the test.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Z &lt;- rep(c(0, 1), 100)
tau &lt;- 4
Y &lt;- ifelse(Z, rnorm(100, tau), rnorm(100, 0))
df &lt;- data.frame(Y=Y, Z=Z)
tst &lt;- detect_idiosyncratic(Y ~ Z, df, B = 50, grid.size = 50)
</code></pre>


</div>