<div class="container">

<table style="width: 100%;"><tr>
<td>glm.logml.napp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log marginal likelihood of a GLM under normalized asymptotic power prior (NAPP)</h2>

<h3>Description</h3>

<p>Uses bridge sampling to estimate the logarithm of the marginal likelihood of a GLM under the
normalized asymptotic power prior (NAPP).
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.logml.napp(post.samples, bridge.args = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>post.samples</code></td>
<td>
<p>output from <code>glm.napp()</code> giving posterior samples of a GLM under the normalized asymptotic
power prior (NAPP), with an attribute called 'data' which includes the list of variables
specified in the data block of the Stan program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bridge.args</code></td>
<td>
<p>a <code>list</code> giving arguments (other than <code>samples</code>, <code>log_posterior</code>, <code>data</code>, <code>lb</code>, and <code>ub</code>) to
pass onto <code>bridgesampling::bridge_sampler()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a <code>list</code> with the following objects
</p>

<dl>
<dt>model</dt>
<dd>
<p>"NAPP"</p>
</dd>
<dt>logml</dt>
<dd>
<p>the estimated logarithm of the marginal likelihood</p>
</dd>
<dt>bs</dt>
<dd>
<p>an object of class <code>bridge</code> or <code>bridge_list</code> containing the output from using <code>bridgesampling::bridge_sampler()</code>
to compute the logarithm of the marginal likelihood of the normalized asymptotic power prior (NAPP)</p>
</dd>
</dl>
<h3>References</h3>

<p>Ibrahim, J. G., Chen, M., Gwon, Y., and Chen, F. (2015). The power prior: Theory and applications. Statistics in Medicine, 34(28), 3724â€“3749.
</p>
<p>Gronau, Q. F., Singmann, H., and Wagenmakers, E.-J. (2020). bridgesampling: An r package for estimating normalizing constants. Journal of Statistical Software, 92(10).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (instantiate::stan_cmdstan_exists()) {
  data(actg019)
  data(actg036)
  ## take subset for speed purposes
  actg019 = actg019[1:100, ]
  actg036 = actg036[1:50, ]
  data_list = list(currdata = actg019, histdata = actg036)
  formula = cd4 ~ treatment + age + race
  family = poisson('log')
  d.napp = glm.napp(
    formula = formula, family = family,
    data.list = data_list,
    chains = 1, iter_warmup = 500, iter_sampling = 1000
  )
  glm.logml.napp(
    post.samples = d.napp,
    bridge.args = list(silent = TRUE)
  )
}
</code></pre>


</div>