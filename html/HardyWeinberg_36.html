<div class="container">

<table style="width: 100%;"><tr>
<td>HWEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of contributions of two populations to a sample of genotype frequencies with the EM algorithm.
</h2>

<h3>Description</h3>

<p>Function <code>HWEM</code> estimates the relative contributions of two populations with different allele frequencies that contributed
to the genotype frequencies of sample which is a mixture of these two populations. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">HWEM(x, p = NULL, G = NULL, delta.init = c(0.5, 0.5), itmax = 50,
     eps = 1e-06, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a 3x1 vector of genotype frequencies of the mixed sample, either counts or proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector with two allele frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>a 3x2 matrix with genotype frequencies as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.init</code></td>
<td>
<p>initial values for the contributions of each populations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>tolerance criterion for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>verbose = TRUE</code> prints results, <code>verbose = FALSE</code> is silent.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>HWEM</code> employs the EM algorithm to estimate the contribution of two populations to the genotype frequencies of a bi-allelic
marker, assumed to be typed for a mixed sample with individuals coming from two different populations with different allele
frequencies. To estimate the contributions, both the mixed sample genotype frequencies (x) and either the genotype frequencies (G)
or the allele frequencies (p) of the original populations must be specified. In case only allele frequencies are specified,
Hardy-Weinberg proportions are assumed for the genotype frequencies. 
</p>


<h3>Value</h3>

<p>a vector with two proportions, ordered according to the specified allele or genotype frequencies.</p>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

<p>Dempster, A.P., Laird, N.M. and Rubin, D.B. (1977) Maximum Likelihood from Incomplete Data via the EM Algorithm. Journal of the Royal
Statistical Society. Series B (Methodological) 39(1) pp. 1â€“38.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># genotype frequencies population 1
g1 &lt;- c(0.034, 0.330, 0.636)
# genotype frequencies population 2
g2 &lt;- c(0.349, 0.493, 0.158)
# sample from the mixed population
x  &lt;- c(0.270, 0.453,0.277)
#
# estimation based on genotype frequencies
#
G &lt;- cbind(g1,g2)
contributions &lt;- HWEM(x,G=G)
#
# estimation based on allele frequencies
#
p &lt;- c(af(g1),af(g2))
contributions &lt;- HWEM(x,p=p)
</code></pre>


</div>