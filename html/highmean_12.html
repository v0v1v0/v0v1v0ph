<div class="container">

<table style="width: 100%;"><tr>
<td>epval_Chen2010</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Chen and Qin (2010)
</h2>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen and Qin (2010) based on permutation or parametric bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">epval_Chen2010(sam1, sam2, eq.cov = TRUE, n.iter = 1000, cov1.est, cov2.est,
               bandwidth1, bandwidth2, cv.fold = 5, norm = "F", seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. If <code>eq.cov</code> is <code>TRUE</code>, the permutation method is used to calculate p-values; otherwise, the parametric bootstrap resampling is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation/resampling iterations. The default is 1,000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov1.est</code></td>
<td>

<p>This and the following arguments are only effective when <code>eq.cov = FALSE</code> and the parametric bootstrap resampling is used to calculate p-values. This argument specifies a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov1.est</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth1</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This argument is effective when <code>cov1.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth1</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code>norm</code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the details in <code>apval_Chen2010</code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation or parametric bootstrap resampling.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Chen and Qin (2010).
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bickel PJ and Levina E (2008). "Regularized estimation of large covariance matrices." <em>The Annals of Statistics</em>, <b>36</b>(1), 199–227.
</p>
<p>Chen SX and Qin YL (2010). "A two-sample test for high-dimensional data with applications to gene-set testing." <em>The Annals of Statistics</em>, <b>38</b>(2), 808–835.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>


<h3>See Also</h3>

<p><code>apval_Chen2010</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error.
#epval_Chen2010(sam1, sam2, n.iter = 10)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
# increase n.iter to reduce Monte Carlo error
#epval_Chen2010(sam1, sam2, eq.cov = FALSE, n.iter = 10,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>


</div>