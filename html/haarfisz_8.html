<div class="container">

<table style="width: 100%;"><tr>
<td>hft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>hft</h2>

<h3>Description</h3>

<p>Performs the (forward) Haar-Fisz transform. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">hft(data)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A vector of Poisson counts, its length must be a power of 2</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The Haar-Fisz for Poisson works, roughly speaking, by taking
the Haar wavelet transform of <code>data</code>. Then dividing the
mother wavelet coefficients by the respective father coefficients,
and replacing the results of the divisions back into the same
coefficient locations, and then carrying out an inverse
Haar wavelet transform. This produces a nearer-Gaussian variance
stabilized version of the original (or a version of the underlying
intensity which is close to an 'intensity PLUS homogeneous
Gaussian noise' signal, which is easier to denoise using ‘standard’
methods.
</p>
<p>The inverse transform is <code>hft.inv</code></p>


<h3>Value</h3>

<p>The Haar-Fisz transform of <code>data</code>, which will be the same
length as <code>data</code>. 
</p>


<h3>Author(s)</h3>

<p>Piotr Fryzlewicz</p>


<h3>References</h3>

<p>Fryzlewicz, P. and Nason, G.P. (2004) A Haar-Fisz algorithm for Poisson
intensity estimation.
<em>Journal of Computational and Graphical Statistics</em>,
<b>13</b>, 621-638. <a href="https://doi.org/10.1198/106186004X2697">doi:10.1198/106186004X2697</a>
</p>


<h3>See Also</h3>

<p><code>denoise.poisson</code>,
<code>hft.inv</code>,
<code>hf.bt</code>,
<code>hf.cv</code>,
<code>hf.u</code>,
<code>hf.tiu</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Generate Poisson data, half with one intensity, and half with a larger one
#
v &lt;- c( rpois(64, lambda=1), rpois(64, lambda=10))
#
# Plot it to note that the variation is bigger in the second half
# (and the mean, but this is not important for this bit)
#
ts.plot(v)
#
# Now do the Haar-Fisz transform
#
vhft &lt;- hft(v)
#
# Now plot this, and see that the variance of the second bit is now comparable
# to the first
#
ts.plot(vhft)
</code></pre>


</div>