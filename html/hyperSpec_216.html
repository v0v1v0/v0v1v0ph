<div class="container">

<table style="width: 100%;"><tr>
<td>plotc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibration- and Timeseries Plots, Depth-Profiles and the like
<code>plotc</code> plots intensities of a <code>hyperSpec</code> object over another
dimension such as concentration, time, or a spatial coordinate.</h2>

<h3>Description</h3>

<p>If <code>func</code> is not <code>NULL</code>, the summary characteristic is calculated
first by applying <code>func</code> with the respective arguments (in
<code>func.args</code>) to each of the spectra. If <code>func</code> returns more than
one value (for each spectrum), the different values end up as different
wavelengths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotc(
  object,
  model = spc ~ c,
  groups = NULL,
  func = NULL,
  func.args = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the <code>hyperSpec</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the lattice model specifying the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>grouping variable, e.g. <code>.wavelength</code> if intensities of
more than one wavelength should be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>function to compute a summary value from the spectra to be
plotted instead of single intensities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func.args</code></td>
<td>
<p>further arguments to <code>func</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code>xyplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the wavelength is not used in the model specification nor in
<code>groups</code>, nor for specifying <code>subsets</code>, and neither is
<code>func</code> given, then only the first wavelength's intensities are plotted
and a warning is issued.
</p>
<p>The special column names <code>.rownames</code> and <code>.wavelength</code> may be
used.
</p>
<p>The actual plotting is done by <code>xyplot</code>.
</p>


<h3>Author(s)</h3>

<p>C. Beleites
</p>


<h3>See Also</h3>

<p><code>xyplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## example 1: calibration of fluorescence 
plotc (flu) ## gives a warning

plotc (flu, func = mean)
plotc (flu, func = range, groups = .wavelength)

plotc (flu[,,450], ylab = expression (I ["450 nm"] / a.u.))


calibration &lt;- lm (spc ~ c, data = flu[,,450]$.)
summary (calibration)
plotc (flu [,, 450], type = c("p", "r"))

conc &lt;- list (c = seq (from = 0.04, to = 0.31, by = 0.01))
ci &lt;- predict (calibration, newdata = conc, interval = "confidence", level = 0.999) 

panel.ci &lt;-  function (x, y, ...,
                       conc, ci.lwr, ci.upr, ci.col = "#606060") {
   panel.xyplot (x, y, ...)
   panel.lmline (x, y,...)
   panel.lines (conc, ci.lwr, col = ci.col)
   panel.lines (conc, ci.upr, col = ci.col)
}

plotc (flu [,, 450], panel = panel.ci,
       conc = conc$c, ci.lwr = ci [, 2], ci.upr = ci [, 3])

## example 2: time-trace of laser emission modes
cols &lt;- c ("black", "blue", "#008000", "red")
wl &lt;- i2wl (laser, c(13, 17, 21, 23))

plotspc (laser, axis.args=list (x = list (at = seq (404.5, 405.8, .1))))
for (i in seq_along (wl))
   abline (v = wl[i], col = cols[i], lwd = 2)

plotc (laser [,, wl], spc ~ t, groups = .wavelength, type = "b",
       col = cols)

</code></pre>


</div>