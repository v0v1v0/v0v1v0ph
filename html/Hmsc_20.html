<div class="container">

<table style="width: 100%;"><tr>
<td>plotBeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plotBeta</h2>

<h3>Description</h3>

<p>Plots heatmaps of parameter estimates or posterior support values of species' environmental responses, i.e. how species in <code>Y</code> responds to covariates in <code>X</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBeta(
  hM,
  post,
  param = "Support",
  plotTree = FALSE,
  SpeciesOrder = "Original",
  SpVector = NULL,
  covOrder = "Original",
  covVector = NULL,
  spNamesNumbers = c(TRUE, TRUE),
  covNamesNumbers = c(TRUE, TRUE),
  supportLevel = 0.9,
  split = 0.3,
  cex = c(0.7, 0.7, 0.8),
  colors = colorRampPalette(c("blue", "white", "red")),
  colorLevels = NULL,
  mar = NULL,
  marTree = c(6, 0, 2, 0),
  mgp = c(3, 2, 0),
  main = NULL,
  smallplot = NULL,
  bigplot = NULL,
  newplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hM</code></td>
<td>
<p>a fitted <code>Hmsc</code> model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>posterior summary of Beta parameters obtained from <code>getPostEstimate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>controls which parameter is plotted, current options include "Mean" for posterior mean estimate,
"Support" for the level of statistical support measured by posterior probability for a positive or negative
response, and "Sign" to indicate whether the response is positive, negative, or neither of these given the
chosen <code>supportLevel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotTree</code></td>
<td>
<p>logical. Whether species' environmental responses is to be mapped onto the phylogeny used in
model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SpeciesOrder</code></td>
<td>
<p>controls the ordering of species, current options are "Original", "Tree", and "Vector".
If SpeciesOrder = "Vector", an ordering vector must be provided (see SpVector). If plotTree = TRUE, SpeciesOrder
is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SpVector</code></td>
<td>
<p>controls the ordering of species if SpeciesOrder = "Vector". If a subset of species are listed,
only those will be plotted. For alphabetic ordering, try
<code>match(1:hM$ns, as.numeric(as.factor(colnames(hM$Y))))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covOrder</code></td>
<td>
<p>controls the ordering of covariates, current options are "Original" and "Vector".
If covOrder = "Vector", an ordering vector must be provided (see covVector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covVector</code></td>
<td>
<p>controls the ordering of covariates if covOrder = "Vector". If a subset of covariates are listed,
only those will be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spNamesNumbers</code></td>
<td>
<p>logical of length 2, where first entry controls whether species names are added to axes,
and second entry controls whether species numbers are added</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covNamesNumbers</code></td>
<td>
<p>logical of length 2, where first entry controls whether covariate names are added to axes,
and second entry controls whether covariate numbers are added</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supportLevel</code></td>
<td>
<p>controls threshold posterior support for plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>if plotTree = TRUE, controls the division of the plotting window between the tree and the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>controls character expansion (font size). Three values, controlling covariate names, species names,
and color legend axis labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>controls the colors of the heatmap, default value <code>colorRampPalette(c("blue","white","red"))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorLevels</code></td>
<td>
<p>number of color levels used in the heatmap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>plotting margins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marTree</code></td>
<td>
<p>plotting margins for phylogenetic tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgp</code></td>
<td>
<p>can be used to set the location of the scale bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallplot</code></td>
<td>
<p>passed to <code>image.plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bigplot</code></td>
<td>
<p>passed to <code>image.plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newplot</code></td>
<td>
<p>set to  false if the plot will be part of multi-panel plot initialized with par(mfrow)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Plot posterior support values of species' environmental responses
betaPost=getPostEstimate(TD$m, "Beta")
plotBeta(TD$m, post=betaPost, param="Support")

# Plot parameter estimates of species' environmental responses together with the phylogenetic tree
betaPost=getPostEstimate(TD$m, "Beta")
plotBeta(TD$m, post=betaPost, param="Mean", plotTree=TRUE)

</code></pre>


</div>